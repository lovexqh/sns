(function(){function s(n,t,i){var r;return t=t.toLowerCase(),(r=n.__allListeners||i&&(n.__allListeners={}))&&(r[t]||i&&(r[t]=[]))}function l(n,t,i,r,u,f){var e=r&&n[t],o;!e&&(e=n[i]);while(!e&&(o=(o||n).parentNode)){if(o.tagName=="BODY"||f&&!f(o))return null;e=o[i]}return e&&u&&!u(e)?l(e,t,i,!1,u):e}var r,t;UEDITOR_CONFIG=window.UEDITOR_CONFIG||{},t=window.baidu||{},window.baidu=t,window.UE=t.editor={},UE.plugins={},UE.commands={},UE.version="1.2.0.0";var f=UE.dom={},i=UE.browser=function(){var i=navigator.userAgent.toLowerCase(),u=window.opera,n={ie:!!window.ActiveXObject,opera:!!u&&u.version,webkit:i.indexOf(" applewebkit/")>-1,mac:i.indexOf("macintosh")>-1,quirks:document.compatMode=="BackCompat"},t,r;return n.gecko=navigator.product=="Gecko"&&!n.webkit&&!n.opera,t=0,n.ie&&(t=parseFloat(i.match(/msie (\d+)/)[1]),n.ie8=!!document.documentMode,n.ie8Compat=document.documentMode==8,n.ie7Compat=t==7&&!document.documentMode||document.documentMode==7,n.ie6Compat=t<7||n.quirks),n.gecko&&(r=i.match(/rv:([\d\.]+)/),r&&(r=r[1].split("."),t=r[0]*1e4+(r[1]||0)*100+(r[2]||0)*1)),/chrome\/(\d+\.\d)/i.test(i)&&(n.chrome=+RegExp.$1),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(i)&&!/chrome/i.test(i)&&(n.safari=+(RegExp.$1||RegExp.$2)),n.opera&&(t=parseFloat(u.version())),n.webkit&&(t=parseFloat(i.match(/ applewebkit\/(\d+)/)[1])),n.version=t,n.isCompatible=!n.mobile&&(n.ie&&t>=6||n.gecko&&t>=10801||n.opera&&t>=9.5||n.air&&t>=1||n.webkit&&t>=522||!1),n}(),e=i.ie,a=i.webkit,v=i.gecko,u=UE.utils={makeInstance:function(n){var t=new Function;return t.prototype=n,n=new t,t.prototype=null,n},extend:function(n,t,i){if(t)for(var r in t)(!i||!n.hasOwnProperty(r))&&(n[r]=t[r]);return n},isArray:function(n){return Object.prototype.toString.apply(n)==="[object Array]"},isString:function(n){return typeof n=="string"||n.constructor==String},inherits:function(n,t){var r=n.prototype,i=u.makeInstance(t.prototype);return u.extend(i,r,!0),n.prototype=i,i.constructor=n},bind:function(n,t){return function(){return n.apply(t,arguments)}},defer:function(n,t,i){var r;return function(){i&&clearTimeout(r),r=setTimeout(n,t)}},indexOf:function(n,t,i){for(var r=i||0,u=n.length;r<u;r++)if(n[r]===t)return r;return-1},findNode:function(n,t,i){for(var u=0,r;r=n[u++];)if(i?i(r):this.indexOf(t,r.tagName.toLowerCase())!=-1)return r},removeItem:function(n,t){for(var i=0,r=n.length;i<r;i++)n[i]===t&&(n.splice(i,1),i--)},trim:function(n){return n.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(n){if(!n)return{};n=u.isArray(n)?n:n.split(",");for(var r=0,t,i={};t=n[r++];)i[t.toUpperCase()]=i[t]=1;return i},unhtml:function(n){return n?n.replace(/[&<">]/g,function(n){return({"<":"&lt;","&":"&amp",'"':"&quot;",">":"&gt;"})[n]}):""},cssStyleToDomStyle:function(){var t=document.createElement("div").style,n={"float":t.cssFloat!=undefined?"cssFloat":t.styleFloat!=undefined?"styleFloat":"float"};return function(t){return n[t]||(n[t]=t.toLowerCase().replace(/-./g,function(n){return n.charAt(1).toUpperCase()}))}}(),loadFile:function(n,t,i){var r,u;if(t.id&&n.getElementById(t.id))return;r=n.createElement(t.tag),delete t.tag;for(u in t)r.setAttribute(u,t[u]);r.onload=r.onreadystatechange=function(){(!this.readyState||/loaded|complete/.test(this.readyState))&&(i&&i(),r.onload=r.onreadystatechange=null)},n.getElementsByTagName("head")[0].appendChild(r)},isEmptyObject:function(n){for(var t in n)return!1;return!0},fixColor:function(n,t){var r,u,i;if(/color/i.test(n)&&/rgba?/.test(t)){r=t.split(",");if(r.length>3)return"";for(t="#",u=0;i=r[u++];)i=parseInt(i.replace(/[^\d]/gi,""),10).toString(16),t+=i.length==1?"0"+i:i;t=t.toUpperCase()}return t},optCss:function(n){function r(n,t){var e;if(!n)return"";var r=n.top,u=n.bottom,i=n.left,f=n.right,o="";if(!r||!i||!u||!f)for(e in n)o+=";"+t+"-"+e+":"+n[e]+";";else o+=";"+t+":"+(r==u&&u==i&&i==f?r:r==u&&i==f?r+" "+i:i==f?r+" "+i+" "+u:r+" "+f+" "+u+" "+i)+";";return o}var i,t,u;return n=n.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(n,r,u,f){if(f.split(" ").length==1)switch(r){case"padding":return!i&&(i={}),i[u]=f,"";case"margin":return!t&&(t={}),t[u]=f,"";case"border":return f=="initial"?"":n}return n}),n+=r(i,"padding")+r(t,"margin"),n.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(n,t){return t?t+";;":";"})}},h=UE.EventBase=function(){};h.prototype={addListener:function(n,t){s(this,n,!0).push(t)},removeListener:function(n,t){var i=s(this,n);i&&u.removeItem(i,t)},fireEvent:function(n){var r=s(this,n),u,t,i;if(r){i=r.length;while(i--)t=r[i].apply(this,arguments),t!==undefined&&(u=t)}return(t=this["on"+n.toLowerCase()])&&(u=t.apply(this,arguments)),u}},r=f.dtd=function(){function n(n){for(var t in n)n[t.toUpperCase()]=n[t];return n}function i(n){for(var u=arguments,r,t,i=1;i<u.length;i++){r=u[i];for(t in r)n.hasOwnProperty(t)||(n[t]=r[t])}return n}var s=n({isindex:1,fieldset:1}),b=n({input:1,button:1,select:1,textarea:1,label:1}),w=i(n({a:1}),b),h=i({iframe:1},w),e=n({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),p=n({ins:1,del:1,script:1,style:1}),k=i(n({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),p),g=i(n({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),k),o=i(n({p:1}),g),nt=i(n({iframe:1}),g,b),d=n({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),t=i(n({a:0}),nt),c=n({tr:1}),u=n({"#":1}),y=i(n({param:1}),d),r=i(n({form:1}),s,h,e,o),f=n({li:1}),ut=n({style:1,script:1}),l=n({base:1,link:1,meta:1,title:1}),rt=i(l,ut),v=n({head:1,body:1}),it=n({html:1}),a=n({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),tt=n({area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1,embed:1});return n({$nonBodyContent:i(it,v,l),$block:a,$inline:t,$body:i(n({script:1,style:1}),a),$cdata:n({script:1,style:1}),$empty:tt,$nonChild:n({iframe:1}),$listItem:n({dd:1,dt:1,li:1}),$list:n({ul:1,ol:1,dl:1}),$isNotEmpty:n({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1}),$removeEmpty:n({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:n({p:1,div:1}),$tableContent:n({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:n({pre:1,script:1,style:1,textarea:1}),html:v,head:rt,style:u,script:u,body:r,base:{},link:{},meta:{},title:u,col:{},tr:n({td:1,th:1}),img:{},embed:{},colgroup:n({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:r,td:r,br:{},th:r,center:r,kbd:t,button:i(o,e),basefont:{},h5:t,h4:t,samp:t,h6:t,ol:f,h1:t,h3:t,option:u,h2:t,form:i(s,h,e,o),select:n({optgroup:1,option:1}),font:t,ins:t,menu:f,abbr:t,label:t,table:n({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:t,tfoot:c,cite:t,li:r,input:{},iframe:r,strong:t,textarea:u,noframes:r,big:t,small:t,span:n({"#":1,br:1}),hr:t,dt:t,sub:t,optgroup:n({option:1}),param:{},bdo:t,"var":t,div:r,object:y,sup:t,dd:r,strike:t,area:{},dir:f,map:i(n({area:1,form:1,p:1}),s,p,e),applet:y,dl:n({dt:1,dd:1}),del:t,isindex:{},fieldset:i(n({legend:1}),d),thead:c,ul:f,acronym:t,b:t,a:i(n({a:1}),nt),blockquote:i(n({td:1,tr:1,tbody:1,li:1}),r),caption:t,i:t,u:t,tbody:c,s:t,address:i(h,o),tt:t,legend:t,q:t,pre:i(k,w),p:i(n({a:1}),t),em:t,dfn:t})}();var c=e&&i.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},y=u.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]),n=f.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:e&&i.version=="6"?"\ufeff":"\u200b",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(n,t){var i,f,u,r;if(n===t)return 0;f=[n],u=[t],i=n;while(i=i.parentNode){if(i===t)return 10;f.push(i)}i=t;while(i=i.parentNode){if(i===n)return 20;u.push(i)}f.reverse(),u.reverse();if(f[0]!==u[0])return 1;r=-1;while(r++,f[r]===u[r]);n=f[r],t=u[r];while(n=n.nextSibling)if(n===t)return 4;return 2},getNodeIndex:function(n){var t=n.parentNode.firstChild,i=0;while(n!==t)i++,t=t.nextSibling;return i},inDoc:function(n,t){while(n=n.parentNode)if(n===t)return!0;return!1},findParent:function(t,i,r){if(!n.isBody(t)){t=r?t:t.parentNode;while(t){if(!i||i(t)||this.isBody(t))return i&&!i(t)&&this.isBody(t)?null:t;t=t.parentNode}}return null},findParentByTagName:function(n,t,i,r){if(n&&n.nodeType&&!this.isBody(n)&&(n.nodeType==1||n.nodeType)){t=u.listToMap(u.isArray(t)?t:[t]),n=n.nodeType==3||!i?n.parentNode:n;while(n&&n.tagName&&n.nodeType!=9){if(r&&r(n))break;if(t[n.tagName])return n;n=n.parentNode}}return null},findParents:function(t,i,r,u){var f=i&&(r&&r(t)||!r)?[t]:[];while(t=n.findParent(t,r))f.push(t);return u?f:f.reverse()},insertAfter:function(n,t){return n.parentNode.insertBefore(t,n.nextSibling)},remove:function(n,t){var i=n.parentNode,r;if(i){if(t&&n.hasChildNodes())while(r=n.firstChild)i.insertBefore(r,n);i.removeChild(n)}return n},getNextDomNode:function(n,t,i,r){return l(n,"firstChild","nextSibling",t,i,r)},isBookmarkNode:function(n){return n.nodeType==1&&n.id&&/^_baidu_bookmark_/i.test(n.id)},getWindow:function(n){var t=n.ownerDocument||n;return t.defaultView||t.parentWindow},getCommonAncestor:function(n,t){if(n===t)return n;var u=[n],f=[t],i=n,r=-1;while(i=i.parentNode){if(i===t)return i;u.push(i)}i=t;while(i=i.parentNode){if(i===n)return i;f.push(i)}u.reverse(),f.reverse();while(r++,u[r]===f[r]);return r==0?null:u[r-1]},clearEmptySibling:function(t,i,r){function u(t,i){var r;while(t&&!n.isBookmarkNode(t)&&(n.isEmptyInlineElement(t)||n.isWhitespace(t)))r=t[i],n.remove(t),t=r}!i&&u(t.nextSibling,"nextSibling"),!r&&u(t.previousSibling,"previousSibling")},split:function(t,r){var e=t.ownerDocument,o,u,f;return i.ie&&r==t.nodeValue.length?(o=e.createTextNode(""),n.insertAfter(t,o)):(u=t.splitText(r),i.ie8&&(f=e.createTextNode(""),n.insertAfter(u,f),n.remove(f)),u)},isWhitespace:function(t){return!new RegExp("[^ \x09\x0a\x0d"+n.fillChar+"]").test(t.nodeValue)},getXY:function(n){var i=0,t=0;while(n.offsetParent)t+=n.offsetTop,i+=n.offsetLeft,n=n.offsetParent;return{x:i,y:t}},on:function(n,t,i){var f=t instanceof Array?t:[t],u=f.length,r;if(u)while(u--)t=f[u],n.addEventListener?n.addEventListener(t,i,!1):(i._d||(i._d={}),r=t+i.toString(),i._d[r]||(i._d[r]=function(n){return i.call(n.srcElement,n||window.event)},n.attachEvent("on"+t,i._d[r])));n=null},un:function(n,t,i){var f=t instanceof Array?t:[t],u=f.length,r;if(u)while(u--)t=f[u],n.removeEventListener?n.removeEventListener(t,i,!1):(r=t+i.toString(),n.detachEvent("on"+t,i._d?i._d[r]:i),i._d&&i._d[r]&&delete i._d[r])},isSameElement:function(t,i){var h,s,r,u,f,c,o;if(t.tagName!=i.tagName)return 0;h=t.attributes,s=i.attributes;if(!e&&h.length!=s.length)return 0;for(f=0,c=0,o=0;r=h[o++];){if(r.nodeName=="style"){r.specified&&f++;if(n.isSameStyle(t,i))continue;else return 0}if(e)if(r.specified)f++,u=s.getNamedItem(r.nodeName);else continue;else u=i.attributes[r.nodeName];if(!u.specified)return 0;if(r.nodeValue!=u.nodeValue)return 0}if(e){for(o=0;u=s[o++];)u.specified&&c++;if(f!=c)return 0}return 1},isSameStyle:function(n,t){var r=n.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),i=t.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),e,f;if(!r||!i)return r==i?1:0;r=r.split(";"),i=i.split(";");if(r.length!=i.length)return 0;for(e=0;f=r[e++];)if(u.indexOf(i,f)==-1)return 0;return 1},isBlockElm:function(t){return t.nodeType==1&&(r.$block[t.tagName]||y[n.getComputedStyle(t,"display")])&&!r.$nonChild[t.tagName]},isBody:function(n){return n&&n.nodeType==1&&n.tagName.toLowerCase()=="body"},breakParent:function(t,i){var r,f=t,o=t,u,e;do{f=f.parentNode,u?(r=f.cloneNode(!1),r.appendChild(u),u=r,r=f.cloneNode(!1),r.appendChild(e),e=r):(u=f.cloneNode(!1),e=u.cloneNode(!1));while(r=o.previousSibling)u.insertBefore(r,u.firstChild);while(r=o.nextSibling)e.appendChild(r);o=f}while(i!==f);return r=i.parentNode,r.insertBefore(u,i),r.insertBefore(e,i),r.insertBefore(t,e),n.remove(i),t},isEmptyInlineElement:function(t){if(t.nodeType!=1||!r.$removeEmpty[t.tagName])return 0;t=t.firstChild;while(t){if(n.isBookmarkNode(t))return 0;if(t.nodeType==1&&!n.isEmptyInlineElement(t)||t.nodeType==3&&!n.isWhitespace(t))return 0;t=t.nextSibling}return 1},trimWhiteTextNode:function(t){function i(i){var r;while((r=t[i])&&r.nodeType==3&&n.isWhitespace(r))t.removeChild(r)}i("firstChild"),i("lastChild")},mergChild:function(t,i,r){for(var a=n.getElementsByTagName(t,t.tagName.toLowerCase()),f,e,c,s,l,h,o=0;f=a[o++];){if(!f.parentNode||n.isBookmarkNode(f))continue;if(f.tagName.toLowerCase()=="span"){if(t===f.parentNode){n.trimWhiteTextNode(t);if(t.childNodes.length==1){t.style.cssText=f.style.cssText+";"+t.style.cssText,n.remove(f,!0);continue}}f.style.cssText=t.style.cssText+";"+f.style.cssText;if(r){e=r.style;if(e)for(e=e.split(";"),c=0;s=e[c++];)f.style[u.cssStyleToDomStyle(s.split(":")[0])]=s.split(":")[1]}n.isSameStyle(f,t)&&n.remove(f,!0);continue}n.isSameElement(t,f)&&n.remove(f,!0)}if(i=="span")for(l=n.getElementsByTagName(t,"a"),o=0;h=l[o++];)h.style.cssText=";"+t.style.cssText,h.style.textDecoration="underline"},getElementsByTagName:function(n,t){for(var f=n.getElementsByTagName(t),r=[],u,i=0;u=f[i++];)r.push(u);return r},mergToParent:function(t){var i=t.parentNode;while(i&&r.$removeEmpty[i.tagName]){if(i.tagName==t.tagName||i.tagName=="A"){n.trimWhiteTextNode(i);if(i.tagName=="SPAN"&&!n.isSameStyle(i,t)||i.tagName=="A"&&t.tagName=="SPAN")if(i.childNodes.length>1||i!==t.parentNode){t.style.cssText=i.style.cssText+";"+t.style.cssText,i=i.parentNode;continue}else i.style.cssText+=";"+t.style.cssText,i.tagName=="A"&&(i.style.textDecoration="underline");if(i.tagName!="A"){i===t.parentNode&&n.remove(t,!0);break}}i=i.parentNode}},mergSibling:function(t,i,r){function u(t,i,r){var u;if((u=r[t])&&!n.isBookmarkNode(u)&&u.nodeType==1&&n.isSameElement(r,u)){while(u.firstChild)i=="firstChild"?r.insertBefore(u.lastChild,r.firstChild):r.appendChild(u.firstChild);n.remove(u)}}!i&&u("previousSibling","firstChild",t),!r&&u("nextSibling","lastChild",t)},unselectable:v?function(n){n.style.MozUserSelect="none"}:a?function(n){n.style.KhtmlUserSelect="none"}:function(n){n.onselectstart=function(){return!1},n.onclick=n.onkeyup=n.onkeydown=function(){return!1},n.unselectable="on",n.setAttribute("unselectable","on");for(var i=0,t;t=n.all[i++];)switch(t.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:t.unselectable="on",n.setAttribute("unselectable","on")}},removeAttributes:function(n,t){for(var u=0,r;r=t[u++];){r=c[r]||r;switch(r){case"className":n[r]="";break;case"style":n.style.cssText="",!i.ie&&n.removeAttributeNode(n.getAttributeNode("style"))}n.removeAttribute(r)}},setAttributes:function(n,t){var r,i;for(r in t){i=t[r];switch(r){case"class":n.className=i;break;case"style":n.style.cssText=n.style.cssText+";"+i;break;case"innerHTML":n[r]=i;break;case"value":n.value=i;break;default:n.setAttribute(c[r]||r,i)}}return n},getComputedStyle:function(t,f){function h(n,t){return n=="font-size"&&/pt$/.test(t)&&(t=Math.round(parseFloat(t)/.75)+"px"),t}var e,s,o;t.nodeType==3&&(t=t.parentNode);if(i.ie&&i.version<9&&f=="font-size"&&!t.style.fontSize&&!r.$empty[t.tagName]&&!r.$nonChild[t.tagName])return e=t.ownerDocument.createElement("span"),e.style.cssText="padding:0;border:0;font-family:simsun;",e.innerHTML=".",t.appendChild(e),s=e.offsetHeight,t.removeChild(e),e=null,s+"px";try{o=n.getStyle(t,f)||(window.getComputedStyle?n.getWindow(t).getComputedStyle(t,"").getPropertyValue(f):(t.currentStyle||t.style)[u.cssStyleToDomStyle(f)])}catch(c){return null}return h(f,u.fixColor(f,o))},removeClasses:function(n,t){n.className=(" "+n.className+" ").replace(new RegExp("(?:\\s+(?:"+t.join("|")+"))+\\s+","g")," ")},removeStyle:function(t,i){t.style[u.cssStyleToDomStyle(i)]="",t.style.cssText||n.removeAttributes(t,["style"])},hasClass:function(n,t){return(" "+n.className+" ").indexOf(" "+t+" ")>-1},preventDefault:function(n){n.preventDefault?n.preventDefault():n.returnValue=!1},getStyle:function(n,t){var i=n.style[u.cssStyleToDomStyle(t)];return u.fixColor(t,i)},setStyle:function(n,t,i){n.style[u.cssStyleToDomStyle(t)]=i},setStyles:function(t,i){for(var r in i)i.hasOwnProperty(r)&&n.setStyle(t,r,i[r])},removeDirtyAttr:function(n){for(var r=0,t,i=n.getElementsByTagName("*");t=i[r++];)t.removeAttribute("_moz_dirty");n.removeAttribute("_moz_dirty")},getChildCount:function(n,t){var r=0,i=n.firstChild;t=t||function(){return 1};while(i)t(i)&&r++,i=i.nextSibling;return r},isEmptyNode:function(t){return!t.firstChild||n.getChildCount(t,function(t){return!n.isBr(t)&&!n.isBookmarkNode(t)&&!n.isWhitespace(t)})==0},clearSelectedArr:function(t){var i;while(i=t.pop())n.removeAttributes(i,["class"])},scrollToView:function(t,i,r){var h=function(){var n=i.document,t=n.compatMode=="CSS1Compat";return{width:(t?n.documentElement.clientWidth:n.body.clientWidth)||0,height:(t?n.documentElement.clientHeight:n.body.clientHeight)||0}},s=function(n){if("pageXOffset"in n)return{x:n.pageXOffset||0,y:n.pageYOffset||0};var t=n.document;return{x:t.documentElement.scrollLeft||t.body.scrollLeft||0,y:t.documentElement.scrollTop||t.body.scrollTop||0}},o=h().height,u=o*-1+r,e,f;u+=t.offsetHeight||0,e=n.getXY(t),u+=e.y,f=s(i).y,(u>f||u<f-o)&&i.scrollTo(0,u+(u<0?-20:20))},isBr:function(n){return n.nodeType==1&&n.tagName=="BR"},isFillChar:function(t){return t.nodeType==3&&!t.nodeValue.replace(new RegExp(n.fillChar),"").length},isStartInblock:function(t){var i=t.cloneRange(),o=0,r=i.startContainer,e,u,f;while(r&&n.isFillChar(r))e=r,r=r.previousSibling;e&&(i.setStartBefore(e),r=i.startContainer),r.nodeType==1&&n.isEmptyNode(r)&&i.startOffset==1&&i.setStart(r,0).collapse(!0);while(!i.startOffset){r=i.startContainer;if(n.isBlockElm(r)||n.isBody(r)){o=1;break}u=i.startContainer.previousSibling;if(u){while(u&&n.isFillChar(u))f=u,u=u.previousSibling;f?i.setStartBefore(f):i.setStartBefore(i.startContainer)}else i.setStartBefore(i.startContainer)}return o&&!n.isBody(i.startContainer)?1:0},isEmptyBlock:function(t){var f=new RegExp("[ \x09\x0d\x0a"+n.fillChar+"]","g"),u;if(t[i.ie?"innerText":"textContent"].replace(f,"").length>0)return 0;for(u in r.$isNotEmpty)if(t.getElementsByTagName(u).length)return 0;return 1},setViewportOffset:function(n,t){var e=parseInt(n.style.left)|0,f=parseInt(n.style.top)|0,i=n.getBoundingClientRect(),r=t.left-i.left,u=t.top-i.top;r&&(n.style.left=e+r+"px"),u&&(n.style.top=f+u+"px")},fillNode:function(t,r){var u=i.ie?t.createTextNode(n.fillChar):t.createElement("br");r.innerHTML="",r.appendChild(u)},moveChild:function(n,t,i){while(n.firstChild)i&&t.firstChild?t.insertBefore(n.lastChild,t.firstChild):t.appendChild(n.firstChild)},hasNoAttributes:function(n){return i.ie?/^<\w+\s*?>/.test(n.outerHTML):n.attributes.length==0}},o=new RegExp(n.fillChar,"g");(function(){function y(n){n.collapsed=n.startContainer&&n.endContainer&&n.startContainer===n.endContainer&&n.startOffset==n.endOffset}function v(t,i,u,f){return i.nodeType==1&&(r.$empty[i.tagName]||r.$nonChild[i.tagName])&&(u=n.getNodeIndex(i)+(t?0:1),i=i.parentNode),t?(f.startContainer=i,f.startOffset=u,f.endContainer||f.collapse(!0)):(f.endContainer=i,f.endOffset=u,f.startContainer||f.collapse(!1)),y(f),f}function s(t,i){var r=t.startContainer,o=t.endContainer,h=t.startOffset,w=t.endOffset,v=t.document,b=v.createDocumentFragment(),d,k,u,l,s,y;r.nodeType==1&&(r=r.childNodes[h]||(d=r.appendChild(v.createTextNode("")))),o.nodeType==1&&(o=o.childNodes[w]||(k=o.appendChild(v.createTextNode(""))));if(r===o&&r.nodeType==3)return b.appendChild(v.createTextNode(r.substringData(h,w-h))),i&&(r.deleteData(h,w-h),t.collapse(!0)),b;var f,p,e=b,c=n.findParents(r,!0),a=n.findParents(o,!0);for(u=0;c[u]==a[u];u++);for(s=u;l=c[s];s++){f=l.nextSibling,l==r?d||(t.startContainer.nodeType==3?(e.appendChild(v.createTextNode(r.nodeValue.slice(h))),i&&r.deleteData(h,r.nodeValue.length-h)):e.appendChild(i?r:r.cloneNode(!0))):(p=l.cloneNode(!1),e.appendChild(p));while(f){if(f===o||f===a[s])break;l=f.nextSibling,e.appendChild(i?f:f.cloneNode(!0)),f=l}e=p}for(e=b,c[u]||(e.appendChild(c[u-1].cloneNode(!1)),e=e.firstChild),s=u;y=a[s];s++){f=y.previousSibling,y==o?!k&&t.endContainer.nodeType==3&&(e.appendChild(v.createTextNode(o.substringData(0,w))),i&&o.deleteData(0,w)):(p=y.cloneNode(!1),e.appendChild(p));if(s!=u||!c[u])while(f){if(f===r)break;y=f.previousSibling,e.insertBefore(i?f:f.cloneNode(!0),e.firstChild),f=y}e=p}return i&&t.setStartBefore(a[u]?c[u]?a[u]:c[u-1]:a[u-1]).collapse(!0),d&&n.remove(d),k&&n.remove(k),b}function l(i,r){try{if(t&&n.inDoc(t,i))if(t.nodeValue.replace(o,"").length)t.nodeValue=t.nodeValue.replace(o,"");else{var u=t.parentNode;n.remove(t);while(u&&n.isEmptyInlineElement(u)&&!u.contains(r))t=u.parentNode,n.remove(u),u=t}}catch(f){}}function e(t,i){var r;t=t[i];while(t&&n.isFillChar(t))r=t[i],n.remove(t),t=r}var c=0,h=n.fillChar,t,a=f.Range=function(n){var t=this;t.startContainer=t.startOffset=t.endContainer=t.endOffset=null,t.document=n,t.collapsed=!0};a.prototype={cloneContents:function(){return this.collapsed?null:s(this,0)},deleteContents:function(){this.collapsed||s(this,1);if(i.webkit){var t=this.startContainer;t.nodeType==3&&!t.nodeValue.length&&(this.setStartBefore(t).collapse(!0),n.remove(t))}return this},extractContents:function(){return this.collapsed?null:s(this,2)},setStart:function(n,t){return v(!0,n,t,this)},setEnd:function(n,t){return v(!1,n,t,this)},setStartAfter:function(t){return this.setStart(t.parentNode,n.getNodeIndex(t)+1)},setStartBefore:function(t){return this.setStart(t.parentNode,n.getNodeIndex(t))},setEndAfter:function(t){return this.setEnd(t.parentNode,n.getNodeIndex(t)+1)},setEndBefore:function(t){return this.setEnd(t.parentNode,n.getNodeIndex(t))},selectNode:function(n){return this.setStartBefore(n).setEndAfter(n)},selectNodeContents:function(n){return this.setStart(n,0).setEnd(n,n.nodeType==3?n.nodeValue.length:n.childNodes.length)},cloneRange:function(){var n=this,t=new a(n.document);return t.setStart(n.startContainer,n.startOffset).setEnd(n.endContainer,n.endOffset)},collapse:function(n){var t=this;return n?(t.endContainer=t.startContainer,t.endOffset=t.startOffset):(t.startContainer=t.endContainer,t.startOffset=t.endOffset),t.collapsed=!0,t},shrinkBoundary:function(t){var u=this,i,f=u.collapsed;while(u.startContainer.nodeType==1&&(i=u.startContainer.childNodes[u.startOffset])&&i.nodeType==1&&!n.isBookmarkNode(i)&&!r.$empty[i.tagName]&&!r.$nonChild[i.tagName])u.setStart(i,0);if(f)return u.collapse(!0);if(!t)while(u.endContainer.nodeType==1&&u.endOffset>0&&(i=u.endContainer.childNodes[u.endOffset-1])&&i.nodeType==1&&!n.isBookmarkNode(i)&&!r.$empty[i.tagName]&&!r.$nonChild[i.tagName])u.setEnd(i,i.childNodes.length);return u},getCommonAncestor:function(t,i){var r=this.startContainer,u=this.endContainer;return r===u?t&&r.nodeType==1&&this.startOffset==this.endOffset-1?r.childNodes[this.startOffset]:i&&r.nodeType==3?r.parentNode:r:n.getCommonAncestor(r,u)},trimBoundary:function(t){var f;this.txtToElmBoundary();var u=this.startContainer,r=this.startOffset,e=this.collapsed,i=this.endContainer;if(u.nodeType==3){r==0?this.setStartBefore(u):r>=u.nodeValue.length?this.setStartAfter(u):(f=n.split(u,r),u===i?this.setEnd(f,this.endOffset-r):u.parentNode===i&&(this.endOffset+=1),this.setStartBefore(f));if(e)return this.collapse(!0)}return t||(r=this.endOffset,i=this.endContainer,i.nodeType==3&&(r==0?this.setEndBefore(i):r>=i.nodeValue.length?this.setEndAfter(i):(n.split(i,r),this.setEndAfter(i)))),this},txtToElmBoundary:function(){function n(n,t){var i=n[t+"Container"],r=n[t+"Offset"];i.nodeType==3&&(r?r>=i.nodeValue.length&&n["set"+t.replace(/(\w)/,function(n){return n.toUpperCase()})+"After"](i):n["set"+t.replace(/(\w)/,function(n){return n.toUpperCase()})+"Before"](i))}return this.collapsed||(n(this,"start"),n(this,"end")),this},insertNode:function(n){var i=n,u=1;n.nodeType==11&&(i=n.firstChild,u=n.childNodes.length),this.trimBoundary(!0);var t=this.startContainer,f=this.startOffset,r=t.childNodes[f];return r?t.insertBefore(n,r):t.appendChild(n),i.parentNode===this.endContainer&&(this.endOffset=this.endOffset+u),this.setStartBefore(i)},setCursor:function(n,t){return this.collapse(n?!1:!0).select(t)},createBookmark:function(n,t){var r,i=this.document.createElement("span");return i.style.cssText="display:none;line-height:0px;",i.appendChild(this.document.createTextNode("\ufeff")),i.id="_baidu_bookmark_start_"+(t?"":c++),this.collapsed||(r=i.cloneNode(!0),r.id="_baidu_bookmark_end_"+(t?"":c++)),this.insertNode(i),r&&(this.collapse(!1).insertNode(r),this.setEndBefore(r)),this.setStartAfter(i),{start:n?i.id:i,end:r?n?r.id:r:null,id:n}},moveToBookmark:function(t){var r=t.id?this.document.getElementById(t.start):t.start,i=t.end&&t.id?this.document.getElementById(t.end):t.end;return this.setStartBefore(r),n.remove(r),i?(this.setEndBefore(i),n.remove(i)):this.collapse(!0),this},enlarge:function(t,i){var e=n.isBody,u,r,f=this.document.createTextNode("");if(t){r=this.startContainer,r.nodeType==1?r.childNodes[this.startOffset]?u=r=r.childNodes[this.startOffset]:(r.appendChild(f),u=r=f):u=r;for(;;){if(n.isBlockElm(r)){r=u;while((u=r.previousSibling)&&!n.isBlockElm(u))r=u;this.setStartBefore(r);break}u=r,r=r.parentNode}r=this.endContainer,r.nodeType==1?((u=r.childNodes[this.endOffset])?r.insertBefore(f,u):r.appendChild(f),u=r=f):u=r;for(;;){if(n.isBlockElm(r)){r=u;while((u=r.nextSibling)&&!n.isBlockElm(u))r=u;this.setEndAfter(r);break}u=r,r=r.parentNode}f.parentNode===this.endContainer&&this.endOffset--,n.remove(f)}if(!this.collapsed){while(this.startOffset==0){if(i&&i(this.startContainer))break;if(e(this.startContainer))break;this.setStartBefore(this.startContainer)}while(this.endOffset==(this.endContainer.nodeType==1?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)){if(i&&i(this.endContainer))break;if(e(this.endContainer))break;this.setEndAfter(this.endContainer)}}return this},adjustmentBoundary:function(){if(!this.collapsed){while(!n.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length)this.setStartAfter(this.startContainer);while(!n.isBody(this.endContainer)&&!this.endOffset)this.setEndBefore(this.endContainer)}return this},applyInlineStyle:function(t,i,u){var b,f,s,k,w,y,c;if(this.collapsed)return this;this.trimBoundary().enlarge(!1,function(t){return t.nodeType==1&&n.isBlockElm(t)}).adjustmentBoundary();var a=this.createBookmark(),l=a.end,v=function(t){return t.nodeType==1?t.tagName.toLowerCase()!="br":!n.isWhitespace(t)},o=n.getNextDomNode(a.start,!1,v),e,p,h=this.cloneRange();while(o&&n.getPosition(o,l)&n.POSITION_PRECEDING)if(o.nodeType==3||r[t][o.tagName]){h.setStartBefore(o),e=o;while(e&&(e.nodeType==3||r[t][e.tagName])&&e!==l)p=e,e=n.getNextDomNode(e,e.nodeType==1,null,function(n){return r[t][n.tagName]});b=h.setEndAfter(p).extractContents();if(u&&u.length>0){for(k=s=u[0].cloneNode(!1),w=1;y=u[w++];)s.appendChild(y.cloneNode(!1)),s=s.firstChild;f=s}else f=h.document.createElement(t);i&&n.setAttributes(f,i),f.appendChild(b),h.insertNode(u?k:f),t=="span"&&i.style&&/text\-decoration/.test(i.style)&&(c=n.findParentByTagName(f,"a",!0))?(n.setAttributes(c,i),n.remove(f,!0),f=c):(n.mergSibling(f),n.clearEmptySibling(f)),n.mergChild(f,t,i),o=n.getNextDomNode(f,!1,v),n.mergToParent(f);if(e===l)break}else o=n.getNextDomNode(o,!0,v);return this.moveToBookmark(a)},removeInlineStyle:function(t){var r,i,f,s,o,e,h;if(this.collapsed)return this;t=u.isArray(t)?t:[t],this.shrinkBoundary().adjustmentBoundary(),r=this.startContainer,i=this.endContainer;for(;;){if(r.nodeType==1){if(u.indexOf(t,r.tagName.toLowerCase())>-1)break;if(r.tagName.toLowerCase()=="body"){r=null;break}}r=r.parentNode}for(;;){if(i.nodeType==1){if(u.indexOf(t,i.tagName.toLowerCase())>-1)break;if(i.tagName.toLowerCase()=="body"){i=null;break}}i=i.parentNode}f=this.createBookmark(),r&&(o=this.cloneRange().setEndBefore(f.start).setStartBefore(r),s=o.extractContents(),o.insertNode(s),n.clearEmptySibling(r,!0),r.parentNode.insertBefore(f.start,r)),i&&(o=this.cloneRange().setStartAfter(f.end).setEndAfter(i),s=o.extractContents(),o.insertNode(s),n.clearEmptySibling(i,!1,!0),i.parentNode.insertBefore(f.end,i.nextSibling)),e=n.getNextDomNode(f.start,!1,function(n){return n.nodeType==1});while(e&&e!==f.end)h=n.getNextDomNode(e,!0,function(n){return n.nodeType==1}),u.indexOf(t,e.tagName.toLowerCase())>-1&&n.remove(e,!0),e=h;return this.moveToBookmark(f)},getClosedNode:function(){var i,n,t;return this.collapsed||(n=this.cloneRange().adjustmentBoundary().shrinkBoundary(),n.startContainer.nodeType==1&&n.startContainer===n.endContainer&&n.endOffset-n.startOffset==1&&(t=n.startContainer.childNodes[n.startOffset],t&&t.nodeType==1&&(r.$empty[t.tagName]||r.$nonChild[t.tagName])&&(i=t))),i},select:i.ie?function(i,r){var u,v,c,f,y,a,s,o;this.collapsed||this.shrinkBoundary(),v=this.getClosedNode();if(v&&!r){try{u=this.document.body.createControlRange(),u.addElement(v),u.select()}catch(p){}return this}return c=this.createBookmark(),f=c.start,u=this.document.body.createTextRange(),u.moveToElementText(f),u.moveStart("character",1),this.collapsed?!i&&this.startContainer.nodeType!=3&&(s=this.document.createTextNode(h),o=this.document.createElement("span"),o.appendChild(this.document.createTextNode(h)),f.parentNode.insertBefore(o,f),f.parentNode.insertBefore(s,f),l(this.document,s),t=s,e(o,"previousSibling"),e(f,"nextSibling"),u.moveStart("character",-1),u.collapse(!0)):(a=this.document.body.createTextRange(),y=c.end,a.moveToElementText(y),u.setEndPoint("EndToEnd",a)),this.moveToBookmark(c),o&&n.remove(o),u.select(),this}:function(r){var s=n.getWindow(this.document),o=s.getSelection(),u,f;return i.gecko?this.document.body.focus():s.focus(),o&&(o.removeAllRanges(),this.collapsed&&!r&&(u=this.document.createTextNode(h),this.insertNode(u),l(this.document,u),e(u,"previousSibling"),e(u,"nextSibling"),t=u,this.setStart(u,i.webkit?1:0).collapse(!0)),f=this.document.createRange(),f.setStart(this.startContainer,this.startOffset),f.setEnd(this.endContainer,this.endOffset),o.addRange(f)),this},scrollToView:function(t,i){var r,u;return t=t?window:n.getWindow(this.document),r=this.document.createElement("span"),r.innerHTML="&nbsp;",u=this.cloneRange(),u.insertNode(r),n.scrollToView(r,t,i),n.remove(r),this}}})(),(function(){function o(t,i){var a=n.getNodeIndex,e,o,l,p;t=t.duplicate(),t.collapse(i),e=t.parentElement();if(!e.hasChildNodes())return{container:e,offset:0};var h=e.children,u,s=t.duplicate(),v=0,y=h.length-1,c=-1,f;while(v<=y){c=Math.floor((v+y)/2),u=h[c],s.moveToElementText(u),o=s.compareEndPoints("StartToStart",t);if(o>0)y=c-1;else if(o<0)v=c+1;else return{container:e,offset:a(u)}}if(c==-1){s.moveToElementText(e),s.setEndPoint("StartToStart",t),f=s.text.replace(/(\r\n|\r)/g,"\n").length,h=e.childNodes;if(!f)return u=h[h.length-1],{container:u,offset:u.nodeValue.length};l=h.length;while(f>0)f-=h[--l].nodeValue.length;return{container:h[l],offset:-f}}s.collapse(o>0),s.setEndPoint(o>0?"StartToStart":"EndToStart",t),f=s.text.replace(/(\r\n|\r)/g,"\n").length;if(!f)return r.$empty[u.tagName]||r.$nonChild[u.tagName]?{container:e,offset:a(u)+(o>0?0:1)}:{container:u,offset:o>0?0:u.childNodes.length};while(f>0)try{p=u,u=u[o>0?"previousSibling":"nextSibling"],f-=u.nodeValue.length}catch(w){return{container:e,offset:a(p)}}return{container:u,offset:o>0?-f:u.nodeValue.length+f}}function h(n,t){if(n.item)t.selectNode(n.item(0));else{var i=o(n,!0);t.setStart(i.container,i.offset),n.compareEndPoints("StartToEnd",n)!=0&&(i=o(n,!1),t.setEnd(i.container,i.offset))}return t}function u(n){var t,i;try{t=n.getNative().createRange()}catch(r){return null}return i=t.item?t.item(0):t.parentElement(),(i.ownerDocument||i)===n.document?t:null}var s=f.Selection=function(t){var i=this,r;i.document=t;if(e){r=n.getWindow(t).frameElement;n.on(r,"beforedeactivate",function(){i._bakIERange=i.getIERange()});n.on(r,"activate",function(){try{!u(i)&&i._bakIERange&&i._bakIERange.select()}catch(n){}i._bakIERange=null})}r=t=null};s.prototype={getNative:function(){var t=this.document;return t?e?t.selection:n.getWindow(t).getSelection():null},getIERange:function(){var n=u(this);if(!n)if(this._bakIERange)return this._bakIERange;return n},cache:function(){this.clear(),this._cachedRange=this.getRange(),this._cachedStartElement=this.getStart(),this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var t=this.getStart();return t?n.findParents(t,!0,null,!0):[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){return i.ie&&u(this)||!i.ie&&this.getNative().rangeCount?!0:!1},getRange:function(){function s(n){var t=u.document.body.firstChild,i=n.collapsed;while(t&&t.firstChild)n.setStart(t,0),t=t.firstChild;n.startContainer||n.setStart(u.document.body,0),i&&n.collapse(!0)}var u=this,i,c,r,o,f;if(u._cachedRange!=null)return this._cachedRange;i=new t.editor.dom.Range(u.document);if(e)c=u.getIERange(),c?h(c,i):s(i);else{r=u.getNative();if(r&&r.rangeCount)o=r.getRangeAt(0),f=r.getRangeAt(r.rangeCount-1),i.setStart(o.startContainer,o.startOffset).setEnd(f.endContainer,f.endOffset),i.collapsed&&n.isBody(i.startContainer)&&!i.startOffset&&s(i);else{if(this._bakRange&&n.inDoc(this._bakRange.startContainer,this.document))return this._bakRange;s(i)}}return this._bakRange=i},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var t=e?this.getIERange():this.getRange(),i,n,r,u;if(e){if(!t)return this.document.body.firstChild;if(t.item)return t.item(0);i=t.duplicate(),i.text.length>0&&i.moveStart("character",1),i.collapse(1),n=i.parentElement(),u=r=t.parentElement();while(r=r.parentNode)if(r==n){n=u;break}}else{t.shrinkBoundary(),n=t.startContainer,n.nodeType==1&&n.hasChildNodes()&&(n=n.childNodes[Math.min(n.childNodes.length-1,t.startOffset)]);if(n.nodeType==3)return n.parentNode}return n},getText:function(){if(this.isFocus()){var t=this.getNative(),n=i.ie?t.createRange():t.getRangeAt(0);return n.text||n.toString()}return""}}})(),(function(){function c(n){for(var e=n.getElementsByTagName("img"),f,r,u,i,t=0;r=e[t++];)(f=r.getAttribute("orgSrc"))&&(r.src=f,r.removeAttribute("orgSrc"));for(u=n.getElementsByTagName("a"),t=0;i=u[t++];t++)i.getAttribute("data_ue_src")&&i.setAttribute("href",i.getAttribute("data_ue_src"))}function s(n){n=n||{},this.indentChar=n.indentChar||"    ",this.breakChar=n.breakChar||"\n",this.selfClosingEnd=n.selfClosingEnd||" />"}function v(n){var i=[],t;for(t in n)i.push(t+'="'+y(n[t])+'"');return i.join(" ")}var a=0,l,y=function(){function n(n){return t[n]}var t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return function(t){return t=t+"",t?t.replace(/[<>"']/g,n):""}}(),o=u.extend({a:1,A:1},r.$inline,!0),t;s.prototype={format:function(n){var t=UE.serialize.parseHTML(n);return this.buff=[],this.indents="",this.indenting=1,this.visitNode(t),this.buff.join("")},visitNode:function(n){if(n.type=="fragment")this.visitChildren(n.children);else if(n.type=="element"){var t=r.$empty[n.tag];this.visitTag(n.tag,n.attributes,t),this.visitChildren(n.children),t||this.visitEndTag(n.tag)}else n.type=="comment"?this.visitComment(n.data):this.visitText(n.data,r.$notTransContent[n.parent.tag])},visitChildren:function(n){for(var t=0;t<n.length;t++)this.visitNode(n[t])},visitTag:function(n,t,i){this.indenting?this.indent():o[n]||(this.newline(),this.indent()),this.buff.push("<",n);var r=v(t);r&&this.buff.push(" ",r),i?(this.buff.push(this.selfClosingEnd),n=="br"&&this.newline()):(this.buff.push(">"),this.indents+=this.indentChar),o[n]||this.newline()},indent:function(){this.buff.push(this.indents),this.indenting=0},newline:function(){this.buff.push(this.breakChar),this.indenting=1},visitEndTag:function(n){this.indents=this.indents.slice(0,-this.indentChar.length),this.indenting?this.indent():o[n]||(this.newline(),this.indent()),this.buff.push("</",n,">")},visitText:function(n){this.indenting&&this.indent(),n=n.replace(/&nbsp;/g," "),this.buff.push(n)},visitComment:function(n){this.indenting&&this.indent(),this.buff.push("<!--",n,"-->")}},t=UE.Editor=function(n){var t=this,i;t.uid=a++,h.call(t),t.commands={},t.options=u.extend(n||{},UEDITOR_CONFIG,!0);for(i in UE.plugins)UE.plugins[i].call(t)},t.prototype={destroy:function(){this.fireEvent("destroy"),this.container.innerHTML="",n.remove(this.container)},render:function(n){n.constructor===String&&(n=document.getElementById(n)),n&&(n.innerHTML='<iframe id="baidu_editor_'+this.uid+'"width="100%" height="100%"  frameborder="0"></iframe>',n.style.overflow="hidden",this._setup(n.firstChild.contentWindow.document))},_setup:function(t){var h=this.options,r=this,c,l,o;for(!i.webkit&&t.open(),c=e&&i.version<9,t.write((e&&i.version<9?"":"<!DOCTYPE html>")+'<html xmlns="http://www.w3.org/1999/xhtml"'+(c?"":' class="view"')+"><head>"+(h.iframeCssUrl?'<link rel="stylesheet" type="text/css" href="'+u.unhtml(/^http/.test(h.iframeCssUrl)?h.iframeCssUrl:h.UEDITOR_HOME_URL+h.iframeCssUrl)+'"/>':"")+'<style type="text/css">'+(h.initialStyle||" ")+"</style></head><body"+(c?' class="view"':"")+"></body></html>"),!i.webkit&&t.close(),e?(t.body.disabled=!0,t.body.contentEditable=!0,t.body.disabled=!1):(t.body.contentEditable=!0,t.body.spellcheck=!1),this.document=t,this.window=t.defaultView||t.parentWindow,this.iframe=this.window.frameElement,this.body=t.body,this.options.minFrameHeight&&(this.setHeight(this.options.minFrameHeight),this.body.style.height=this.options.minFrameHeight),this.selection=new f.Selection(t),i.gecko&&this.selection.getNative().removeAllRanges(),this._initEvents(),r.options.initialContent&&(r.options.autoClearinitialContent?(l=r.execCommand,r.execCommand=function(){r.fireEvent("firstBeforeExecCommand"),l.apply(r,arguments)},this.setDefaultContent(this.options.initialContent)):this.setContent(this.options.initialContent,!0)),o=this.iframe.parentNode;!n.isBody(o);o=o.parentNode)if(o.tagName=="FORM"){n.on(o,"submit",function(){var n=document.getElementById("ueditor_textarea_"+r.options.textarea),i,t;n||(n=document.createElement("textarea"),n.setAttribute("name",r.options.textarea),n.id="ueditor_textarea_"+r.options.textarea,n.style.display="none",this.appendChild(n)),i=new s(r.options.source),t=i.format(r.hasContents()?r.getContent():""),n.value=t});break}n.isEmptyNode(r.body)&&(this.body.innerHTML="<p>"+(i.ie?"":"<br/>")+"</p>"),r.options.focus&&setTimeout(function(){r.focus(),!r.options.autoClearinitialContent&&r._selectionChange()}),this.container||(this.container=this.iframe.parentNode),r.options.fullscreen&&r.ui&&r.ui.setFullScreen(!0),this.fireEvent("ready");if(!i.ie)n.on(r.window,"blur",function(){r._bakRange=r.selection.getRange(),r.selection.getNative().removeAllRanges()});i.gecko&&i.version<=10902&&(r.body.contentEditable=!1,setTimeout(function(){r.body.contentEditable=!0},100),setInterval(function(){r.body.style.height=r.iframe.offsetHeight-20+"px"},100))},sync:function(t){function u(n){var t=document.getElementById("ueditor_textarea_"+r.options.textarea),u,i;t||(t=document.createElement("textarea"),t.setAttribute("name",r.options.textarea),t.id="ueditor_textarea_"+r.options.textarea,t.style.display="none",n.appendChild(t)),u=new s(r.options.source),i=u.format(r.hasContents()?r.getContent():""),t.value=i}var r=this,i;if(t)i=document.getElementById(t),i&&u(i);else for(i=r.iframe.parentNode;!n.isBody(i);i=i.parentNode)if(i.tagName=="FORM"){u(i);break}},setHeight:function(n){n!==parseInt(this.iframe.parentNode.style.height)&&(this.iframe.parentNode.style.height=n+"px"),i.ie&&i.version==9&&(this.document.body.style.height=n-20+"px")},getContent:function(t){var u,i,r;return this.fireEvent("beforegetcontent",t),u=new RegExp(n.fillChar,"g"),i=this.document.body.innerHTML.replace(u,"").replace(/>[\t\r\n]*?</g,"><"),this.fireEvent("aftergetcontent",t),this.serialize&&(r=this.serialize.parseHTML(i),r=this.serialize.transformOutput(r),i=this.serialize.toHTML(r)),i},getContentTxt:function(){var t=new RegExp(n.fillChar,"g");return this.body[i.ie?"innerText":"textContent"].replace(t,"")},setContent:function(t,f){var e=this,v=u.extend({a:1,A:1},r.$inline,!0),y,h,s,o,l,a;t=t.replace(/^[ \t\r\n]*?</,"<").replace(/>[ \t\r\n]*?$/,">").replace(/>[\t\r\n]*?</g,"><").replace(/[\s\/]?(\w+)?>[ \t\r\n]*?<\/?(\w+)/gi,function(n,t,i){return t?y=i:t=y,!v[t]&&!v[i]?n.replace(/>[ \t\r\n]*?</,"><"):n}),e.fireEvent("beforesetcontent"),h=this.serialize,h&&(s=h.parseHTML(t),s=h.transformInput(s),s=h.filter(s),t=h.toHTML(s)),this.document.body.innerHTML=t.replace(new RegExp("[\x0d"+n.fillChar+"]*","g"),""),i.ie&&i.version<7&&e.options.relativePath&&c(this.document.body);if(e.options.enterTag=="p"){o=this.body.firstChild,l=e.document.createElement("p");if(!o||o.nodeType==1&&r.$cdata[o.tagName])this.body.innerHTML="<p>"+(i.ie?"":"<br/>")+"</p>"+this.body.innerHTML;else while(o)o.nodeType==3||o.nodeType==1&&r.p[o.tagName]?(a=o.nextSibling,l.appendChild(o),o=a,o||e.body.appendChild(l)):(l.firstChild&&(e.body.insertBefore(l,o),l=e.document.createElement("p")),o=o.nextSibling)}e.adjustTable&&e.adjustTable(e.body),e.fireEvent("aftersetcontent"),e.fireEvent("contentchange"),!f&&e._selectionChange(),e._bakRange=e._bakIERange=null,i.gecko&&e.selection.getNative().removeAllRanges()},focus:function(){this.selection.getRange().select(!0)},_initEvents:function(){var t=this,e=t.document,s=t.window,r,f,o;t._proxyDomEvent=u.bind(t._proxyDomEvent,t);n.on(e,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],t._proxyDomEvent);n.on(s,["focus","blur"],t._proxyDomEvent);n.on(e,["mouseup","keydown"],function(n){if(n.type=="keydown"&&(n.ctrlKey||n.metaKey||n.shiftKey||n.altKey))return;if(n.button==2)return;t._selectionChange(250,n)});r=0,f=i.ie?t.body:t.document;n.on(f,"dragstart",function(){r=1});n.on(f,i.webkit?"dragover":"drop",function(){return i.webkit?function(){clearTimeout(o),o=setTimeout(function(){var e,u,i,n,f;r||(e=t.selection,u=e.getRange(),u&&(i=u.getCommonAncestor(),i&&t.serialize&&(n=t.serialize,f=n.filter(n.transformInput(n.parseHTML(n.word(i.innerHTML)))),i.innerHTML=n.toHTML(f)))),r=0},200)}:function(n){r||(n.preventDefault?n.preventDefault():n.returnValue=!1),r=0}}())},_proxyDomEvent:function(n){return this.fireEvent(n.type.replace(/^on/,""),n)},_selectionChange:function(n,t){var r=this,u,o,e,f;if(!r.selection.isFocus())return;u=!1,i.ie&&i.version<9&&t&&t.type=="mouseup"&&(f=this.selection.getRange(),f.collapsed||(u=!0,o=t.clientX,e=t.clientY)),clearTimeout(l),l=setTimeout(function(){var n,i;if(!r.selection.getNative())return;if(u&&r.selection.getNative().type=="None"){n=r.document.body.createTextRange();try{n.moveToPoint(o,e)}catch(f){n=null}}n&&(i=r.selection.getIERange,r.selection.getIERange=function(){return n}),r.selection.cache(),i&&(r.selection.getIERange=i),r.selection._cachedRange&&r.selection._cachedStartElement&&(r.fireEvent("beforeselectionchange"),r.fireEvent("selectionchange",!!t),r.fireEvent("afterselectionchange"),r.selection.clear())},n||50)},_callCmdFn:function(n,t){var u=t[0].toLowerCase(),i,r;return r=(i=this.commands[u])&&i[n]||(i=UE.commands[u])&&i[n],i&&!r&&n=="queryCommandState"?!1:r?r.apply(this,t):void 0},execCommand:function(n){n=n.toLowerCase();var t=this,r,i=t.commands[n]||UE.commands[n];if(!(!i||!i.execCommand))return!i.notNeedUndo&&!t.__hasEnterExecCommand?(t.__hasEnterExecCommand=!0,t.queryCommandState(n)!=-1&&(t.fireEvent("beforeexeccommand",n),r=this._callCmdFn("execCommand",arguments),t.fireEvent("afterexeccommand",n)),t.__hasEnterExecCommand=!1):r=this._callCmdFn("execCommand",arguments),t._selectionChange(),r},queryCommandState:function(){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(t){if(t)for(var r=0,i;i=t[r++];)if(this.document.getElementsByTagName(i).length>0)return!0;return n.isEmptyBlock(this.body)?!1:!0},reset:function(){this.fireEvent("reset")},setDefaultContent:function(){function n(){var t=this,i;t.document.getElementById("initContent")&&(t.document.body.innerHTML="<p>"+(e?"":"<br/>")+"</p>",i=t.selection.getRange(),t.removeListener("firstBeforeExecCommand",n),t.removeListener("focus",n),setTimeout(function(){i.setStart(t.document.body.firstChild,0).collapse(!0).select(!0),t._selectionChange()}))}return function(t){var r=this;r.document.body.innerHTML='<p id="initContent">'+t+"</p>",i.ie&&i.version<7&&r.options.relativePath&&c(r.document.body),r.addListener("firstBeforeExecCommand",n),r.addListener("focus",n)}}()},u.inherits(t,h)})(),UE.ajax=function(){function n(n){var i=[],t;for(t in n){if(t=="method"||t=="timeout"||t=="async")continue;(typeof n[t]).toLowerCase()=="function"||(typeof n[t]).toLowerCase()=="object"||i.push(encodeURIComponent(t)+"="+encodeURIComponent(n[t]))}return i.join("&")}function t(){var n=null;if(window.XMLHttpRequest)n=new XMLHttpRequest;else try{n=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{n=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}return n}return{request:function(i,r){var f=t(),h=!1,c={method:"POST",timeout:5e3,async:!0,data:{},onsuccess:function(){},onerror:function(){}},e,o;typeof i=="object"&&(r=i,i=r.url);if(!f||!i)return;e=r?u.extend(c,r):c,o=n(e),u.isEmptyObject(e.data)||(o+=(o?"&":"")+n(e.data));var a=setTimeout(function(){f.readyState!=4&&(h=!0,f.abort(),clearTimeout(a))},e.timeout),s=e.method.toUpperCase(),l=i+(i.indexOf("?")==-1?"?":"&")+(s=="POST"?"":o)+"&noCache="+ +new Date;f.open(s,l,e.async),f.onreadystatechange=function(){if(f.readyState==4)if(!h&&f.status==200)e.onsuccess(f);else e.onerror(f)},s=="POST"?(f.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),f.send(o)):f.send(null)}}}(),UE.commands.inserthtml={execCommand:function(t,f){var h=this,o,d,g,a,v=h.currentSelectedArr,w,b,e,c,l,p,s,y;o=h.selection.getRange(),a=o.document.createElement("div"),a.style.display="inline",a.innerHTML=u.trim(f);try{h.adjustTable&&h.adjustTable(a)}catch(k){}if(v&&v.length){for(w=0;b=v[w++];)b.className="";v[0].innerHTML="",o.setStart(v[0],0).collapse(!0),h.currentSelectedArr=[]}if(!o.collapsed){o.deleteContents();if(o.startContainer.nodeType==1){e=o.startContainer.childNodes[o.startOffset];if(e&&n.isBlockElm(e)&&(s=e.previousSibling)&&n.isBlockElm(s)){o.setEnd(s,s.childNodes.length).collapse();while(e.firstChild)s.appendChild(e.firstChild);n.remove(e)}}}p=0;while(e=a.firstChild){o.insertNode(e);if(!p&&e.nodeType==n.NODE_ELEMENT&&n.isBlockElm(e)){c=n.findParent(e,function(t){return n.isBlockElm(t)});if(c&&c.tagName.toLowerCase()!="body"&&!(r[c.tagName][e.nodeName]&&e.parentNode===c)){if(r[c.tagName][e.nodeName]){l=e.parentNode;while(l!==c)s=l,l=l.parentNode}else s=c;n.breakParent(e,s||l),s=e.previousSibling,n.trimWhiteTextNode(s),s.childNodes.length||n.remove(s),p=1}}y=e.nextSibling;if(!a.firstChild&&y&&n.isBlockElm(y)){o.setStart(y,0).collapse(!0);break}o.setEndAfter(e).collapse()}e=o.startContainer,n.isBlockElm(e)&&n.isEmptyNode(e)&&(e.innerHTML=i.ie?"":"<br/>"),o.select(!0),setTimeout(function(){o=h.selection.getRange(),o.scrollToView(h.autoHeightEnabled,h.autoHeightEnabled?n.getXY(h.iframe).y:0)},200)}},UE.plugins.autotypeset=function(){function e(t,i){if(t&&t.parentNode&&s[t.tagName.toLowerCase()])return u&&u.contains(t)||t.getAttribute("pagebreak")?0:i?!n.isEmptyBlock(t):n.isEmptyBlock(t)}function o(t){t.style.cssText||(n.removeAttributes(t,["style"]),t.tagName.toLowerCase()=="span"&&n.hasNoAttributes(t)&&n.remove(t,!0))}function f(f,s){var w,g,nt,l,b,v,a,p,y,k,d;if(s){if(!t.pasteFilter)return;w=i.document.createElement("div"),w.innerHTML=s.html}else w=i.document.body;for(g=n.getElementsByTagName(w,"*"),nt=0;l=g[nt++];){!u&&l.tagName=="DIV"&&l.getAttribute("highlighter")&&(u=l),t.clearFontSize&&l.style.fontSize&&(l.style.fontSize="",o(l)),t.clearFontFamily&&l.style.fontFamily&&(l.style.fontFamily="",o(l));if(e(l)){if(t.mergeEmptyline){y=l.nextSibling;while(e(y))a=y,y=a.nextSibling,n.remove(a)}if(t.removeEmptyline&&n.inDoc(l,w)&&!c[l.parentNode.tagName.toLowerCase()]){n.remove(l);continue}}e(l,!0)&&(t.indent&&(l.style.textIndent=t.indentValue),t.textAlign&&(l.style.textAlign=t.textAlign));if(t.removeClass&&l.className&&!h[l.className.toLowerCase()]){if(u&&u.contains(l))continue;n.removeAttributes(l,["class"])}if(t.imageBlockLine&&l.tagName.toLowerCase()=="img"&&!l.getAttribute("emotion"))if(s){b=l;switch(t.imageBlockLine){case"left":case"right":case"none":v=b.parentNode;while(r.$inline[v.tagName]||v.tagName=="A")v=v.parentNode;a=v;if(a.tagName=="P"&&n.getStyle(a,"text-align")=="center")if(!n.isBody(a)&&n.getChildCount(a,function(t){return!n.isBr(t)&&!n.isWhitespace(t)})==1){p=a.previousSibling,y=a.nextSibling;if(p&&y&&p.nodeType==1&&y.nodeType==1&&p.tagName==y.tagName&&n.isBlockElm(p)){p.appendChild(a.firstChild);while(y.firstChild)p.appendChild(y.firstChild);n.remove(a),n.remove(y)}else n.setStyle(a,"text-align","")}n.setStyle(b,"float",t.imageBlockLine);break;case"center":if(i.queryCommandValue("imagefloat")!="center"){v=b.parentNode,n.setStyle(b,"float","none"),a=b;while(v&&n.getChildCount(v,function(t){return!n.isBr(t)&&!n.isWhitespace(t)})==1&&(r.$inline[v.tagName]||v.tagName=="A"))a=v,v=v.parentNode;k=i.document.createElement("p"),n.setAttributes(k,{style:"text-align:center"}),a.parentNode.insertBefore(k,a),k.appendChild(a),n.setStyle(a,"float","")}}}else d=i.selection.getRange(),d.selectNode(l).select(),i.execCommand("imagefloat",t.imageBlockLine);t.removeEmptyNode&&t.removeTagNames[l.tagName.toLowerCase()]&&n.hasNoAttributes(l)&&n.isEmptyBlock(l)&&n.remove(l)}s&&(s.html=w.innerHTML)}if(!this.options.autotypeset)return;var i=this,t=i.options.autotypeset,h={selectTdClass:1,pagebreak:1,anchorclass:1},c={li:1},s={div:1,p:1},u;t.pasteFilter&&i.addListener("beforepaste",f),i.commands.autotypeset={execCommand:function(){i.removeListener("beforepaste",f),t.pasteFilter&&i.addListener("beforepaste",f),f()}}},UE.commands.imagefloat={execCommand:function(t,i){var c=this,h=c.selection.getRange(),o,f,u,s,e;if(!h.collapsed){o=h.getClosedNode();if(o&&o.tagName=="IMG")switch(i){case"left":case"right":case"none":f=o.parentNode;while(r.$inline[f.tagName]||f.tagName=="A")f=f.parentNode;u=f;if(u.tagName=="P"&&n.getStyle(u,"text-align")=="center"){if(!n.isBody(u)&&n.getChildCount(u,function(t){return!n.isBr(t)&&!n.isWhitespace(t)})==1){s=u.previousSibling,e=u.nextSibling;if(s&&e&&s.nodeType==1&&e.nodeType==1&&s.tagName==e.tagName&&n.isBlockElm(s)){s.appendChild(u.firstChild);while(e.firstChild)s.appendChild(e.firstChild);n.remove(u),n.remove(e)}else n.setStyle(u,"text-align","")}h.selectNode(o).select()}n.setStyle(o,"float",i);break;case"center":if(c.queryCommandValue("imagefloat")!="center"){f=o.parentNode,n.setStyle(o,"float","none"),u=o;while(f&&n.getChildCount(f,function(t){return!n.isBr(t)&&!n.isWhitespace(t)})==1&&(r.$inline[f.tagName]||f.tagName=="A"))u=f,f=f.parentNode;h.setStartBefore(u).setCursor(!1),f=c.document.createElement("div"),f.appendChild(u),n.setStyle(u,"float",""),c.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+f.innerHTML+"</p>"),u=c.document.getElementById("_img_parent_tmp"),u.removeAttribute("id"),u=u.firstChild,h.selectNode(u).select(),e=u.parentNode.nextSibling,e&&n.isEmptyNode(e)&&n.remove(e)}}}},queryCommandValue:function(){var r=this.selection.getRange(),i,t;if(r.collapsed)return"none";return i=r.getClosedNode(),i&&i.nodeType==1&&i.tagName=="IMG"?(t=n.getComputedStyle(i,"float"),t=="none"&&(t=n.getComputedStyle(i.parentNode,"text-align")=="center"?"center":t),({left:1,right:1,center:1})[t]?t:"none"):"none"},queryCommandState:function(){if(this.highlight)return-1;var t=this.selection.getRange(),n;if(t.collapsed)return-1;return n=t.getClosedNode(),n&&n.nodeType==1&&n.tagName=="IMG"?0:-1}},UE.commands.insertimage={execCommand:function(t,i){var h,l,o,f,r,c;i=u.isArray(i)?i:[i];if(!i.length)return;var s=this,a=s.selection.getRange(),e=a.getClosedNode();if(e&&/img/i.test(e.tagName)&&e.className!="edui-faked-video"&&!e.getAttribute("word_img"))h=i.shift(),l=h.floatStyle,delete h.floatStyle,n.setAttributes(e,h),s.execCommand("imagefloat",l),i.length>0&&(a.setStartAfter(e).setCursor(!1,!0),s.execCommand("insertimage",i));else{o=[],f="",r=i[0];if(i.length==1)f='<img src="'+r.src+'" '+(r.data_ue_src?' data_ue_src="'+r.data_ue_src+'" ':"")+(r.width?'width="'+r.width+'" ':"")+(r.height?' height="'+r.height+'" ':"")+(r.floatStyle&&r.floatStyle!="center"?' style="float:'+r.floatStyle+';"':"")+(r.title?' title="'+r.title+'"':"")+' border="'+(r.border||0)+'" hspace = "'+(r.hspace||0)+'" vspace = "'+(r.vspace||0)+'" />',r.floatStyle=="center"&&(f='<p style="text-align: center">'+f+"</p>"),o.push(f);else for(c=0;r=i[c++];)f="<p "+(r.floatStyle=="center"?'style="text-align: center" ':"")+'><img src="'+r.src+'" '+(r.width?'width="'+r.width+'" ':"")+(r.data_ue_src?' data_ue_src="'+r.data_ue_src+'" ':"")+(r.height?' height="'+r.height+'" ':"")+' style="'+(r.floatStyle&&r.floatStyle!="center"?"float:"+r.floatStyle+";":"")+(r.border||"")+'" '+(r.title?' title="'+r.title+'"':"")+" /></p>",o.push(f);s.execCommand("insertHtml",o.join(""))}},queryCommandState:function(){return this.highlight?-1:0}},(function(){var t=n.isBlockElm,r={left:1,right:1,center:1,justify:1},i=function(i,r){var v=i.createBookmark(),c=function(t){return t.nodeType==1?t.tagName.toLowerCase()!="br"&&!n.isBookmarkNode(t):!n.isWhitespace(t)},o,e,l;i.enlarge(!0);var h=i.createBookmark(),f=n.getNextDomNode(h.start,!1,c),s=i.cloneRange(),a;while(f&&!(n.getPosition(f,h.end)&n.POSITION_FOLLOWING))if(f.nodeType==3||!t(f)){s.setStartBefore(f);while(f&&f!==h.end&&!t(f))a=f,f=n.getNextDomNode(f,!1,null,function(n){return!t(n)});s.setEndAfter(a),o=s.getCommonAncestor(),!n.isBody(o)&&t(o)?(n.setStyles(o,u.isString(r)?{"text-align":r}:r),f=o):(e=i.document.createElement("p"),n.setStyles(e,u.isString(r)?{"text-align":r}:r),l=s.extractContents(),e.appendChild(l),s.insertNode(e),f=e),f=n.getNextDomNode(f,!1,c)}else f=n.getNextDomNode(f,!0,c);return i.moveToBookmark(h).moveToBookmark(v)};UE.commands.justify={execCommand:function(t,r){var f=this.selection.getRange(),u,o,e;if(this.currentSelectedArr&&this.currentSelectedArr.length>0){for(o=0;e=this.currentSelectedArr[o++];)n.isEmptyNode(e)?(u=this.document.createTextNode("p"),f.setStart(e,0).collapse(!0).insertNode(u).selectNode(u)):f.selectNodeContents(e),i(f,r),u&&n.remove(u);f.selectNode(this.currentSelectedArr[0]).select()}else f.collapsed&&(u=this.document.createTextNode("p"),f.insertNode(u)),i(f,r),u&&(f.setStartBefore(u).collapse(!0),n.remove(u)),f.select();return!0},queryCommandValue:function(){var i=this.selection.getStart(),t=n.getComputedStyle(i,"text-align");return r[t]?t:"left"},queryCommandState:function(){return this.highlight?-1:0}}})(),(function(){var r={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration"},t;for(t in r)(function(t,r){UE.commands[t]={execCommand:function(u,f){var c,e,s,v,a,h,l;f=f||(this.queryCommandState(u)?"none":u=="underline"?"underline":"line-through"),c=this,e=this.selection.getRange();if(f=="default")e.collapsed&&(s=c.document.createTextNode("font"),e.insertNode(s).select()),c.execCommand("removeFormat","span,a",r),s&&(e.setStartBefore(s).setCursor(),n.remove(s));else if(c.currentSelectedArr&&c.currentSelectedArr.length>0){for(v=0;a=c.currentSelectedArr[v++];)e.selectNodeContents(a),e.applyInlineStyle("span",{style:r+":"+f});e.selectNodeContents(this.currentSelectedArr[0]).select()}else if(e.collapsed){h=n.findParentByTagName(e.startContainer,"span",!0),s=c.document.createTextNode("font");if(h&&!h.children.length&&!h[i.ie?"innerText":"textContent"].replace(o,"").length)e.insertNode(s),(t=="underline"||t=="strikethrough")&&(e.selectNode(s).select(),c.execCommand("removeFormat","span,a",r,null),h=n.findParentByTagName(s,"span",!0),e.setStartBefore(s)),h.style.cssText=h.style.cssText+";"+r+":"+f,e.collapse(!0).select();else{e.insertNode(s),e.selectNode(s).select(),h=e.document.createElement("span");if(t=="underline"||t=="strikethrough"){if(n.findParentByTagName(s,"a",!0)){e.setStartBefore(s).setCursor(),n.remove(s);return}c.execCommand("removeFormat","span,a",r)}h.style.cssText=r+":"+f,s.parentNode.insertBefore(h,s);if(!i.ie||i.ie&&i.version==9){l=h.parentNode;while(!n.isBlockElm(l))l.tagName=="SPAN"&&(h.style.cssText=l.style.cssText+h.style.cssText),l=l.parentNode}e.setStart(h,0).setCursor()}n.remove(s)}else(t=="underline"||t=="strikethrough")&&c.queryCommandValue(t)&&c.execCommand("removeFormat","span,a",r),e=c.selection.getRange(),e.applyInlineStyle("span",{style:r+":"+f}).select();return!0},queryCommandValue:function(t){var f=this.selection.getStart(),i,u;if(t=="underline"||t=="strikethrough"){i=f;while(i&&!n.isBlockElm(i)&&!n.isBody(i)){if(i.nodeType==1){u=n.getComputedStyle(i,r);if(u!="none")return u}i=i.parentNode}return"none"}return n.getComputedStyle(f,r)},queryCommandState:function(n){return this.highlight?-1:n=="underline"||n=="strikethrough"?this.queryCommandValue(n)==(n=="underline"?"underline":"line-through"):0}}})(t,r[t])})(),(function(){function r(t){var r=t.startContainer,i=t.endContainer;(r=n.findParentByTagName(r,"a",!0))&&t.setStartBefore(r),(i=n.findParentByTagName(i,"a",!0))&&t.setEndAfter(i)}function t(t,u){var f,e;r(t=t.adjustmentBoundary()),f=t.startContainer,f.nodeType==1&&(f=f.childNodes[t.startOffset],f&&f.nodeType==1&&f.tagName=="A"&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(f[i.ie?"innerText":"textContent"])&&(f.innerHTML=u.href)),t.removeInlineStyle("a"),t.collapsed?(e=t.document.createElement("a"),n.setAttributes(e,u),e.innerHTML=u.href,t.insertNode(e).selectNode(e)):t.applyInlineStyle("a",u)}UE.commands.unlink={execCommand:function(){var s,t=new f.Range(this.document),i=this.currentSelectedArr,h,c,u,e,o;if(i&&i.length>0){for(c=0;u=i[c++];)for(s=n.getElementsByTagName(u,"a"),e=0;o=s[e++];)n.remove(o,!0);n.isEmptyNode(i[0])?t.setStart(i[0],0).setCursor():t.selectNodeContents(i[0]).select()}else{t=this.selection.getRange();if(t.collapsed&&!n.findParentByTagName(t.startContainer,"a",!0))return;h=t.createBookmark(),r(t),t.removeInlineStyle("a").moveToBookmark(h).select()}},queryCommandState:function(){return!this.highlight&&this.queryCommandValue("link")?0:-1}},UE.commands.link={queryCommandState:function(){return this.highlight?-1:0},execCommand:function(r,u){var s=new f.Range(this.document),o=this.currentSelectedArr,h,e;if(o&&o.length){for(h=0;e=o[h++];)n.isEmptyNode(e)&&(e.innerHTML=u.href),t(s.selectNodeContents(e),u);s.selectNodeContents(o[0]).select()}else t(s=this.selection.getRange(),u),s.collapse().select(i.gecko?!0:!1)},queryCommandValue:function(){var t=new f.Range(this.document),c=this.currentSelectedArr,i,l,r,s,h,e,u;if(c&&c.length)for(e=0;l=c[e++];){r=l.getElementsByTagName("a");if(r[0])return r[0]}else{t=this.selection.getRange();if(t.collapsed){i=this.selection.getStart();if(i&&(i=n.findParentByTagName(i,"a",!0)))return i}else{t.shrinkBoundary();var v=t.startContainer.nodeType==3||!t.startContainer.childNodes[t.startOffset]?t.startContainer:t.startContainer.childNodes[t.startOffset],a=t.endContainer.nodeType==3||t.endOffset==0?t.endContainer:t.endContainer.childNodes[t.endOffset-1],o=t.getCommonAncestor();i=n.findParentByTagName(o,"a",!0);if(!i&&o.nodeType==1)for(r=o.getElementsByTagName("a"),e=0;u=r[e++];){s=n.getPosition(u,v),h=n.getPosition(u,a);if((s&n.POSITION_FOLLOWING||s&n.POSITION_CONTAINS)&&(h&n.POSITION_PRECEDING||h&n.POSITION_CONTAINS)){i=u;break}}return i}}}}})(),UE.commands.gmap=UE.commands.map={queryCommandState:function(){return this.highlight?-1:0}},UE.commands.insertframe={queryCommandState:function(){return this.highlight?-1:0}},UE.commands.removeformat={execCommand:function(t,u,e,o,s){function w(n){var r,t,u;if(n.nodeType==3||n.tagName.toLowerCase()!="span")return 0;if(i.ie){r=n.attributes;if(r.length){for(t=0,u=r.length;t<u;t++)if(r[t].specified)return 0;return 1}}return!n.attributes.length}function v(t){var p=t.createBookmark(),o,u,y,f,i,l,v;t.collapsed&&t.enlarge(!0),s||(o=n.findParentByTagName(t.startContainer,"a",!0),o&&t.setStartBefore(o),o=n.findParentByTagName(t.endContainer,"a",!0),o&&t.setEndAfter(o)),h=t.createBookmark(),i=h.start;while((c=i.parentNode)&&!n.isBlockElm(c))n.breakParent(i,c),n.clearEmptySibling(i);if(h.end){i=h.end;while((c=i.parentNode)&&!n.isBlockElm(c))n.breakParent(i,c),n.clearEmptySibling(i);u=n.getNextDomNode(h.start,!1,b);while(u){if(u==h.end)break;y=n.getNextDomNode(u,!0,b),!r.$empty[u.tagName.toLowerCase()]&&!n.isBookmarkNode(u)&&(k.test(u.tagName)?e?(n.removeStyle(u,e),w(u)&&e!="text-decoration"&&n.remove(u,!0)):n.remove(u,!0):!r.$tableContent[u.tagName]&&!r.$list[u.tagName]&&(n.removeAttributes(u,a),w(u)&&n.remove(u,!0))),u=y}}f=h.start.parentNode,n.isBlockElm(f)&&!r.$tableContent[f.tagName]&&!r.$list[f.tagName]&&n.removeAttributes(f,a),f=h.end.parentNode,h.end&&n.isBlockElm(f)&&!r.$tableContent[f.tagName]&&!r.$list[f.tagName]&&n.removeAttributes(f,a),t.moveToBookmark(h).moveToBookmark(p),i=t.startContainer,v=t.collapsed;while(i.nodeType==1&&n.isEmptyNode(i)&&r.$removeEmpty[i.tagName])l=i.parentNode,t.setStartBefore(i),t.startContainer===t.endContainer&&t.endOffset--,n.remove(i),i=l;if(!v){i=t.endContainer;while(i.nodeType==1&&n.isEmptyNode(i)&&r.$removeEmpty[i.tagName])l=i.parentNode,t.setEndBefore(i),n.remove(i),i=l}}var k=new RegExp("^(?:"+(u||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),a=e?[]:(o||this.options.removeFormatAttributes).split(","),l=new f.Range(this.document),h,d,c,b=function(n){return n.nodeType==1},y,p;if(this.currentSelectedArr&&this.currentSelectedArr.length){for(y=0;p=this.currentSelectedArr[y++];)l.selectNodeContents(p),v(l);l.selectNodeContents(this.currentSelectedArr[0]).select()}else l=this.selection.getRange(),v(l),l.select()},queryCommandState:function(){return this.highlight?-1:0}},(function(){var t=function(n){return u.findNode(n.selection.getStartElementPath(),["blockquote"])};UE.commands.blockquote={execCommand:function(i,u){var l=this.selection.getRange(),h=t(this),d=r.blockquote,tt=l.createBookmark(),nt=this.currentSelectedArr,g,a,k,v,y;if(h)if(nt&&nt.length)n.remove(h,!0);else{var w=l.startContainer,c=n.isBlockElm(w)?w:n.findParent(w,function(t){return n.isBlockElm(t)}),p=l.endContainer,s=n.isBlockElm(p)?p:n.findParent(p,function(t){return n.isBlockElm(t)});for(c=n.findParentByTagName(c,"li",!0)||c,s=n.findParentByTagName(s,"li",!0)||s,c.tagName=="LI"||c.tagName=="TD"||c===h?n.remove(h,!0):n.breakParent(c,h),c!==s&&(h=n.findParentByTagName(s,"blockquote"),h&&(s.tagName=="LI"||s.tagName=="TD"?n.remove(h,!0):n.breakParent(s,h))),g=n.getElementsByTagName(this.document,"blockquote"),v=0;a=g[v++];)a.childNodes.length?n.getPosition(a,c)&n.POSITION_FOLLOWING&&n.getPosition(a,s)&n.POSITION_PRECEDING&&n.remove(a,!0):n.remove(a)}else{for(var e=l.cloneRange(),f=e.startContainer.nodeType==1?e.startContainer:e.startContainer.parentNode,o=f,b=1;;){if(n.isBody(f)){o!==f?l.collapsed?(e.selectNode(o),b=0):e.setStartBefore(o):e.setStart(f,0);break}if(!d[f.tagName]){l.collapsed?e.selectNode(o):e.setStartBefore(o);break}o=f,f=f.parentNode}if(b){o=f=f=e.endContainer.nodeType==1?e.endContainer:e.endContainer.parentNode;while(1){if(n.isBody(f)){o!==f?e.setEndAfter(o):e.setEnd(f,f.childNodes.length);break}if(!d[f.tagName]){e.setEndAfter(o);break}o=f,f=f.parentNode}}for(f=l.document.createElement("blockquote"),n.setAttributes(f,u),f.appendChild(e.extractContents()),e.insertNode(f),k=n.getElementsByTagName(f,"blockquote"),v=0;y=k[v++];)y.parentNode&&n.remove(y,!0)}l.moveToBookmark(tt).select()},queryCommandState:function(){return this.highlight?-1:t(this)?1:0}}})(),UE.commands.indent={execCommand:function(){var n=this,t=n.queryCommandState("indent")?"0em":n.options.indentValue||"2em";n.execCommand("Paragraph","p",{style:"text-indent:"+t})},queryCommandState:function(){if(this.highlight)return-1;var n=u.findNode(this.selection.getStartElementPath(),["p","h1","h2","h3","h4","h5","h6"]),t=n&&n.style.textIndent?parseInt(n.style.textIndent):"";return t?1:0}},UE.commands.print={execCommand:function(){this.window.print()},notNeedUndo:1},UE.commands.preview={execCommand:function(){var r=this,o=window.open("","_blank",""),e=o.document,n=r.document.getElementById("syntaxhighlighter_css"),h=document.getElementById("syntaxhighlighter_js"),s="<style type='text/css'>"+r.options.initialStyle+"</style>",f=r.getContent();i.ie&&(f=f.replace(/<\s*br\s*\/?\s*>/gi,"<br/><br/>")),e.open(),e.write("<html><head>"+s+'<link rel="stylesheet" type="text/css" href="'+r.options.UEDITOR_HOME_URL+u.unhtml(this.options.iframeCssUrl)+'"/>'+(n?'<link rel="stylesheet" type="text/css" href="'+n.href+'"/>':"")+(n?' <script type="text/javascript" charset="utf-8" src="'+h.src+'"><\/script>':"")+"<title></title></head><body >"+f+(n?'<script type="text/javascript">'+(t.editor.browser.ie?"window.onload = function(){SyntaxHighlighter.all()};":"SyntaxHighlighter.all();")+'setTimeout(function(){for(var i=0,di;di=SyntaxHighlighter.highlightContainers[i++];){var tds = di.getElementsByTagName("td");for(var j=0,li,ri;li=tds[0].childNodes[j];j++){ri = tds[1].firstChild.childNodes[j];ri.style.height = li.style.height = ri.offsetHeight + "px";}}},100)<\/script>':"")+"</body></html>"),e.close()},notNeedUndo:1},UE.commands.spechars={queryCommandState:function(){return this.highlight?-1:0}},UE.commands.emotion={queryCommandState:function(){return this.highlight?-1:0}},UE.plugins.selectall=function(){var t=this;t.commands.selectall={execCommand:function(){var t=this.selection.getRange();t.selectNodeContents(this.body),n.isEmptyBlock(this.body)&&t.collapse(!0),t.select(!0),this.selectAll=!0},notNeedUndo:1},t.addListener("ready",function(){n.on(t.document,"click",function(){t.selectAll=!1})})},(function(){var t=n.isBlockElm,e=["TD","LI","PRE"],r=function(i,r,f,o){var p=i.createBookmark(),v=function(t){return t.nodeType==1?t.tagName.toLowerCase()!="br"&&!n.isBookmarkNode(t):!n.isWhitespace(t)},s,h;i.enlarge(!0);var a=i.createBookmark(),c=n.getNextDomNode(a.start,!1,v),l=i.cloneRange(),y;while(c&&!(n.getPosition(c,a.end)&n.POSITION_FOLLOWING))if(c.nodeType==3||!t(c)){l.setStartBefore(c);while(c&&c!==a.end&&!t(c))y=c,c=n.getNextDomNode(c,!1,null,function(n){return!t(n)});l.setEndAfter(y),s=i.document.createElement(r),f&&(n.setAttributes(s,f),o&&o=="customstyle"&&f.style&&(s.style.cssText=f.style)),s.appendChild(l.extractContents()),n.isEmptyNode(s)&&n.fillChar(i.document,s),l.insertNode(s),h=s.parentNode,t(h)&&!n.isBody(s.parentNode)&&u.indexOf(e,h.tagName)==-1&&(o&&o=="customstyle"||(h.getAttribute("dir")&&s.setAttribute("dir",h.getAttribute("dir")),h.style.cssText&&(s.style.cssText=h.style.cssText+";"+s.style.cssText),h.style.textAlign&&!s.style.textAlign&&(s.style.textAlign=h.style.textAlign),h.style.textIndent&&!s.style.textIndent&&(s.style.textIndent=h.style.textIndent),h.style.padding&&!s.style.padding&&(s.style.padding=h.style.padding)),f&&/h\d/i.test(h.tagName)&&!/h\d/i.test(s.tagName)?(n.setAttributes(h,f),o&&o=="customstyle"&&f.style&&(h.style.cssText=f.style),n.remove(s,!0),s=h):n.remove(s.parentNode,!0)),c=u.indexOf(e,h.tagName)!=-1?h:s,c=n.getNextDomNode(c,!1,v)}else c=n.getNextDomNode(c,!0,v);return i.moveToBookmark(a).moveToBookmark(p)};UE.commands.paragraph={execCommand:function(t,u,e,o){var s=new f.Range(this.document),w,a,y,l,p,h,c,v;if(this.currentSelectedArr&&this.currentSelectedArr.length>0){for(w=0;a=this.currentSelectedArr[w++];){if(a.style.display=="none")continue;n.isEmptyNode(a)&&(y=this.document.createTextNode("paragraph"),a.innerHTML="",a.appendChild(y)),r(s.selectNodeContents(a),u,e,o),y&&(l=y.parentNode,n.remove(y),n.isEmptyNode(l)&&n.fillNode(this.document,l))}p=this.currentSelectedArr[0],n.isEmptyBlock(p)?s.setStart(p,0).setCursor(!1,!0):s.selectNode(p).select()}else s=this.selection.getRange(),s.collapsed&&(h=this.document.createTextNode("p"),s.insertNode(h),i.ie&&(c=h.previousSibling,c&&n.isWhitespace(c)&&n.remove(c),c=h.nextSibling,c&&n.isWhitespace(c)&&n.remove(c))),s=r(s,u,e,o),h&&(s.setStartBefore(h).collapse(!0),l=h.parentNode,n.remove(h),n.isBlockElm(l)&&n.isEmptyNode(l)&&n.fillNode(this.document,l)),i.gecko&&s.collapsed&&s.startContainer.nodeType==1&&(v=s.startContainer.childNodes[s.startOffset],v&&v.nodeType==1&&v.tagName.toLowerCase()==u&&s.setStart(v,0).collapse(!0)),s.select();return!0},queryCommandValue:function(){var n=u.findNode(this.selection.getStartElementPath(),["p","h1","h2","h3","h4","h5","h6"]);return n?n.tagName.toLowerCase():""},queryCommandState:function(){return this.highlight?-1:0}}})(),(function(){var t=n.isBlockElm,r=function(n){return u.findNode(n.selection.getStartElementPath(),null,function(n){return n.getAttribute("dir")})},i=function(i,u,f){var v,l=function(t){return t.nodeType==1?!n.isBookmarkNode(t):!n.isWhitespace(t)},y=r(u),h,o,a;if(y&&i.collapsed)return y.setAttribute("dir",f),i;v=i.createBookmark(),i.enlarge(!0);var c=i.createBookmark(),e=n.getNextDomNode(c.start,!1,l),s=i.cloneRange(),p;while(e&&!(n.getPosition(e,c.end)&n.POSITION_FOLLOWING))if(e.nodeType==3||!t(e)){s.setStartBefore(e);while(e&&e!==c.end&&!t(e))p=e,e=n.getNextDomNode(e,!1,null,function(n){return!t(n)});s.setEndAfter(p),h=s.getCommonAncestor(),!n.isBody(h)&&t(h)?(h.setAttribute("dir",f),e=h):(o=i.document.createElement("p"),o.setAttribute("dir",f),a=s.extractContents(),o.appendChild(a),s.insertNode(o),e=o),e=n.getNextDomNode(e,!1,l)}else e=n.getNextDomNode(e,!0,l);return i.moveToBookmark(c).moveToBookmark(v)};UE.commands.directionality={execCommand:function(t,r){var u=new f.Range(this.document),s,o,e;if(this.currentSelectedArr&&this.currentSelectedArr.length>0){for(s=0;o=this.currentSelectedArr[s++];)o.style.display!="none"&&i(u.selectNode(o),this,r);u.selectNode(this.currentSelectedArr[0]).select()}else u=this.selection.getRange(),u.collapsed&&(e=this.document.createTextNode("d"),u.insertNode(e)),i(u,this,r),e&&(u.setStartBefore(e).collapse(!0),n.remove(e)),u.select();return!0},queryCommandValue:function(){var n=r(this);return n?n.getAttribute("dir"):"ltr"},queryCommandState:function(){return this.highlight?-1:0}}})(),UE.commands.horizontal={execCommand:function(n){var r=this,i,u,t;if(r.queryCommandState(n)!==-1)return r.execCommand("insertHtml","<hr>"),i=r.selection.getRange(),u=i.startContainer,u.nodeType==1&&!u.childNodes[i.startOffset]&&(t=u.childNodes[i.startOffset-1])&&t.nodeType==1&&t.tagName=="HR"&&(r.options.enterTag=="p"?(t=r.document.createElement("p"),i.insertNode(t),i.setStart(t,0).setCursor()):(t=r.document.createElement("br"),i.insertNode(t),i.setStartBefore(t).setCursor())),!0},queryCommandState:function(){return this.highlight||u.findNode(this.selection.getStartElementPath(),["table"])?-1:0}},UE.commands.time=UE.commands.date={execCommand:function(n){var t=new Date;this.execCommand("insertHtml",n=="time"?t.getHours()+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())+":"+(t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds()):t.getFullYear()+"-"+(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate()))},queryCommandState:function(){return this.highlight?-1:0}},UE.commands.rowspacing={execCommand:function(n,t,i){return this.execCommand("paragraph","p",{style:"margin-"+i+":"+t+"px"}),!0},queryCommandValue:function(t,i){var f=u.findNode(this.selection.getStartElementPath(),null,function(t){return n.isBlockElm(t)}),r;return f?(r=n.getComputedStyle(f,"margin-"+i).replace(/[^\d]/g,""),r?r:0):0},queryCommandState:function(){return this.highlight?-1:0}},UE.plugins.lineheight=function(){var t=this;t.commands.lineheight={execCommand:function(n,t){return this.execCommand("paragraph","p",{style:"line-height:"+(t=="1"?"normal":t+"em")}),!0},queryCommandValue:function(){var i=u.findNode(this.selection.getStartElementPath(),null,function(t){return n.isBlockElm(t)}),t;if(i)return t=n.getComputedStyle(i,"line-height"),t=="normal"?1:t.replace(/[^\d.]*/ig,"")},queryCommandState:function(){return this.highlight?-1:0}}},UE.commands.cleardoc={execCommand:function(){var t=this,r=t.options.enterTag,i=t.selection.getRange();r=="br"?(t.body.innerHTML="<br/>",i.setStart(t.body,0).setCursor()):(t.body.innerHTML="<p>"+(e?"":"<br/>")+"</p>",i.setStart(t.body.firstChild,0).setCursor(!1,!0))}},UE.commands.anchor={execCommand:function(t,i){var f=this.selection.getRange(),r=f.getClosedNode(),u;r&&r.getAttribute("anchorname")?i?r.setAttribute("anchorname",i):(f.setStartBefore(r).setCursor(),n.remove(r)):i&&(u=this.document.createElement("img"),f.collapse(!0),n.setAttributes(u,{anchorname:i,"class":"anchorclass"}),f.insertNode(u).setStartAfter(u).setCursor(!1,!0))},queryCommandState:function(){return this.highlight?-1:0}},UE.commands["delete"]={execCommand:function(){var t=this.selection.getRange(),c=0,v=0,u=this,l,h,o,s,a,f,e;if(this.selectAll){u.body.innerHTML="<p>"+(i.ie?"&nbsp;":"<br/>")+"</p>",t.setStart(u.body.firstChild,0).setCursor(!1,!0),u.selectAll=!1;return}if(u.currentSelectedArr&&u.currentSelectedArr.length>0){for(l=0;h=u.currentSelectedArr[l++];)h.style.display!="none"&&(h.innerHTML=i.ie?n.fillChar:"<br/>");t.setStart(u.currentSelectedArr[0],0).setCursor();return}if(t.collapsed)return;t.txtToElmBoundary();while(!t.startOffset&&!n.isBody(t.startContainer)&&!r.$tableContent[t.startContainer.tagName])c=1,t.setStartBefore(t.startContainer);while(!n.isBody(t.endContainer)&&!r.$tableContent[t.endContainer.tagName]){s=t.endContainer,a=t.endOffset,o=s.childNodes[a];if(!o||n.isBr(o)&&s.lastChild===o){t.setEndAfter(s);continue}break}c&&(f=u.document.createElement("span"),f.innerHTML="start",f.id="_baidu_cut_start",t.insertNode(f).setStartBefore(f)),v&&(e=u.document.createElement("span"),e.innerHTML="end",e.id="_baidu_cut_end",t.cloneRange().collapse(!1).insertNode(e),t.setEndAfter(e)),t.deleteContents(),n.isBody(t.startContainer)&&n.isEmptyBlock(u.body)?(u.body.innerHTML="<p>"+(i.ie?"":"<br/>")+"</p>",t.setStart(u.body.firstChild,0).collapse(!0)):!i.ie&&n.isEmptyBlock(t.startContainer)&&(t.startContainer.innerHTML="<br/>"),t.select(!0)},queryCommandState:function(){return this.currentSelectedArr&&this.currentSelectedArr.length>0?0:this.highlight||this.selection.getRange().collapsed?-1:0}},UE.commands.wordcount={queryCommandValue:function(n,t){var r,f,u;if(t)return u=new RegExp("[\x0d\x09\x0a]","g"),f=this.getContentTxt().replace(u,""),f.length;var s=this.options.wordCount,e=this.options.maximumWords,i=this.options.messages.wordCountMsg,o=this.options.messages.wordOverFlowMsg;if(!s)return"";return u=new RegExp("[\x0d\x09\x0a]","g"),f=this.getContentTxt().replace(u,""),r=f.length,e-r<0?"<span style='color:red;direction: none'>"+o+"</span> ":(i=i.replace("{#leave}",e-r>=0?e-r:0),i=i.replace("{#count}",r))}},UE.plugins.pagebreak=function(){function i(i){if(n.isEmptyBlock(i)){var r=i.firstChild,u;while(r&&r.nodeType==1&&n.isEmptyBlock(r))u=r,r=r.firstChild;!u&&(u=i),n.fillNode(t.document,u)}}function r(n){return n&&n.nodeType==1&&n.tagName=="HR"&&n.className=="pagebreak"}var t=this,u=["td"];t.commands.pagebreak={execCommand:function(){var o=t.selection.getRange(),f=t.document.createElement("hr"),a,v,y,h,e,s,l,c;n.setAttributes(f,{"class":"pagebreak",noshade:"noshade",size:"5"}),n.unselectable(f),a=n.findParentByTagName(o.startContainer,u,!0),v=[];if(a)switch(a.tagName){case"TD":e=a.parentNode,e.previousSibling?(e.parentNode.insertBefore(f,e),v=n.findParents(f)):(y=n.findParentByTagName(e,"table"),y.parentNode.insertBefore(f,y),v=n.findParents(f,!0)),e=v[1],f!==e&&n.breakParent(f,e),n.clearSelectedArr(t.currentSelectedArr)}else{if(!o.collapsed){o.deleteContents(),h=o.startContainer;while(n.isBlockElm(h)&&n.isEmptyNode(h))o.setStartBefore(h).collapse(!0),n.remove(h),h=o.startContainer}o.insertNode(f),e=f.parentNode;while(!n.isBody(e))n.breakParent(f,e),s=f.nextSibling,s&&n.isEmptyBlock(s)&&n.remove(s),e=f.parentNode;s=f.nextSibling,l=f.previousSibling,r(l)?n.remove(l):i(l),s?(r(s)?n.remove(s):i(s),o.setEndAfter(f).collapse(!1)):(c=t.document.createElement("p"),f.parentNode.appendChild(c),n.fillNode(t.document,c),o.setStart(c,0).collapse(!0)),o.select(!0)}},queryCommandState:function(){return this.highlight?-1:0}}},UE.plugins.wordimage=function(){var i=this,t;i.commands.wordimage={execCommand:function(){var u,f,e,r;for(t=n.getElementsByTagName(i.document.body,"img"),u=[],f=0;e=t[f++];)r=e.getAttribute("word_img"),r&&u.push(r);t.length&&(this.word_img=u)},queryCommandState:function(){t=n.getElementsByTagName(i.document.body,"img");for(var u=0,r;r=t[u++];)if(r.getAttribute("word_img"))return 1;return-1}}},UE.plugins.undo=function(){function a(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.undo=function(){if(this.hasUndo){var t=this.getScene(),n=this.list[this.index];n.content.replace(s,"")!=t.content.replace(s,"")&&this.save();if(!this.list[this.index-1]&&this.list.length==1){this.reset();return}while(this.list[this.index].content==this.list[this.index-1].content){this.index--;if(this.index==0)return this.restore(0)}this.restore(--this.index)}},this.redo=function(){if(this.hasRedo){while(this.list[this.index].content==this.list[this.index+1].content){this.index++;if(this.index==this.list.length-1)return this.restore(this.index)}this.restore(++this.index)}},this.restore=function(){var l=this.list[this.index],s,c,r,h,u,o;t.document.body.innerHTML=l.bookcontent.replace(e,"");if(i.ie)for(u=0,c=t.document.getElementsByTagName("p");s=c[u++];)s.innerHTML==""&&n.fillNode(t.document,s);r=new f.Range(t.document),r.moveToBookmark({start:"_baidu_bookmark_start_",end:"_baidu_bookmark_end_",id:!0}),i.ie&&i.version==9&&r.collapsed&&n.isBlockElm(r.startContainer)&&n.isEmptyNode(r.startContainer)&&n.fillNode(r.document,r.startContainer),r.select(!i.gecko),setTimeout(function(){r.scrollToView(t.autoHeightEnabled,t.autoHeightEnabled?n.getXY(t.iframe).y:0)},200),this.update();if(t.currentSelectedArr)for(t.currentSelectedArr=[],h=t.document.getElementsByTagName("td"),u=0;o=h[u++];)o.className==t.options.selectedTdClass&&t.currentSelectedArr.push(o);this.clearKey(),t.fireEvent("reset",!0),t.fireEvent("contentchange")},this.getScene=function(){var r=t.selection.getRange(),n=t.body.innerHTML.replace(e,""),f,u;return r.shrinkBoundary(),i.ie&&(n=n.replace(/>&nbsp;</g,"><").replace(/\s*</g,"").replace(/>\s*/g,">")),f=r.createBookmark(!0,!0),u=t.body.innerHTML.replace(e,""),r.moveToBookmark(f).select(!0),{bookcontent:u,content:n}},this.save=function(){var i=this.getScene(),n=this.list[this.index];if(n&&n.content==i.content&&n.bookcontent==i.bookcontent)return;this.list=this.list.slice(0,this.index+1),this.list.push(i),this.list.length>l&&this.list.shift(),this.index=this.list.length-1,this.clearKey(),this.update(),t.fireEvent("contentchange")},this.update=function(){this.hasRedo=this.list[this.index+1]?!0:!1,this.hasUndo=this.list[this.index-1]||this.list.length==1?!0:!1},this.reset=function(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.clearKey()},this.clearKey=function(){r=0,u=null}}function h(){this.undoManger.save()}var t=this,l=t.options.maxUndoCount,c=t.options.maxInputCount,e=new RegExp(n.fillChar+"|</hr>","gi"),s=/\b(?:href|src|name)="[^"]*?"/gi,o,r,u;t.undoManger=new a,t.addListener("beforeexeccommand",h),t.addListener("afterexeccommand",h),t.addListener("reset",function(n,i){i||t.undoManger.reset()}),t.commands.redo=t.commands.undo={execCommand:function(n){t.undoManger[n]()},queryCommandState:function(n){return t.undoManger["has"+(n.toLowerCase()=="undo"?"Undo":"Redo")]?0:-1},notNeedUndo:1},o={16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},r=0,t.addListener("keydown",function(n,i){var f=i.keyCode||i.which;if(!o[f]&&!i.ctrlKey&&!i.metaKey&&!i.shiftKey&&!i.altKey){if(t.undoManger.list.length==0||(f==8||f==46)&&u!=f){t.undoManger.save(),u=f;return}t.undoManger.list.length==2&&t.undoManger.index==0&&r==0&&(t.undoManger.list.splice(1,1),t.undoManger.update()),u=f,r++,r>c&&setTimeout(function(){t.undoManger.save()},0)}})},(function(){function t(t){var u=this.document;if(u.getElementById("baidu_pastebin"))return;var f=this.selection.getRange(),e=f.createBookmark(),r=u.createElement("div");r.id="baidu_pastebin",i.webkit&&r.appendChild(u.createTextNode(n.fillChar+n.fillChar)),u.body.appendChild(r),e.start.style.display="",r.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+n.getXY(e.start).y+"px",f.selectNodeContents(r).select(!0),setTimeout(function(){if(i.webkit)for(var h=0,s=u.querySelectorAll("#baidu_pastebin"),o;o=s[h++];)if(n.isEmptyNode(o))n.remove(o);else{r=o;break}try{r.parentNode.removeChild(r)}catch(c){}f.moveToBookmark(e).select(!0),t(r)},0)}UE.plugins.paste=function(){function o(t){var l,k,y,nt,v,tt,a,b,rt,p,it,g,o,s,c,h,w,d;if(t.firstChild){for(k=n.getElementsByTagName(t,"span"),o=0;y=k[o++];)(y.id=="_baidu_cut_start"||y.id=="_baidu_cut_end")&&n.remove(y);if(i.webkit){for(p=t.querySelectorAll("div br"),o=0;nt=p[o++];)v=nt.parentNode,v.tagName=="DIV"&&v.childNodes.length==1&&(v.innerHTML="<p><br/></p>",n.remove(v));for(tt=t.querySelectorAll("#baidu_pastebin"),o=0;a=tt[o++];){b=r.document.createElement("p"),a.parentNode.insertBefore(b,a);while(a.firstChild)b.appendChild(a.firstChild);n.remove(a)}for(rt=t.querySelectorAll("meta"),o=0;s=rt[o++];)n.remove(s);for(p=t.querySelectorAll("br"),o=0;s=p[o++];)/^apple-/.test(s)&&n.remove(s)}if(i.gecko)for(it=t.querySelectorAll("[_moz_dirty]"),o=0;s=it[o++];)s.removeAttribute("_moz_dirty");if(!i.ie)for(g=t.querySelectorAll("span.apple-style-span"),o=0;s=g[o++];)n.remove(s,!0);l=t.innerHTML,c=r.serialize;if(c)try{h=c.transformInput(c.parseHTML(c.word(l)),f),h=c.filter(h,u?{whiteList:{p:{br:1,BR:1},br:{$:{}},div:{br:1,BR:1,$:{}},li:{$:{}},tr:{td:1,$:{}},td:{$:{}}},blackList:{style:1,script:1,object:1}}:null,u?null:e);if(i.webkit){w=h.children.length;while((d=h.children[w-1])&&d.tag=="br")h.children.splice(w-1,1),w=h.children.length}l=c.toHTML(h,u)}catch(ut){}l={html:l},r.fireEvent("beforepaste",l),r.execCommand("insertHtml",l.html),r.fireEvent("afterpaste")}}var r=this,f={flag:""},u=r.options.pasteplain,e={flag:""};r.commands.pasteplain={queryCommandState:function(){return u},execCommand:function(){u=!u|0},notNeedUndo:1},r.addListener("ready",function(){n.on(r.body,"cut",function(){var n=r.selection.getRange();!n.collapsed&&r.undoManger&&r.undoManger.save()});n.on(r.body,i.ie?"keydown":"paste",function(n){if(i.ie&&(!n.ctrlKey||n.keyCode!="86"))return;t.call(r,function(n){function t(){r.ui.hideToolbarMsg(),r.removeListener("selectionchange",t)}o(n),e.flag&&r.ui&&(r.ui.showToolbarMsg(r.options.messages.pasteMsg,f.flag),e.flag="",setTimeout(function(){r.addListener("selectionchange",t)},100)),f.flag&&!r.queryCommandState("pasteplain")&&r.ui&&(r.ui.showToolbarMsg(r.options.messages.pasteWordImgMsg,!0),f.flag="",setTimeout(function(){r.addListener("selectionchange",t)},100))})})})}})(),UE.plugins.list=function(){function i(t,i,r){var u=t.nextSibling,f;u&&u.nodeType==1&&u.tagName.toLowerCase()==i&&(n.getStyle(u,"list-style-type")||(i=="ol"?"decimal":"disc"))==r&&(n.moveChild(u,t),u.childNodes.length==0&&n.remove(u)),f=t.previousSibling,f&&f.nodeType==1&&f.tagName.toLowerCase()==i&&(n.getStyle(f,"list-style-type")||(i=="ol"?"decimal":"disc"))==r&&n.moveChild(t,f),t.childNodes.length==0&&n.remove(t)}var t=this,f={TD:1,PRE:1,BLOCKQUOTE:1};t.addListener("keydown",function(i,u){function k(){u.preventDefault?u.preventDefault():u.returnValue=!1,t.undoManger&&t.undoManger.save()}var d=u.keyCode||u.which,y,b,c,h,a,w,s;if(d==13){var e=t.selection.getRange(),v=n.findParentByTagName(e.startContainer,["ol","ul"],!0,function(n){return n.tagName=="TABLE"}),p=n.findParentByTagName(e.endContainer,["ol","ul"],!0,function(n){return n.tagName=="TABLE"});if(v&&p&&v===p){if(!e.collapsed){v=n.findParentByTagName(e.startContainer,"li",!0),p=n.findParentByTagName(e.endContainer,"li",!0);if(v&&p&&v===p){e.deleteContents(),f=n.findParentByTagName(e.startContainer,"li",!0);if(f&&n.isEmptyBlock(f)){o=f.previousSibling,l=f.nextSibling,s=t.document.createElement("p"),n.fillNode(t.document,s),c=f.parentNode,o&&l?(e.setStart(l,0).collapse(!0).select(!0),n.remove(f)):(!o&&!l||!o?c.parentNode.insertBefore(s,c):f.parentNode.parentNode.insertBefore(s,c.nextSibling),n.remove(f),c.firstChild||n.remove(c),e.setStart(s,0).setCursor()),k();return}}else{y=e.cloneRange(),b=y.collapse(!1).createBookmark(),e.deleteContents(),y.moveToBookmark(b);var f=n.findParentByTagName(y.startContainer,"li",!0),o=f.previousSibling,l=f.nextSibling;o&&(f=o,o.firstChild&&n.isBlockElm(o.firstChild)&&(o=o.firstChild),n.isEmptyNode(o)&&n.remove(f)),l&&(f=l,l.firstChild&&n.isBlockElm(l.firstChild)&&(l=l.firstChild),n.isEmptyNode(l)&&n.remove(f)),y.select(),k();return}}f=n.findParentByTagName(e.startContainer,"li",!0);if(f){if(n.isEmptyBlock(f)){b=e.createBookmark(),c=f.parentNode,f!==c.lastChild?n.breakParent(f,c):(c.parentNode.insertBefore(f,c.nextSibling),n.isEmptyNode(c)&&n.remove(c));if(!r.$list[f.parentNode.tagName])if(n.isBlockElm(f.firstChild))n.remove(f,!0);else{s=t.document.createElement("p"),f.parentNode.insertBefore(s,f);while(f.firstChild)s.appendChild(f.firstChild);n.remove(f)}e.moveToBookmark(b).select()}else{h=f.firstChild;if(!h||!n.isBlockElm(h)){s=t.document.createElement("p"),!f.firstChild&&n.fillNode(t.document,s);while(f.firstChild)s.appendChild(f.firstChild);f.appendChild(s),h=s}a=t.document.createElement("span"),e.insertNode(a),n.breakParent(a,f),w=a.nextSibling,h=w.firstChild,h||(s=t.document.createElement("p"),n.fillNode(t.document,s),w.appendChild(s),h=s),n.isEmptyNode(h)&&(h.innerHTML="",n.fillNode(t.document,h)),e.setStart(h,0).collapse(!0).shrinkBoundary().select(),n.remove(a),o=w.previousSibling,o&&n.isEmptyBlock(o)&&(o.innerHTML="<p></p>",n.fillNode(t.document,o.firstChild))}k()}}}if(d==8){e=t.selection.getRange();if(e.collapsed&&n.isStartInblock(e)){y=e.cloneRange().trimBoundary(),f=n.findParentByTagName(e.startContainer,"li",!0);if(f&&n.isStartInblock(y)){if(f&&(o=f.previousSibling)){if(d==46&&f.childNodes.length)return;r.$list[o.tagName]&&(o=o.lastChild),t.undoManger&&t.undoManger.save(),h=f.firstChild;if(n.isBlockElm(h))if(n.isEmptyNode(h)){o.appendChild(h),e.setStart(h,0).setCursor(!1,!0);while(f.firstChild)o.appendChild(f.firstChild)}else{v=n.findParentByTagName(e.startContainer,"p",!0);if(v&&v!==h)return;a=t.document.createElement("span"),e.insertNode(a),n.moveChild(f,o),e.setStartBefore(a).collapse(!0).select(!0),n.remove(a)}else if(n.isEmptyNode(f))s=t.document.createElement("p"),o.appendChild(s),e.setStart(s,0).setCursor();else{e.setEnd(o,o.childNodes.length).collapse().select(!0);while(f.firstChild)o.appendChild(f.firstChild)}n.remove(f),t.undoManger&&t.undoManger.save(),n.preventDefault(u);return}if(f&&!f.previousSibling){h=f.firstChild;if(!h||f.lastChild===h&&n.isEmptyNode(n.isBlockElm(h)?h:f)){s=t.document.createElement("p"),f.parentNode.parentNode.insertBefore(s,f.parentNode),n.fillNode(t.document,s),e.setStart(s,0).setCursor(),n.remove(f.nextSibling?f:f.parentNode),t.undoManger&&t.undoManger.save(),n.preventDefault(u);return}}}}}}),t.commands.insertorderedlist=t.commands.insertunorderedlist={execCommand:function(t,u){var nt,lt,ct,et,ft,w,d,g,ot;u||(u=t.toLowerCase()=="insertorderedlist"?"decimal":"disc");var h=this,l=this.selection.getRange(),tt=function(t){return t.nodeType==1?t.tagName.toLowerCase()!="br":!n.isWhitespace(t)},it=t.toLowerCase()=="insertorderedlist"?"ol":"ul",a=h.document.createDocumentFragment();l.adjustmentBoundary().shrinkBoundary();var p=l.createBookmark(!0),s=n.findParentByTagName(h.document.getElementById(p.start),"li"),at=0,c=n.findParentByTagName(h.document.getElementById(p.end),"li"),st=0,v,b,y,o;if(s||c){s&&(v=s.parentNode),p.end||(c=s),c&&(b=c.parentNode);if(v===b){while(s!==c){o=s,s=s.nextSibling;if(!n.isBlockElm(o.firstChild)){nt=h.document.createElement("p");while(o.firstChild)nt.appendChild(o.firstChild);o.appendChild(nt)}a.appendChild(o)}o=h.document.createElement("span"),v.insertBefore(o,c);if(!n.isBlockElm(c.firstChild)){nt=h.document.createElement("p");while(c.firstChild)nt.appendChild(c.firstChild);c.appendChild(nt)}a.appendChild(c),n.breakParent(o,v),n.isEmptyNode(o.previousSibling)&&n.remove(o.previousSibling),n.isEmptyNode(o.nextSibling)&&n.remove(o.nextSibling),lt=n.getComputedStyle(v,"list-style-type")||(t.toLowerCase()=="insertorderedlist"?"decimal":"disc");if(v.tagName.toLowerCase()==it&&lt==u){for(ct=0,ft=h.document.createDocumentFragment();et=a.childNodes[ct++];)while(et.firstChild)ft.appendChild(et.firstChild);o.parentNode.insertBefore(ft,o)}else y=h.document.createElement(it),n.setStyle(y,"list-style-type",u),y.appendChild(a),o.parentNode.insertBefore(y,o);n.remove(o),y&&i(y,it,u),l.moveToBookmark(p).select();return}if(s){while(s){o=s.nextSibling,w=h.document.createDocumentFragment(),d=0;while(s.firstChild)n.isBlockElm(s.firstChild)&&(d=1),w.appendChild(s.firstChild);d?a.appendChild(w):(g=h.document.createElement("p"),g.appendChild(w),a.appendChild(g)),n.remove(s),s=o}v.parentNode.insertBefore(a,v.nextSibling),n.isEmptyNode(v)?(l.setStartBefore(v),n.remove(v)):l.setStartAfter(v),at=1}if(c){s=b.firstChild;while(s!==c){o=s.nextSibling,w=h.document.createDocumentFragment(),d=0;while(s.firstChild)n.isBlockElm(s.firstChild)&&(d=1),w.appendChild(s.firstChild);d?a.appendChild(w):(g=h.document.createElement("p"),g.appendChild(w),a.appendChild(g)),n.remove(s),s=o}a.appendChild(c.firstChild),n.remove(c),b.parentNode.insertBefore(a,b),l.setEndBefore(b),n.isEmptyNode(b)&&n.remove(b),st=1}}at||l.setStartBefore(h.document.getElementById(p.start)),p.end&&!st&&l.setEndAfter(h.document.getElementById(p.end)),l.enlarge(!0,function(n){return f[n.tagName]}),a=h.document.createDocumentFragment();var rt=l.createBookmark(),e=n.getNextDomNode(rt.start,!1,tt),ut=l.cloneRange(),k,ht=n.isBlockElm;while(e&&e!==rt.end&&n.getPosition(e,rt.end)&n.POSITION_PRECEDING)if(e.nodeType==3||r.li[e.tagName]){if(e.nodeType==1&&r.$list[e.tagName]){while(e.firstChild)a.appendChild(e.firstChild);k=n.getNextDomNode(e,!1,tt),n.remove(e),e=k;continue}k=e,ut.setStartBefore(e);while(e&&e!==rt.end&&(!ht(e)||n.isBookmarkNode(e)))k=e,e=n.getNextDomNode(e,!1,null,function(n){return!f[n.tagName]});e&&ht(e)&&(o=n.getNextDomNode(k,!1,tt),o&&n.isBookmarkNode(o)&&(e=n.getNextDomNode(o,!1,tt),k=o)),ut.setEndAfter(k),e=n.getNextDomNode(k,!1,tt),ot=l.document.createElement("li"),ot.appendChild(ut.extractContents()),a.appendChild(ot)}else e=n.getNextDomNode(e,!0,tt);l.moveToBookmark(rt).collapse(!0),y=h.document.createElement(it),n.setStyle(y,"list-style-type",u),y.appendChild(a),l.insertNode(y),i(y,it,u),l.moveToBookmark(p).select()},queryCommandState:function(n){return this.highlight?-1:u.findNode(this.selection.getStartElementPath(),[n.toLowerCase()=="insertorderedlist"?"ol":"ul"])?1:0},queryCommandValue:function(t){var i=u.findNode(this.selection.getStartElementPath(),[t.toLowerCase()=="insertorderedlist"?"ol":"ul"]);return i?n.getComputedStyle(i,"list-style-type"):null}}},(function(){function e(n){n=n||{},this.indentChar=n.indentChar||"    ",this.breakChar=n.breakChar||"\n",this.selfClosingEnd=n.selfClosingEnd||" />"}function s(n){var i=[],t;for(t in n)i.push(t+'="'+o(n[t])+'"');return i.join(" ")}var o=function(){function n(n){return t[n]}var t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return function(t){return t=t+"",t?t.replace(/[<>"']/g,n):""}}(),t=u.extend({a:1,A:1},r.$inline,!0),f;e.prototype={format:function(n){var t=UE.serialize.parseHTML(n);return this.buff=[],this.indents="",this.indenting=1,this.visitNode(t),this.buff.join("")},visitNode:function(n){if(n.type=="fragment")this.visitChildren(n.children);else if(n.type=="element"){var t=r.$empty[n.tag];this.visitTag(n.tag,n.attributes,t),this.visitChildren(n.children),t||this.visitEndTag(n.tag)}else n.type=="comment"?this.visitComment(n.data):this.visitText(n.data,r.$notTransContent[n.parent.tag])},visitChildren:function(n){for(var t=0;t<n.length;t++)this.visitNode(n[t])},visitTag:function(n,i,r){this.indenting?this.indent():t[n]||(this.newline(),this.indent()),this.buff.push("<",n);var u=s(i);u&&this.buff.push(" ",u),r?(this.buff.push(this.selfClosingEnd),n=="br"&&this.newline()):(this.buff.push(">"),this.indents+=this.indentChar),t[n]||this.newline()},indent:function(){this.buff.push(this.indents),this.indenting=0},newline:function(){this.buff.push(this.breakChar),this.indenting=1},visitEndTag:function(n){this.indents=this.indents.slice(0,-this.indentChar.length),this.indenting?this.indent():t[n]||(this.newline(),this.indent()),this.buff.push("</",n,">")},visitText:function(n){this.indenting&&this.indent(),n=n.replace(/&nbsp;/g," "),this.buff.push(n)},visitComment:function(n){this.indenting&&this.indent(),this.buff.push("<!--",n,"-->")}},f={textarea:function(n,t){var r=t.ownerDocument.createElement("textarea");return r.style.cssText="position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;",i.ie&&i.version<8&&(r.style.width=t.offsetWidth+"px",r.style.height=t.offsetHeight+"px",t.onresize=function(){r.style.width=t.offsetWidth+"px",r.style.height=t.offsetHeight+"px"}),t.appendChild(r),{setContent:function(n){r.value=n},getContent:function(){return r.value},select:function(){var n;i.ie?(n=r.createTextRange(),n.collapse(!0),n.select()):(r.setSelectionRange(0,0),r.focus())},dispose:function(){t.removeChild(r),t.onresize=null,r=null,t=null}}},codemirror:function(n,t){var u={mode:"text/html",tabMode:"indent",lineNumbers:!0,lineWrapping:!0},i=window.CodeMirror(t,u),r=i.getWrapperElement();return r.style.cssText='position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;',i.getScrollerElement().style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;",i.refresh(),{setContent:function(n){i.setValue(n)},getContent:function(){return i.getValue()},select:function(){i.focus()},dispose:function(){t.removeChild(r),r=null,i=null}}}},UE.plugins.source=function(){function y(n){var i=h.sourceEditor=="codemirror"&&window.CodeMirror;return f[i?"codemirror":"textarea"](t,n)}var t=this,h=this.options,v=new e(h.source),s=!1,o,c,l,a;t.commands.source={execCommand:function(){var f,u;s=!s,s?(t.undoManger&&t.undoManger.save(),this.currentSelectedArr&&n.clearSelectedArr(this.currentSelectedArr),i.gecko&&(t.body.contentEditable=!1),c=t.iframe.style.cssText,t.iframe.style.cssText+="position:absolute;left:-32768px;top:-32768px;",f=v.format(t.hasContents()?t.getContent():""),o=y(t.iframe.parentNode),o.setContent(f),setTimeout(function(){o.select()})):(t.iframe.style.cssText=c,u=o.getContent()||"<p>"+(i.ie?"":"<br/>")+"</p>",u=u.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><"),t.setContent(u),o.dispose(),o=null,setTimeout(function(){var u=t.body.firstChild,e,f;u||(t.body.innerHTML="<p>"+(i.ie?"":"<br/>")+"</p>",u=t.body.firstChild),t.undoManger&&t.undoManger.save();while(u&&u.firstChild)u=u.firstChild;e=t.selection.getRange(),u.nodeType==3||r.$empty[u.tagName]?e.setStartBefore(u):e.setStart(u,0),i.gecko?(f=document.createElement("input"),f.style.cssText="position:absolute;left:0;top:-32768px",document.body.appendChild(f),t.body.contentEditable=!1,setTimeout(function(){n.setViewportOffset(f,{left:-32768,top:0}),f.focus(),setTimeout(function(){t.body.contentEditable=!0,e.setCursor(!1,!0),n.remove(f)})})):e.setCursor(!1,!0)})),this.fireEvent("sourcemodechanged",s)},queryCommandState:function(){return s|0}},l=t.queryCommandState,t.queryCommandState=function(n){return n=n.toLowerCase(),s?n=="source"?1:-1:l.apply(this,arguments)},a=t.getContent,t.getContent=function(){var t,n;return s&&o?(t=o.getContent(),this.serialize&&(n=this.serialize.parseHTML(t),n=this.serialize.filter(n),t=this.serialize.toHTML(n)),t):a.apply(this,arguments)},t.addListener("ready",function(){h.sourceEditor=="codemirror"&&(u.loadFile(document,{src:h.codeMirrorJsUrl,tag:"script",type:"text/javascript",defer:"defer"}),u.loadFile(document,{tag:"link",rel:"stylesheet",type:"text/css",href:h.codeMirrorCssUrl}))})}})(),UE.plugins.shortcutkeys=function(){var t=this,i=u.extend({"ctrl+66":"Bold","ctrl+90":"Undo","ctrl+89":"Redo","ctrl+73":"Italic","ctrl+85":"Underline","ctrl+shift+67":"removeformat","ctrl+shift+76":"justify:left","ctrl+shift+82":"justify:right","ctrl+65":"selectAll"},t.options.shortcutkeys);t.addListener("keydown",function(r,u){var o=u.keyCode||u.which,e,f;for(f in i)(/^(ctrl)(\+shift)?\+(\d+)$/.test(f.toLowerCase())||/^(\d+)$/.test(f))&&((RegExp.$1=="ctrl"?u.ctrlKey||u.metaKey:0)&&(RegExp.$2!=""?u[RegExp.$2.slice(1)+"Key"]:1)&&o==RegExp.$3||o==RegExp.$1)&&(e=i[f].split(":"),t.execCommand(e[0],e[1]),n.preventDefault(u))})},UE.plugins.enterkey=function(){var u,t=this,f=t.options.enterTag;t.addListener("keyup",function(r,f){var v=f.keyCode||f.which,s,c,l,a,o,e,h;if(v==13){s=t.selection.getRange(),c=s.startContainer;if(!i.ie)if(/h\d/i.test(u)){if(i.gecko)a=n.findParentByTagName(c,["h1","h2","h3","h4","h5","h6","blockquote"],!0),a||(t.document.execCommand("formatBlock",!1,"<p>"),l=1);else if(c.nodeType==1){o=t.document.createTextNode(""),s.insertNode(o),e=n.findParentByTagName(o,"div",!0);if(e){h=t.document.createElement("p");while(e.firstChild)h.appendChild(e.firstChild);e.parentNode.insertBefore(h,e),n.remove(e),s.setStartBefore(o).setCursor(),l=1}n.remove(o)}t.undoManger&&l&&t.undoManger.save()}setTimeout(function(){t.selection.getRange().scrollToView(t.autoHeightEnabled,t.autoHeightEnabled?n.getXY(t.iframe).y:0)},50)}}),t.addListener("keydown",function(e,o){var y=o.keyCode||o.which,s,c,v;if(y==13){t.undoManger&&t.undoManger.save(),u="",s=t.selection.getRange();if(!s.collapsed){var h=s.startContainer,p=s.endContainer,a=n.findParentByTagName(h,"td",!0),l=n.findParentByTagName(p,"td",!0);if(a&&l&&a!==l||!a&&l||a&&!l){o.preventDefault?o.preventDefault():o.returnValue=!1;return}}t.currentSelectedArr&&n.clearSelectedArr(t.currentSelectedArr);if(f=="p")i.ie||(h=n.findParentByTagName(s.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote"],!0),h?(u=h.tagName,h.tagName.toLowerCase()=="p"&&i.gecko&&n.removeDirtyAttr(h)):(t.document.execCommand("formatBlock",!1,"<p>"),i.gecko&&(s=t.selection.getRange(),h=n.findParentByTagName(s.startContainer,"p",!0),h&&n.removeDirtyAttr(h))));else{o.preventDefault?o.preventDefault():o.returnValue=!1;if(s.collapsed)c=s.document.createElement("br"),s.insertNode(c),v=c.parentNode,v.lastChild===c?(c.parentNode.insertBefore(c.cloneNode(!0),c),s.setStartBefore(c)):s.setStartAfter(c),s.setCursor();else{s.deleteContents(),h=s.startContainer;if(h.nodeType==1&&(h=h.childNodes[s.startOffset])){while(h.nodeType==1){if(r.$empty[h.tagName])return s.setStartBefore(h).setCursor(),t.undoManger&&t.undoManger.save(),!1;if(!h.firstChild)return c=s.document.createElement("br"),h.appendChild(c),s.setStart(h,0).setCursor(),t.undoManger&&t.undoManger.save(),!1;h=h.firstChild}h===s.startContainer.childNodes[s.startOffset]?(c=s.document.createElement("br"),s.insertNode(c).setCursor()):s.setStart(h,0).setCursor()}else c=s.document.createElement("br"),s.insertNode(c).setStartAfter(c).setCursor()}}}})},UE.plugins.keystrokes=function(){var t=this,e=0,s=n.keys,c={B:"strong",I:"em",FONT:"span"},h=[0,10,12,16,18,24,32,48],o={OL:["decimal","lower-alpha","lower-roman","upper-alpha","upper-roman"],UL:["circle","disc","square"]};t.addListener("keydown",function(s,h){var g=h.keyCode||h.which,l,et,c,a,ot,ut,tt,d,rt,ft,ht,st,nt,it,b,w;if(this.selectAll){this.selectAll=!1;if(g==8||g==46){t.undoManger&&t.undoManger.save(),t.body.innerHTML="<p>"+(i.ie?"":"<br/>")+"</p>",new f.Range(t.document).setStart(t.body.firstChild,0).setCursor(!1,!0),t.undoManger&&t.undoManger.save(),i.ie&&t._selectionChange(),n.preventDefault(h);return}}if(g==8){l=t.selection.getRange();if(l.collapsed){c=l.startContainer,n.isWhitespace(c)&&(c=c.parentNode);if(n.isEmptyNode(c)&&c===t.body.firstChild){c.tagName!="P"&&(p=t.document.createElement("p"),t.body.insertBefore(p,c),n.fillNode(t.document,p),l.setStart(p,0).setCursor(!1,!0),n.remove(c)),n.preventDefault(h);return}}l.collapsed&&l.startContainer.nodeType==3&&l.startContainer.nodeValue.replace(new RegExp(n.fillChar,"g"),"").length==0&&l.setStartBefore(l.startContainer).collapse(!0);if(c=l.getClosedNode()){t.undoManger&&t.undoManger.save(),l.setStartBefore(c),n.remove(c),l.setCursor(),t.undoManger&&t.undoManger.save(),n.preventDefault(h);return}if(!i.ie){c=n.findParentByTagName(l.startContainer,"table",!0),a=n.findParentByTagName(l.endContainer,"table",!0);if(c&&!a||!c&&a||c!==a){h.preventDefault();return}if(i.webkit&&l.collapsed&&c){et=l.cloneRange().txtToElmBoundary(),c=et.startContainer;if(n.isBlockElm(c)&&c.nodeType==1&&!r.$tableContent[c.tagName]&&!n.getChildCount(c,function(n){return n.nodeType==1?n.tagName!=="BR":1})){et.setStartBefore(c).setCursor(),n.remove(c,!0),h.preventDefault();return}}}t.undoManger&&(l.collapsed||(t.undoManger.save(),e=1))}if(g==9){for(l=t.selection.getRange(),t.undoManger&&t.undoManger.save(),ot=0,ut="";ot<t.options.tabSize;ot++)ut+=t.options.tabNode;tt=t.document.createElement("span"),tt.innerHTML=ut;if(l.collapsed){d=n.findParentByTagName(l.startContainer,"li",!0);if(d&&n.isStartInblock(l)){rt=l.createBookmark();var k=d.parentNode,v=t.document.createElement(k.tagName),y=u.indexOf(o[v.tagName],n.getComputedStyle(k,"list-style-type"));y=y+1==o[v.tagName].length?0:y+1,n.setStyle(v,"list-style-type",o[v.tagName][y]),k.insertBefore(v,d),v.appendChild(d),l.moveToBookmark(rt).select()}else l.insertNode(tt.cloneNode(!0).firstChild).setCursor(!0)}else{c=n.findParentByTagName(l.startContainer,"table",!0),a=n.findParentByTagName(l.endContainer,"table",!0);if(c||a){h.preventDefault?h.preventDefault():h.returnValue=!1;return}c=n.findParentByTagName(l.startContainer,["ol","ul"],!0),a=n.findParentByTagName(l.endContainer,["ol","ul"],!0);if(c&&a&&c===a){rt=l.createBookmark(),c=n.findParentByTagName(l.startContainer,"li",!0),a=n.findParentByTagName(l.endContainer,"li",!0);if(c===c.parentNode.firstChild)ft=t.document.createElement(c.parentNode.tagName),c.parentNode.parentNode.insertBefore(ft,c.parentNode),ft.appendChild(c.parentNode);else{k=c.parentNode,v=t.document.createElement(k.tagName),y=u.indexOf(o[v.tagName],n.getComputedStyle(k,"list-style-type")),y=y+1==o[v.tagName].length?0:y+1,n.setStyle(v,"list-style-type",o[v.tagName][y]),c.parentNode.insertBefore(v,c);while(c!==a)ht=c.nextSibling,v.appendChild(c),c=ht;v.appendChild(a)}l.moveToBookmark(rt).select()}else{if(c||a){h.preventDefault?h.preventDefault():h.returnValue=!1;return}c=n.findParent(l.startContainer,nt),a=n.findParent(l.endContainer,nt);if(c&&a&&c===a)l.deleteContents(),l.insertNode(tt.cloneNode(!0).firstChild).setCursor(!0);else{st=l.createBookmark(),nt=function(t){return n.isBlockElm(t)},l.enlarge(!0),it=l.createBookmark(),b=n.getNextDomNode(it.start,!1,nt);while(b&&!(n.getPosition(b,it.end)&n.POSITION_FOLLOWING))b.insertBefore(tt.cloneNode(!0).firstChild,b.firstChild),b=n.getNextDomNode(b,!1,nt);l.moveToBookmark(it).moveToBookmark(st).select()}}}t.undoManger&&t.undoManger.save(),h.preventDefault?h.preventDefault():h.returnValue=!1}if(i.gecko&&g==46){l=t.selection.getRange();if(l.collapsed){c=l.startContainer;if(n.isEmptyBlock(c)){w=c.parentNode;while(n.getChildCount(w)==1&&!n.isBody(w))c=w,w=w.parentNode;c===w.lastChild&&h.preventDefault();return}}}}),t.addListener("keyup",function(o,l){var rt=l.keyCode||l.which,k,p,y,it,nt,v,a,ut,b,d,ft,tt,g,w;if(!i.gecko&&!s[rt]&&!l.ctrlKey&&!l.metaKey&&!l.shiftKey&&!l.altKey){v=t.selection.getRange();if(v.collapsed){a=v.startContainer,k=0;while(!n.isBlockElm(a)){if(a.nodeType==1&&u.indexOf(["FONT","B","I"],a.tagName)!=-1){p=t.document.createElement(c[a.tagName]),a.tagName=="FONT"&&(p.style.cssText=(a.getAttribute("size")?"font-size:"+(h[a.getAttribute("size")]||12)+"px":"")+";"+(a.getAttribute("color")?"color:"+a.getAttribute("color"):"")+";"+(a.getAttribute("face")?"font-family:"+a.getAttribute("face"):"")+";"+a.style.cssText);while(a.firstChild)p.appendChild(a.firstChild);a.parentNode.insertBefore(p,a),n.remove(a),k||v.setEnd(p,p.childNodes.length).collapse(!0),a=p,k=1}a=a.parentNode}k&&v.select()}}if(rt==8){if(i.gecko)for(d=0,it=n.getElementsByTagName(this.body,"li");y=it[d++];)n.isEmptyNode(y)&&!y.previousSibling&&(nt=y.parentNode,n.remove(y),n.isEmptyNode(nt)&&n.remove(nt));b=this.currentSelectedArr;if(b&&b.length>0){for(d=0;ft=b[d++];)ft.innerHTML=i.ie?i.version<9?"&#65279":"":"<br/>";v=new f.Range(this.document),v.setStart(b[0],0).setCursor(),e&&(t.undoManger.save(),e=0),i.webkit&&l.preventDefault();return}v=t.selection.getRange(),a=v.startContainer,n.isWhitespace(a)&&(a=a.parentNode),tt=0;while(a.nodeType==1&&n.isEmptyNode(a)&&r.$removeEmpty[a.tagName])tt=1,ut=a.parentNode,n.remove(a),a=ut;if(tt&&a.nodeType==1&&n.isEmptyNode(a)){if(i.ie){g=v.document.createElement("span"),a.appendChild(g),v.setStart(a,0).setCursor(),y=n.findParentByTagName(a,"li",!0);if(y){w=y.nextSibling;while(w){if(n.isEmptyBlock(w)){y=w,w=w.nextSibling,n.remove(y);continue}break}}}else a.innerHTML="<br/>",v.setStart(a,0).setCursor(!1,!0);setTimeout(function(){i.ie&&n.remove(g),e&&(t.undoManger.save(),e=0)},0)}else e&&(t.undoManger.save(),e=0)}})},UE.plugins.fiximgclick=function(){var n=this;i.webkit&&n.addListener("click",function(t,i){if(i.target.tagName=="IMG"){var r=new f.Range(n.document);r.selectNode(i.target).select()}})},UE.plugins.autolink=function(){var r=0,t;if(i.ie)return;t=this,t.addListener("reset",function(){r=0}),t.addListener("keydown",function(i,r){var a=r.keyCode||r.which,e,s,o;if(a==32||a==13){var h=t.selection.getNative(),u=h.getRangeAt(0).cloneRange(),c,l,f=u.startContainer;while(f.nodeType==1&&u.startOffset>0){f=u.startContainer.childNodes[u.startOffset-1];if(!f)break;u.setStart(f,f.nodeType==1?f.childNodes.length:f.nodeValue.length),u.collapse(!0),f=u.startContainer}do{if(u.startOffset==0){f=u.startContainer.previousSibling;while(f&&f.nodeType==1)f=f.lastChild;if(!f||n.isFillChar(f))break;c=f.nodeValue.length}else f=u.startContainer,c=u.startOffset;u.setStart(f,c-1),l=u.toString().charCodeAt(0)}while(l!=160&&l!=32);if(u.toString().replace(new RegExp(n.fillChar,"g"),"").match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){while(u.toString().length){if(/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(u.toString()))break;try{u.setStart(u.startContainer,u.startOffset+1)}catch(v){u.setStart(u.startContainer.nextSibling,0)}}e=t.document.createElement("a"),s=t.document.createTextNode(" "),t.undoManger&&t.undoManger.save(),e.appendChild(u.extractContents()),e.href=e.innerHTML=e.innerHTML.replace(/<[^>]+>/g,""),o=e.getAttribute("href").replace(new RegExp(n.fillChar,"g"),""),o=/^(?:https?:\/\/)/ig.test(o)?o:"http://"+o,e.setAttribute("data_ue_src",o),e.href=o,u.insertNode(e),e.parentNode.insertBefore(s,e.nextSibling),u.setStart(s,0),u.collapse(!0),h.removeAllRanges(),h.addRange(u),t.undoManger&&t.undoManger.save()}}})},UE.plugins.autoheight=function(){function r(){clearTimeout(h),h=setTimeout(function(){t.queryCommandState("source")!=1&&(f||(f=t.document.createElement("span"),f.style.cssText="display:block;width:0;margin:0;padding:0;border:0;clear:both;",f.innerHTML="."),u=f.cloneNode(!0),t.body.appendChild(u),e=Math.max(n.getXY(u).y+u.offsetHeight,t.options.minFrameHeight),e!=o&&(t.setHeight(e),o=e),n.remove(u))},50)}var t=this,s,f,u,o,e,h;t.autoHeightEnabled=t.options.autoHeightEnabled;if(!t.autoHeightEnabled)return;o=0,t.addListener("destroy",function(){t.removeListener("contentchange",r),t.removeListener("keyup",r),t.removeListener("mouseup",r)}),t.enableAutoHeight=function(){if(!t.autoHeightEnabled)return;var n=t.document;t.autoHeightEnabled=!0,s=n.body.style.overflowY,n.body.style.overflowY="hidden",t.addListener("contentchange",r),t.addListener("keyup",r),t.addListener("mouseup",r),setTimeout(function(){r()},i.gecko?100:0),t.fireEvent("autoheightchanged",t.autoHeightEnabled)},t.disableAutoHeight=function(){t.body.style.overflowY=s||"",t.removeListener("contentchange",r),t.removeListener("keyup",r),t.removeListener("mouseup",r),t.autoHeightEnabled=!1,t.fireEvent("autoheightchanged",t.autoHeightEnabled)},t.addListener("ready",function(){t.enableAutoHeight();var u;n.on(i.ie?t.body:t.document,i.webkit?"dragover":"drop",function(){clearTimeout(u),u=setTimeout(function(){r()},100)})})},UE.plugins.autofloat=function(){function k(n){if(!n.ui){alert("autofloat\u63d2\u4ef6\u529f\u80fd\u4f9d\u8d56\u4e8eUEditor UI\nautofloat\u5b9a\u4e49\u4f4d\u7f6e: _src/plugins/autofloat.js");throw{name:"\u672a\u5305\u542bUI\u6587\u4ef6",message:"autofloat\u529f\u80fd\u4f9d\u8d56\u4e8eUEditor UI\u3002autofloat\u5b9a\u4e49\u4f4d\u7f6e: _src/plugins/autofloat.js"};}return a=UE.ui.uiUtils,1}function b(){var n=document.body.style;n.backgroundImage='url("about:blank")',n.backgroundAttachment="fixed"}function w(){var s=n.getXY(t),u=n.getComputedStyle(t,"position"),f=n.getComputedStyle(t,"left");t.style.width=t.offsetWidth+"px",t.style.zIndex=r.options.zIndex*1+1,t.parentNode.insertBefore(e,t),y||d?(t.style.position!="absolute"&&(t.style.position="absolute"),t.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-c+"px"):(i.ie7Compat&&h&&(h=!1,t.style.left=o(t).left-document.documentElement.getBoundingClientRect().left+2+"px"),t.style.position!="fixed"&&(t.style.position="fixed",t.style.top="0",(u=="absolute"||u=="relative")&&parseFloat(f)&&(t.style.left=s.x+"px")))}function l(){h=!0,e.parentNode&&e.parentNode.removeChild(e),t.style.cssText=v}function f(){var n=o(r.container);n.top<0&&n.bottom-t.offsetHeight>0?w():l()}var a,y=i.ie&&i.version<=6,d=i.quirks,p=this.options.autoFloatEnabled,s;if(!p)return;var r=this,v,e=document.createElement("div"),t,c,o,h=!0;s=u.defer(function(){f()},i.ie?200:100,!0),r.addListener("destroy",function(){n.un(window,["scroll","resize"],f),r.removeListener("keydown",s)}),r.addListener("ready",function(){k(r)&&(o=a.getClientRect,t=r.ui.getDom("toolbarbox"),c=o(t).top,v=t.style.cssText,e.style.height=t.offsetHeight+"px",y&&b(),r.addListener("autoheightchanged",function(t,i){if(i){n.on(window,["scroll","resize"],f);r.addListener("keydown",s)}else n.un(window,["scroll","resize"],f),r.removeListener("keydown",s)}),r.addListener("beforefullscreenchange",function(n,t){t&&l()}),r.addListener("fullscreenchanged",function(n,t){t||f()}),r.addListener("sourcemodechanged",function(){setTimeout(function(){f()})}))})},UE.plugins.highlight=function(){function f(){var u=t.document.getElementById(SyntaxHighlighter.getHighlighterDivId()),r,n,f,i;if(u)for(r=u.getElementsByTagName("td"),n=0;f=r[0].childNodes[n];n++)i=r[1].firstChild.childNodes[n],i.style.height=f.style.height=i.offsetHeight+"px"}function r(){for(var u,r,o,e,h=0,s=n.getElementsByTagName(t.document,"pre");u=s[h++];)if(u.className.indexOf("brush")>-1){r=document.createElement("pre"),r.className=u.className,r.style.display="none",r.appendChild(document.createTextNode(u[i.ie?"innerText":"textContent"])),document.body.appendChild(r);try{o=SyntaxHighlighter.highlight(r,null,!0)}catch(c){n.remove(r);return}e=t.document.createElement("div"),e.innerHTML=o,e.firstChild.setAttribute("highlighter",r.className),u.parentNode.insertBefore(e.firstChild,u),n.remove(r),n.remove(u),f()}}var t=this;t.commands.highlightcode={execCommand:function(r,u,e){var o,a,l;if(u&&e)o=document.createElement("pre"),o.className="brush: "+e+";toolbar:false;",o.style.display="",o.appendChild(document.createTextNode(u)),document.body.appendChild(o),t.queryCommandState("highlightcode")&&t.execCommand("highlightcode"),t.execCommand("inserthtml",SyntaxHighlighter.highlight(o,null,!0)),a=t.document.getElementById(SyntaxHighlighter.getHighlighterDivId()),a.setAttribute("highlighter",o.className),n.remove(o),f();else{var s=this.selection.getRange(),c=n.findParentByTagName(s.startContainer,"table",!0),v=n.findParentByTagName(s.endContainer,"table",!0),h;c&&v&&c===v&&c.parentNode.className.indexOf("syntaxhighlighter")>-1&&(h=c.parentNode,n.isBody(h.parentNode)?(l=t.document.createElement("p"),l.innerHTML=i.ie?"":"<br/>",t.body.insertBefore(l,h),s.setStart(l,0)):s.setStartBefore(h),s.setCursor(),n.remove(h))}},queryCommandState:function(){var r=this.selection.getRange(),i,t;return r.adjustmentBoundary(),i=n.findParent(r.startContainer,function(t){return t.nodeType==1&&t.tagName=="DIV"&&n.hasClass(t,"syntaxhighlighter")},!0),t=n.findParent(r.endContainer,function(t){return t.nodeType==1&&t.tagName=="DIV"&&n.hasClass(t,"syntaxhighlighter")},!0),i&&t&&i==t?1:0}},t.addListener("beforeselectionchange",function(){t.highlight=t.queryCommandState("highlightcode")}),t.addListener("afterselectionchange",function(){t.highlight=0}),t.addListener("ready",function(){var n;typeof XRegExp=="undefined"&&(n={id:"syntaxhighlighter_js",src:t.options.highlightJsUrl,tag:"script",type:"text/javascript",defer:"defer"},u.loadFile(document,n,function(){r()})),t.document.getElementById("syntaxhighlighter_css")||(n={id:"syntaxhighlighter_css",tag:"link",rel:"stylesheet",type:"text/css",href:t.options.highlightCssUrl},u.loadFile(t.document,n))}),t.addListener("beforegetcontent",function(){for(var o,f,e,s,h,c,l=0,a=n.getElementsByTagName(t.body,"div");o=a[l++];)if(o.className=="container"){f=o.parentNode;while(f){if(f.tagName=="DIV"&&/highlighter/.test(f.id))break;f=f.parentNode}if(!f)return;for(e=t.document.createElement("pre"),s=[],h=0;c=o.childNodes[h++];)s.push(c[i.ie?"innerText":"textContent"]);e.appendChild(t.document.createTextNode(s.join("\n"))),e.className=f.getAttribute("highlighter"),f.parentNode.insertBefore(e,f),n.remove(f)}}),t.addListener("aftergetcontent",function(){r()}),t.addListener("aftersetcontent",function(){r()}),t.addListener("fullscreenchanged",function(){for(var s=n.getElementsByTagName(t.document,"div"),u,f,i,e,r,o=0;u=s[o++];)if(/^highlighter/.test(u.id))for(f=u.getElementsByTagName("td"),i=0;e=f[0].childNodes[i];i++)r=f[1].firstChild.childNodes[i],r.style.height=e.style.height=r.offsetHeight+"px"})},UE.plugins.serialize=function(){function y(n){return/pt/.test(n)?n.replace(/([\d.]+)pt/g,function(n){return Math.round(parseFloat(n)*96/72)+"px"}):n}function w(n){var i,t;return n&&n.tag=="p"&&(n.attributes["class"]=="MsoListParagraph"||/mso-list/.test(n.attributes.style)?i=1:(t=n.children[0],t&&t.tag=="span"&&/Wingdings/i.test(t.attributes.style)&&(i=1))),i}function ut(h,c){var ot,g,et,ft,v,rt,p,nt,y,tt,it,l,ut,k;if(h.type=="element"&&!h.children.length&&r.$removeEmpty[h.tag]&&h.tag!="a")return{type:"fragment",children:[]};ot=[0,10,12,16,18,24,32,48],et=u.indexOf;switch(h.tag){case"img":if(h.attributes.src&&/^data:/.test(h.attributes.src))return{type:"fragment",children:[]};if(h.attributes.src&&/^(?:file)/.test(h.attributes.src)){if(!/(gif|bmp|png|jpg|jpeg)$/.test(h.attributes.src))return{type:"fragment",children:[]};h.attributes.word_img=h.attributes.src,h.attributes.src=f.options.UEDITOR_HOME_URL+"themes/default/images/spacer.gif",ft=parseInt(h.attributes.width)<128||parseInt(h.attributes.height)<43,h.attributes.style="background:url("+f.options.UEDITOR_HOME_URL+"themes/default/images/"+(ft?"word.gif":"localimage.png")+") no-repeat center center;border:1px solid #ddd",c&&(c.flag=1)}i.ie&&i.version<7&&f.options.relativePath&&(h.attributes.orgSrc=h.attributes.src),h.attributes.data_ue_src=h.attributes.data_ue_src||h.attributes.src;break;case"li":v=h.children[0],(!v||v.type!="element"||v.tag!="p"&&r.p[v.tag])&&(rt={type:"element",tag:"p",attributes:{},parent:h},rt.children=v?h.children:[i.ie?{type:"text",data:n.fillChar,parent:rt}:{type:"element",tag:"br",attributes:{},closed:!0,children:[],parent:rt}],h.children=[rt]);break;case"table":case"td":a(h);break;case"a":h.attributes.anchorname&&(h.tag="img",h.attributes={"class":"anchorclass",anchorname:h.attributes.name},h.closed=1),h.attributes.href&&(h.attributes.data_ue_src=h.attributes.href);break;case"b":h.tag=h.name="strong";break;case"i":h.tag=h.name="em";break;case"u":h.tag=h.name="span",h.attributes.style=(h.attributes.style||"")+";text-decoration:underline;";break;case"s":case"del":h.tag=h.name="span",h.attributes.style=(h.attributes.style||"")+";text-decoration:line-through;",h.children.length==1&&(v=h.children[0],v.tag==h.tag&&(h.attributes.style+=";"+v.attributes.style,h.children=v.children));break;case"span":if(/mso-list/.test(h.attributes.style)){if(o!="end"){p=h.children[0];while(p.type=="element")p=p.children[0];for(nt in b)if(b[nt].test(p.data)){t="ul",e=nt;break}if(!t)for(nt in d)if(d[nt].test(p.data.replace(/\.$/,""))){t="ol",e=nt;break}o?(p.data==o?(t!="ul"&&(e=""),t="ul"):(t!="ol"&&(e=""),t="ol"),o="end"):o=p.data;if(t){y=h;while(y&&y.tag!="ul"&&y.tag!="ol")y=y.parent;y&&(y.tag=t,y.attributes.style="list-style-type:"+e)}}h={type:"fragment",children:[]};break}tt=h.attributes.style,tt&&(tt=tt.match(/(?:\b(?:color|font-size|background(-color)?|font-family|text-decoration)\b\s*:\s*(&[^;]+;|[^;])+(?=;)?)/gi),tt&&(h.attributes.style=tt.join(";"),h.attributes.style||delete h.attributes.style)),i.gecko&&i.version<=10902&&h.parent&&(it=h.parent,it.tag=="span"&&it.attributes&&it.attributes.style&&(h.attributes.style=it.attributes.style+";"+h.attributes.style)),u.isEmptyObject(h.attributes)&&(h.type="fragment");break;case"font":h.tag=h.name="span",g=h.attributes,h.attributes={style:(g.size?"font-size:"+(ot[g.size]||12)+"px":"")+";"+(g.color?"color:"+g.color:"")+";"+(g.face?"font-family:"+g.face:"")+";"+(g.style||"")};while(h.parent.tag==h.tag&&h.parent.children.length==1)h.attributes.style&&(h.parent.attributes.style?h.parent.attributes.style+=";"+h.attributes.style:h.parent.attributes.style=h.attributes.style),h.parent.children=h.children,h=h.parent;break;case"p":h.attributes.align&&(h.attributes.style=(h.attributes.style||"")+";text-align:"+h.attributes.align+";",delete h.attributes.align);if(w(h)){if(!s){l={type:"element",tag:"ul",attributes:{},children:[]},ut=et(h.parent.children,h),h.parent.children[ut]=l,l.parent=h.parent,l.children[0]=h,h.parent=l;for(;;){h=l.parent.children[ut+1];if(w(h))l.children[l.children.length]=h,h.parent=l,l.parent.children.splice(ut+1,1);else break}return l}h.tag=h.name="li";if(i.webkit){k=h.children[0];while(k&&k.type=="element")k=k.children[0];k&&(k.parent.attributes.style=(k.parent.attributes.style||"")+";mso-list:10")}delete h.attributes["class"],delete h.attributes.style}}return h}function a(n){if(h&&n.attributes.style){var t=n.attributes.style;n.attributes.style=t.replace(/;\s*/g,";"),n.attributes.style=n.attributes.style.replace(/^\s*|\s*$/,"")}}function nt(t){switch(t.tag){case"table":!t.attributes.style&&delete t.attributes.style,h&&t.attributes.style&&a(t);break;case"td":case"th":if(/display\s*:\s*none/i.test(t.attributes.style))return{type:"fragment",children:[]};if(h&&!t.children.length){var i={type:"text",data:n.fillChar,parent:t};t.children[0]=i}h&&t.attributes.style&&a(t);break;case"img":t.attributes.anchorname?(t.tag="a",t.attributes={name:t.attributes.anchorname,anchorname:1},t.closed=null):t.attributes.data_ue_src&&(t.attributes.src=t.attributes.data_ue_src,delete t.attributes.data_ue_src);break;case"a":t.attributes.data_ue_src&&(t.attributes.href=t.attributes.data_ue_src,delete t.attributes.data_ue_src)}return t}function c(n,t,i){var u,r,e,f;if(!n.children||!n.children.length)return n;for(u=n.children,r=0;r<u.length;r++)e=t(u[r],i),e.type=="fragment"?(f=[r,1],f.push.apply(f,e.children),u.splice.apply(u,f),u.length||(n={type:"fragment",children:[]}),r--):u[r]=e;return n}function l(n){this.rules=n}var h=i.ie,tt=i.version,f=this,v=r.$empty,rt=function(){function f(n,r){var c,v=0,u,f,p,w,a,e;t.exec("");while(c=t.exec(n)){p=c.index;if(p>v){w=n.slice(v,p);if(f)f.push(w);else r.onText(w)}v=t.lastIndex;if(u=c[1]){u=u.toLowerCase();if(f&&u==f._tag_name){r.onCDATA(f.join(""));f=null}if(!f){r.onTagClose(u);continue}}if(f){f.push(c[0]);continue}if(u=c[3]){if(/="/.test(u))continue;u=u.toLowerCase();var y=c[4],l,b={},k=y&&y.slice(-1)=="/";if(y){i.exec("");while(l=i.exec(y))a=l[1].toLowerCase(),e=l[2]||l[3]||l[4]||"",!e&&o[a]&&(e=a),a=="style"&&h&&tt<=6&&(e=e.replace(/(?!;)\s*([\w-]+):/g,function(n,t){return t.toLowerCase()+":"})),e&&(b[a]=e.replace(/:\s*/g,":"))}r.onTagOpen(u,b,k);!f&&s[u]&&(f=[],f._tag_name=u);continue}if(u=c[2])r.onComment(u)}if(n.length>v)r.onText(n.slice(v,n.length))}var t=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,i=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,o={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1},s={script:1,style:1},n={li:{$:"ul",ul:1,ol:1},dd:{$:"dl",dl:1},dt:{$:"dl",dl:1},option:{$:"select",select:1},td:{$:"tr",tr:1},th:{$:"tr",tr:1},tr:{$:"tbody",tbody:1,thead:1,tfoot:1,table:1},tbody:{$:"table",table:1,colgroup:1},thead:{$:"table",table:1},tfoot:{$:"table",table:1},col:{$:"colgroup",colgroup:1}},e={table:"td",tbody:"td",thead:"td",tfoot:"td",tr:"td",colgroup:"col",ul:"li",ol:"li",dl:"dd",select:"option"};return function(t,i){function l(n){n.parent=o,o.children.push(n)}function c(t,f){var e=t;if(n[e.tag]){while(n[o.tag]&&n[o.tag][e.tag])o=o.parent;o.tag==e.tag&&(o=o.parent);while(n[e.tag]){if(n[e.tag][o.tag])break;e=e.parent={type:"element",tag:n[e.tag].$,attributes:{},children:[e]}}}if(i)while(r[e.tag]&&!(o.tag=="span"?u.extend(r.strong,{a:1,A:1}):r[o.tag]||r.div)[e.tag]){if(s(o))continue;if(!o.parent)break;o=o.parent}return e.parent=o,o.children.push(e),f&&(o=t),t.attributes.style&&(t.attributes.style=t.attributes.style.toLowerCase()),t}function s(n){var t;return!n.children.length&&(t=e[n.tag])?(c({type:"element",tag:t,attributes:{},children:[]},!0),!0):!1}var h={type:"fragment",parent:null,children:[]},o=h;f(t,{onText:function(n){while(!(r[o.tag]||r.div)["#"]){if(s(o))continue;o=o.parent}l({type:"text",data:n})},onComment:function(n){l({type:"comment",data:n})},onCDATA:function(n){while(!(r[o.tag]||r.div)["#"]){if(s(o))continue;o=o.parent}l({type:"cdata",data:n})},onTagOpen:function(n,t,i){i=i||v[n],c({type:"element",tag:n,attributes:t,closed:i,children:[]},!i)},onTagClose:function(n){var t=o,i;while(t&&n!=t.tag)t=t.parent;if(t){for(i=o;i!==t.parent;i=i.parent)s(i);o=t.parent}else r.$removeEmpty[n]||r.$removeEmptyBlock[n]||n=="embed"||(t={type:"element",tag:n,attributes:{},children:[]},c(t,!0),s(t),o=t.parent)}});while(o!==h)s(o),o=o.parent;return h}}(),p=function(){function n(n){return t[n]}var t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return function(t){return t=t+"",t?t.replace(/[<>"']/g,n):""}}(),k=function(){function t(n,t){for(var f=n.children,r=[],u,i=0;u=f[i];i++)r.push(k(u,t));return r.join("")}function e(n){var r=[],i,t;for(i in n)t=n[i],i=="style"&&(t=y(t),/rgba?\s*\([^)]*\)/.test(t)&&(t=t.replace(/rgba?\s*\(([^)]*)\)/g,function(n){return u.fixColor("color",n)})),n[i]=u.optCss(t.replace(/windowtext/g,"#000"))),r.push(i+'="'+p(n[i])+'"');return r.join(" ")}function o(n,t){return t?n.data.replace(/&nbsp;/g," "):p(n.data).replace(/ /g,"&nbsp;")}function f(r,u){var f=r.tag,s,o;return u&&f=="td"?(o||(o=""),o+=t(r,u)+"&nbsp;&nbsp;&nbsp;"):(s=e(r.attributes),o="<"+(u&&n[f]?n[f]:f)+(s?" "+s:"")+(v[f]?" />":">"),v[f]||(i.ie&&f=="p"&&!r.children.length&&(o+="&nbsp;"),o+=t(r,u),o+="</"+(u&&n[f]?n[f]:f)+">")),o}var n={div:"p",li:"p",tr:"p",br:"br",p:"p"};return function(n,i){return n.type=="fragment"?t(n,i):n.type=="element"?f(n,i):n.type=="text"||n.type=="cdata"?o(n,r.$notTransContent[n.parent.tag]):n.type=="comment"?"<!--"+n.data+"-->":""}}(),it=function(){function r(n){var t=new RegExp(/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<v:)/ig);return t.test(n)}function n(n){return n=n.replace(/([\d.]+)([\w]+)?/g,function(n,t,i){return(Math.round(parseFloat(t))||1)+(i||"px")})}function i(t){return t=t.replace(/<!--\s*EndFragment\s*-->[\s\S]*$/,"").replace(/^(\r\n|\n|\r)|(\r\n|\n|\r)$/ig,"").replace(/^\s*(&nbsp;)+/ig,"").replace(/(&nbsp;|<br[^>]*>)+\s*$/ig,"").replace(/<!--[\s\S]*?-->/ig,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(n){var r=n.match(/width:([ \d.]*p[tx])/i)[1],i=n.match(/height:([ \d.]*p[tx])/i)[1],t=n.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+y(r)+'" height="'+y(i)+'" src="'+t+'" />'}).replace(/v:\w+=["']?[^'"]+["']?/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/(lang)\s*=\s*([\'\"]?)[\w-]+\2/ig,"").replace(/<font[^>]*>\s*<\/font>/gi,"").replace(/class\s*=\s*["']?(?:(?:MsoTableGrid)|(?:MsoNormal(Table)?))\s*["']?/gi,""),t=t.replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(t,i,r,u){for(var o=[],f=0,l=u.replace(/^\s+|\s+$/,"").replace(/&quot;/gi,"'").split(/;\s*/g),c,s,e,h,f=0;f<l.length;f++){c=l[f],h=c.split(":");if(h.length==2){s=h[0].toLowerCase(),e=h[1].toLowerCase();switch(s){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":/<table/.test(i)||(o[f]=s.replace(/^mso-|-alt$/g,"")+":"+n(e));continue;case"horiz-align":o[f]="text-align:"+e;continue;case"vert-align":o[f]="vertical-align:"+e;continue;case"font-color":case"mso-foreground":o[f]="color:"+e;continue;case"mso-background":case"mso-highlight":o[f]="background:"+e;continue;case"mso-default-height":o[f]="min-height:"+n(e);continue;case"mso-default-width":o[f]="min-width:"+n(e);continue;case"mso-padding-between-alt":o[f]="border-collapse:separate;border-spacing:"+n(e);continue;case"text-line-through":(e=="single"||e=="double")&&(o[f]="text-decoration:line-through");continue;case"mso-zero-height":e=="yes"&&(o[f]="display:none");continue;case"margin":if(!/[1-9]/.test(h[1]))continue}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(s))if(!/mso\-list/.test(s))continue;o[f]=s+":"+h[1]}}return f>0?i+' style="'+o.join(";")+'"':i}),t=t.replace(/([ ]+)<\/span>/ig,function(n,t){return new Array(t.length+1).join("&nbsp;")+"</span>"})}return function(n){return s=null,t="",e="",o="",r(n)&&(n=i(n)),n.replace(/>[ \t\r\n]*</g,"><")}}(),g={text:"#text",comment:"#comment",cdata:"#cdata-section",fragment:"#document-fragment"},s,d={decimal:/\d+/,"lower-roman":/^m{0,4}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$/,"upper-roman":/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/,"lower-alpha":/^\(?[a-z]+\)?$/,"upper-alpha":/^\(?[A-Z]+\)?$/},b={disc:/^[l\u00B7\u2002]/,circle:/^[\u006F\u00D8]/,square:/^[\u006E\u25C6]/},t="",e="",o;l.prototype={rules:null,filter:function(n,t,i){function u(n,t){var h,s,o,e;n.name=n.type=="element"?n.tag:g[n.type];if(t==null)return c(n,u,n);if(f&&f[n.name])return i&&(i.flag=1),{type:"fragment",children:[]};if(r)if(n.type=="element")if(t.type=="fragment"?r[n.name]:r[n.name]&&r[t.name][n.name]){if(h=r[n.name].$){s=n.attributes,o={};for(e in h)s[e]&&(o[e]=s[e]);n.attributes=o}}else i&&(i.flag=1),n.type="fragment",n.name=t.name;return(f||r)&&c(n,u,n),n}t=t||this.rules;var r=t&&t.whiteList,f=t&&t.blackList;return u(n,null)},transformInput:function(n,i){function u(n){return n=ut(n,i),(n.tag=="ol"||n.tag=="ul")&&(s=1),n=c(n,u,n),(n.tag=="ol"||n.tag=="ul")&&(s=0,t="",e="",o=""),n.type=="text"&&n.data.replace(/\s/g,"")==f.options.pageBreakTag&&(n.type="element",n.name=n.tag="hr",delete n.data,n.attributes={"class":"pagebreak",noshade:"noshade",size:"5",unselectable:"on",style:"moz-user-select:none;-khtml-user-select: none;"},n.children=[]),n.type=="text"&&!r.$notTransContent[n.parent.tag]&&(n.data=n.data.replace(/[\r\t\n]*/g,"")),n}return u(n)},transformOutput:function(n){function t(n){return n.tag=="hr"&&n.attributes["class"]=="pagebreak"&&(delete n.tag,n.type="text",n.data=f.options.pageBreakTag,delete n.children),n=nt(n),(n.tag=="ol"||n.tag=="ul")&&(s=1),n=c(n,t,n),(n.tag=="ol"||n.tag=="ul")&&(s=0),n}return t(n)},toHTML:k,parseHTML:rt,word:it},f.serialize=new l(f.options.serialize),UE.serialize=new l({})},UE.plugins.video=function(){function r(n,i,r,u,f,e){return f?'<embed type="application/x-shockwave-flash" class="edui-faked-video" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+n+'" width="'+i+'" height="'+r+'" align="'+u+'"'+(u!="none"?' style= "'+(u=="center"?"display:block;":" float: "+u)+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >':(e?"<p "+(u!="none"?u=="center"?' style="text-align:center;" ':' style="float:"'+u:"")+">":"")+'<img align="'+u+'" width="'+i+'" height="'+r+'" _url="'+n+'" class="edui-faked-video" src="'+t.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" style="background:url('+t.options.UEDITOR_HOME_URL+'themes/default/images/videologo.gif) no-repeat center center; border:1px solid gray;" />'+(e?"</p>":"")}function i(i){for(var f,s=n.getElementsByTagName(t.document,i?"img":"embed"),u,o,e=0;u=s[e++];){if(u.className!="edui-faked-video")continue;f=t.document.createElement("div"),o=u.style.cssFloat,f.innerHTML=r(i?u.getAttribute("_url"):u.getAttribute("src"),u.width,u.height,o||u.getAttribute("align"),i),u.parentNode.replaceChild(f.firstChild,u)}}var t=this,f;t.addListener("beforegetcontent",function(){i(!0)}),t.addListener("aftersetcontent",function(){i(!1)}),t.addListener("aftergetcontent",function(n){if(n=="aftergetcontent"&&t.queryCommandState("source"))return;i(!1)}),t.commands.insertvideo={execCommand:function(n,i){var o,e,f,s;for(i=u.isArray(i)?i:[i],o=[],e=0,s=i.length;e<s;e++)f=i[e],o.push(r(f.url,f.width||420,f.height||280,f.align||"none",!1,!0));t.execCommand("inserthtml",o.join(""))},queryCommandState:function(){var n=t.selection.getRange().getClosedNode(),i=n&&n.className=="edui-faked-video";return this.highlight?-1:i?1:0}}},UE.plugins.table=function(){function r(n){for(var r=n.parentNode.cells,i,t=0;i=r[t];t++)if(i===n)return t}function v(i,r){var f=i.ownerDocument.createElement("p"),u;n.fillNode(t.document,f),u=i.parentNode,u&&u.getAttribute("dropdrag")&&(i=u),i.parentNode.insertBefore(f,i),n.remove(i),r.setStart(f,0).setCursor()}function u(n){return n.style.display=="none"}function h(n){for(var r=0,t,i=0;t=n[i++];)u(t)||r++;return r}function c(){t.currentSelectedArr=[],e=null}function l(n,t){if(a(t))return;if(a(n)){n.innerHTML=t.innerHTML;return}var i=n.lastChild;(i.nodeType!=1||i.tagName!="BR")&&n.appendChild(n.ownerDocument.createElement("br"));while(i=t.firstChild)n.appendChild(i)}function b(n,t){var k=n.parentNode,nt=t.parentNode,p=k.rowIndex,d=nt.rowIndex,i=k.parentNode.parentNode.rows,g=i.length,ut=i[0].cells.length,b=r(n),w=r(t),o,a,l,c,f,e;if(n==t)return{beginRowIndex:p,beginCellIndex:b,endRowIndex:p+n.rowSpan-1,endCellIndex:w+n.colSpan-1};for(var v=Math.min(p,d),s=Math.min(b,w),h=Math.max(p+n.rowSpan-1,d+t.rowSpan-1),y=Math.max(b+n.colSpan-1,w+t.colSpan-1);;){var it=v,tt=s,rt=h,ft=y;if(v>0)for(c=s;c<=y;)o=i[v].cells[c],u(o)&&(v=o.getAttribute("rootRowIndex"),o=i[o.getAttribute("rootRowIndex")].cells[o.getAttribute("rootCellIndex")]),c=r(o)+(o.colSpan||1);if(s>0)for(a=v;a<=h;)l=i[a].cells[s],u(l)&&(s=l.getAttribute("rootCellIndex"),l=i[l.getAttribute("rootRowIndex")].cells[l.getAttribute("rootCellIndex")]),a=l.parentNode.rowIndex+(l.rowSpan||1);if(h<g)for(c=s;c<=y;)f=i[h].cells[c],u(f)&&(f=i[f.getAttribute("rootRowIndex")].cells[f.getAttribute("rootCellIndex")]),h=f.parentNode.rowIndex+f.rowSpan-1,c=r(f)+(f.colSpan||1);if(y<ut)for(a=v;a<=h;)e=i[a].cells[y],u(e)&&(e=i[e.getAttribute("rootRowIndex")].cells[e.getAttribute("rootCellIndex")]),y=r(e)+e.colSpan-1,a=e.parentNode.rowIndex+(e.rowSpan||1);if(tt==s&&ft==y&&rt==h&&it==v)break}return{beginRowIndex:v,beginCellIndex:s,endRowIndex:h,endCellIndex:y}}function y(i,r){e=r.target||r.srcElement;if(t.queryCommandState("highlightcode")||n.findParent(e,function(n){return n.tagName=="DIV"&&/highlighter/.test(n.id)}))return;if(r.button==2)return;t.document.body.style.webkitUserSelect="",o(t.currentSelectedArr),n.clearSelectedArr(t.currentSelectedArr),e.tagName!=="TD"&&(e=n.findParentByTagName(e,"td")||e),e.tagName=="TD"?t.addListener("mouseover",function(n,i){var r=i.target||i.srcElement;p.call(t,r),i.preventDefault?i.preventDefault():i.returnValue=!1}):c()}function p(n){var u,r;e&&n.tagName=="TD"&&(t.document.body.style.webkitUserSelect="none",u=n.parentNode.parentNode.parentNode,t.selection.getNative()[i.ie?"empty":"removeAllRanges"](),r=b(e,n),w(u,r))}function w(n,i){var e=n.rows,r,u,f;for(o(t.currentSelectedArr),r=i.beginRowIndex;r<=i.endRowIndex;r++)for(u=i.beginCellIndex;u<=i.endCellIndex;u++)f=e[r].cells[u],f.className=t.options.selectedTdClass,t.currentSelectedArr.push(f)}function s(t){for(var a=t.getElementsByTagName("td"),s,o,v=t.rows,i,f,e,h,c,l=0;i=a[l++];){if(!u(i))for(s=i.parentNode.rowIndex,o=r(i),f=0;f<i.rowSpan;f++)for(e=f==0?1:0;e<i.colSpan;e++)h=v[s+f].children[o+e],h.setAttribute("rootRowIndex",s),h.setAttribute("rootCellIndex",o);u(i)||n.removeAttributes(i,["rootRowIndex","rootCellIndex"]),i.colSpan&&i.colSpan==1&&i.removeAttribute("colSpan"),i.rowSpan&&i.rowSpan==1&&i.removeAttribute("rowSpan"),!u(i)&&(c=i.style.width)&&/%/.test(c)&&(i.style.width=Math.floor(100/i.parentNode.cells.length)+"%")}}var t=this,k=n.keys,o=n.clearSelectedArr,e,d,a=n.isEmptyNode;t.currentSelectedArr=[],t.addListener("mousedown",y),t.addListener("keydown",function(n,i){var r=i.keyCode||i.which;!k[r]&&!i.ctrlKey&&!i.metaKey&&!i.shiftKey&&!i.altKey&&o(t.currentSelectedArr)}),t.addListener("mouseup",function(){var o,i,r,u;e=null,t.removeListener("mouseover",y),o=t.currentSelectedArr[0],o?(t.document.body.style.webkitUserSelect="",i=new f.Range(t.document),a(o)?i.setStart(t.currentSelectedArr[0],0).setCursor():i.selectNodeContents(t.currentSelectedArr[0]).select()):(i=t.selection.getRange().shrinkBoundary(),i.collapsed||(r=n.findParentByTagName(i.startContainer,"td",!0),u=n.findParentByTagName(i.endContainer,"td",!0),(r&&!u||!r&&u||r&&u&&r!==u)&&i.collapse(!0).select(!0)))}),t.commands.inserttable={queryCommandState:function(){if(this.highlight)return-1;var i=this.selection.getRange();return n.findParentByTagName(i.startContainer,"table",!0)||n.findParentByTagName(i.endContainer,"table",!0)||t.currentSelectedArr.length>0?-1:0},execCommand:function(r,u){var f,o,h;for(u=u||{numRows:5,numCols:5},f=['<table _innerCreateTable = "true" '],(u.cellSpacing&&u.cellSpacing!="0"||u.cellPadding&&u.cellPadding!="0")&&f.push(' style="border-collapse:separate;" '),u.cellSpacing&&u.cellSpacing!="0"&&f.push(' cellSpacing="'+u.cellSpacing+'" '),u.cellPadding&&u.cellPadding!="0"&&f.push(' cellPadding="'+u.cellPadding+'" '),f.push(' width="'+(u.width||100)+(typeof u.widthUnit=="undefined"?"%":u.widthUnit)+'" '),u.height&&f.push(' height="'+u.height+(typeof u.heightUnit=="undefined"?"%":u.heightUnit)+'" '),u.align&&f.push(' align="'+u.align+'" '),f.push(' border="'+(u.border||1)+'" borderColor="'+(u.borderColor||"#000000")+'"'),u.borderType=="1"&&f.push(' borderType="1" '),u.bgColor&&f.push(' bgColor="'+u.bgColor+'"'),f.push(" ><tbody>"),u.width=Math.floor((u.width||"100")/u.numCols),o=0;o<u.numRows;o++){for(f.push("<tr>"),h=0;h<u.numCols;h++)f.push('<td  style="width:'+u.width+(typeof u.widthUnit=="undefined"?"%":u.widthUnit)+";"+(u.borderType=="1"?"border:"+u.border+"px solid "+(u.borderColor||"#000000"):"")+'">'+(i.ie?n.fillChar:"<br/>")+"</td>");f.push("</tr>")}t.execCommand("insertHtml",f.join("")+"</tbody></table>"),c();if(u.align){var s=t.selection.getRange(),l=s.createBookmark(),e=s.startContainer;while(e&&!n.isBody(e)){if(n.isBlockElm(e)){e.style.clear="both",s.moveToBookmark(l).select();break}e=e.parentNode}}}},t.commands.edittable={queryCommandState:function(){var i=this.selection.getRange();return this.highlight?-1:n.findParentByTagName(i.startContainer,"table",!0)||t.currentSelectedArr.length>0?0:-1},execCommand:function(r,u){var h=t.selection.getStart(),f=n.findParentByTagName(h,"table",!0),s,e,o;if(f){f.style.cssText=f.style.cssText.replace(/border[^;]+/gi,""),f.style.borderCollapse=u.cellSpacing&&u.cellSpacing!="0"||u.cellPadding&&u.cellPadding!="0"?"separate":"collapse",u.cellSpacing&&u.cellSpacing!="0"?f.setAttribute("cellSpacing",u.cellSpacing):f.removeAttribute("cellSpacing"),u.cellPadding&&u.cellPadding!="0"?f.setAttribute("cellPadding",u.cellPadding):f.removeAttribute("cellPadding"),u.height&&f.setAttribute("height",u.height+u.heightUnit),u.align&&f.setAttribute("align",u.align),u.width&&f.setAttribute("width",u.width+u.widthUnit),u.bgColor&&f.setAttribute("bgColor",u.bgColor),u.borderColor&&f.setAttribute("borderColor",u.borderColor),u.border&&f.setAttribute("border",u.border);if(u.borderType=="1"){for(s=0,o=f.getElementsByTagName("td");e=o[s++];)e.style.border=u.border+"px solid "+(u.borderColor||"#000000");f.setAttribute("borderType","1")}else{for(s=0,o=f.getElementsByTagName("td");e=o[s++];)i.ie?e.style.cssText=e.style.cssText.replace(/border[^;]+/gi,""):(n.removeStyle(e,"border"),n.removeStyle(e,"border-image"));f.removeAttribute("borderType")}}}},t.commands.edittd={queryCommandState:function(){if(this.highlight)return-1;var i=this.selection.getRange();return n.findParentByTagName(i.startContainer,"table",!0)&&n.findParentByTagName(i.endContainer,"table",!0)||t.currentSelectedArr.length>0?0:-1},execCommand:function(i,r){for(var e=this.selection.getRange(),o=t.currentSelectedArr.length?t.currentSelectedArr:[n.findParentByTagName(e.startContainer,["td","th"],!0)],f,u=0;f=o[u++];)n.setAttributes(f,{bgColor:r.bgColor,align:r.align,vAlign:r.vAlign})}},t.commands.deletetable={queryCommandState:function(){if(this.highlight)return-1;var i=this.selection.getRange();return n.findParentByTagName(i.startContainer,"table",!0)&&n.findParentByTagName(i.endContainer,"table",!0)||t.currentSelectedArr.length>0?0:-1},execCommand:function(){var i=this.selection.getRange(),r=n.findParentByTagName(t.currentSelectedArr.length>0?t.currentSelectedArr[0]:i.startContainer,"table",!0);v(r,i),c()}},t.commands.addcaption={queryCommandState:function(){if(this.highlight)return-1;var i=this.selection.getRange();return n.findParentByTagName(i.startContainer,"table",!0)&&n.findParentByTagName(i.endContainer,"table",!0)||t.currentSelectedArr.length>0?0:-1},execCommand:function(i,r){var e=this.selection.getRange(),u=n.findParentByTagName(t.currentSelectedArr.length>0?t.currentSelectedArr[0]:e.startContainer,"table",!0),f;r=="on"?(f=u.createCaption(),f.innerHTML="\u8bf7\u5728\u6b64\u8f93\u5165\u8868\u683c\u6807\u9898"):u.removeChild(u.caption)}},t.commands.mergeright={queryCommandState:function(){var i,f,e;if(this.highlight)return-1;var o=this.selection.getRange(),s=o.startContainer,t=n.findParentByTagName(s,["td","th"],!0);if(!t||this.currentSelectedArr.length>1)return-1;i=t.parentNode,f=r(t)+t.colSpan;if(f>=i.cells.length)return-1;return e=i.cells[f],u(e)?-1:t.rowSpan==e.rowSpan?0:-1},execCommand:function(){for(var a=this.selection.getRange(),p=a.startContainer,u=n.findParentByTagName(p,["td","th"],!0)||t.currentSelectedArr[0],c=u.parentNode,y=c.parentNode.parentNode.rows,v=c.rowIndex,s=r(u)+u.colSpan,f=y[v].cells[s],o,h,e=v;e<v+f.rowSpan;e++)for(o=s;o<s+f.colSpan;o++)h=y[e].cells[o],h.setAttribute("rootRowIndex",c.rowIndex),h.setAttribute("rootCellIndex",r(u));u.colSpan+=f.colSpan||1,l(u,f),f.style.display="none",n.isEmptyBlock(u)?a.setStart(u,0).setCursor():a.selectNodeContents(u).setCursor(!0,!0),i.ie&&n.removeAttributes(u,["width","height"])}},t.commands.mergedown={queryCommandState:function(){var f;if(this.highlight)return-1;var c=this.selection.getRange(),l=c.startContainer,i=n.findParentByTagName(l,"td",!0);if(!i||h(t.currentSelectedArr)>1)return-1;var s=i.parentNode,a=s.parentNode.parentNode,e=a.rows,o=s.rowIndex+i.rowSpan;if(o>=e.length)return-1;return f=e[o].cells[r(i)],u(f)?-1:i.colSpan==f.colSpan?0:-1},execCommand:function(){for(var a=this.selection.getRange(),p=a.startContainer,u=n.findParentByTagName(p,["td","th"],!0)||t.currentSelectedArr[0],c=u.parentNode,y=c.parentNode.parentNode.rows,v=c.rowIndex+u.rowSpan,s=r(u),f=y[v].cells[s],o,h,e=v;e<v+f.rowSpan;e++)for(o=s;o<s+f.colSpan;o++)h=y[e].cells[o],h.setAttribute("rootRowIndex",c.rowIndex),h.setAttribute("rootCellIndex",r(u));u.rowSpan+=f.rowSpan||1,l(u,f),f.style.display="none",n.isEmptyBlock(u)?a.setStart(u,0).setCursor():a.selectNodeContents(u).setCursor(!0,!0),i.ie&&n.removeAttributes(u,["width","height"])}},t.commands.deleterow={queryCommandState:function(){if(this.highlight)return-1;var u=this.selection.getRange(),r=u.startContainer,i=n.findParentByTagName(r,["td","th"],!0);if(!i&&t.currentSelectedArr.length==0)return-1},execCommand:function(){var g=this.selection.getRange(),it=g.startContainer,e=n.findParentByTagName(it,["td","th"],!0),h,l,d,i,f,p,nt,c,o,k,w,a,b,y,tt;if(e&&t.currentSelectedArr.length==0){nt=(e.rowSpan||1)-1,t.currentSelectedArr.push(e),h=e.parentNode,l=h.parentNode.parentNode,i=l.rows,f=h.rowIndex+1,p=r(e);while(nt)t.currentSelectedArr.push(i[f].cells[p]),nt--,f++}while(e=t.currentSelectedArr.pop()){if(!n.findParentByTagName(e,"table"))continue;for(h=e.parentNode,l=h.parentNode.parentNode,d=h.cells,i=l.rows,f=h.rowIndex,p=r(e),c=0;c<d.length;)o=d[c],u(o)?(k=i[o.getAttribute("rootRowIndex")].cells[o.getAttribute("rootCellIndex")],k.rowSpan--,c+=k.colSpan):o.rowSpan==1?c+=o.colSpan:(w=i[f+1].cells[c],w.style.display="",w.rowSpan=o.rowSpan-1,w.colSpan=o.colSpan,c+=o.colSpan);n.remove(h);if(f==i.length){if(f==0){v(l,g);return}tt=f-1,a=i[tt].cells[p],b=u(a)?i[a.getAttribute("rootRowIndex")].cells[a.getAttribute("rootCellIndex")]:a}else y=i[f].cells[p],b=u(y)?i[y.getAttribute("rootRowIndex")].cells[y.getAttribute("rootCellIndex")]:y}g.setStart(b,0).setCursor(),s(l)}},t.commands.deletecol={queryCommandState:function(){if(this.highlight)return-1;var u=this.selection.getRange(),r=u.startContainer,i=n.findParentByTagName(r,["td","th"],!0);if(!i&&t.currentSelectedArr.length==0)return-1},execCommand:function(){var nt=this.selection.getRange(),et=nt.startContainer,f=n.findParentByTagName(et,["td","th"],!0),g,e,i,p,rt,c,ut,w,a,b,l,tt;if(f&&t.currentSelectedArr.length==0){g=(f.colSpan||1)-1,t.currentSelectedArr.push(f);while(g){do f=f.nextSibling;while(f.nodeType==3);t.currentSelectedArr.push(f),g--}}while(f=t.currentSelectedArr.pop()){if(!n.findParentByTagName(f,"table"))continue;var k=f.parentNode,d=k.parentNode.parentNode,h=r(f),o=d.rows,ft=k.cells,it=k.rowIndex,y;for(e=0;e<o.length;){i=o[e].cells[h];if(u(i)){for(p=o[i.getAttribute("rootRowIndex")].cells[i.getAttribute("rootCellIndex")],y=p.rowSpan,c=0;c<p.rowSpan;c++)rt=o[e+c].cells[h],n.remove(rt);p.colSpan--,e+=y}else if(i.colSpan==1){for(y=i.rowSpan,c=e,ut=e+i.rowSpan;c<ut;c++)n.remove(o[c].cells[h]);e+=y}else w=o[e].cells[h+1],w.style.display="",w.rowSpan=i.rowSpan,w.colSpan=i.colSpan-1,e+=i.rowSpan,n.remove(i)}if(h==ft.length){if(h==0){v(d,nt);return}tt=h-1,a=o[it].cells[tt],b=u(a)?o[a.getAttribute("rootRowIndex")].cells[a.getAttribute("rootCellIndex")]:a}else l=o[it].cells[h],b=u(l)?o[l.getAttribute("rootRowIndex")].cells[l.getAttribute("rootCellIndex")]:l}nt.setStart(b,0).setCursor(),s(d)}},t.commands.splittocells={queryCommandState:function(){if(this.highlight)return-1;var r=this.selection.getRange(),u=r.startContainer,i=n.findParentByTagName(u,["td","th"],!0);return i&&(i.rowSpan>1||i.colSpan>1)&&(!t.currentSelectedArr.length||h(t.currentSelectedArr)==1)?0:-1},execCommand:function(){for(var c=this.selection.getRange(),v=c.startContainer,e=n.findParentByTagName(v,["td","th"],!0),s=e.parentNode,a=s.parentNode.parentNode,p=s.rowIndex,y=r(e),l=e.rowSpan,h=e.colSpan,f,t,o=0;o<l;o++)for(f=0;f<h;f++)t=a.rows[p+o].cells[y+f],t.rowSpan=1,t.colSpan=1,u(t)&&(t.style.display="",t.innerHTML=i.ie?"":"<br/>")}},t.commands.splittorows={queryCommandState:function(){if(this.highlight)return-1;var r=this.selection.getRange(),u=r.startContainer,i=n.findParentByTagName(u,"td",!0)||t.currentSelectedArr[0];return i&&i.rowSpan>1&&(!t.currentSelectedArr.length||h(t.currentSelectedArr)==1)?0:-1},execCommand:function(){for(var p=this.selection.getRange(),w=p.startContainer,s=n.findParentByTagName(w,"td",!0)||t.currentSelectedArr[0],v=s.parentNode,k=v.parentNode.parentNode.rows,y=v.rowIndex,c=r(s),b=s.rowSpan,a=s.colSpan,l,f,h,e=0;e<b;e++)for(l=k[y+e],f=l.cells[c],f.rowSpan=1,f.colSpan=a,u(f)&&(f.style.display="",f.innerHTML=i.ie?"":"<br/>"),h=c+1;h<c+a;h++)f=l.cells[h],f.setAttribute("rootRowIndex",y+e);o(t.currentSelectedArr),this.selection.getRange().setStart(s,0).setCursor()}},t.commands.insertparagraphbeforetable={queryCommandState:function(){if(this.highlight)return-1;var r=this.selection.getRange(),u=r.startContainer,i=n.findParentByTagName(u,"td",!0)||t.currentSelectedArr[0];return i&&n.findParentByTagName(i,"table")?0:-1},execCommand:function(){var u=this.selection.getRange(),r=u.startContainer,f=n.findParentByTagName(r,"table",!0);r=t.document.createElement(t.options.enterTag),f.parentNode.insertBefore(r,f),o(t.currentSelectedArr),r.tagName=="P"?(r.innerHTML=i.ie?"":"<br/>",u.setStart(r,0)):u.setStartBefore(r),u.setCursor()}},t.commands.splittocols={queryCommandState:function(){if(this.highlight)return-1;var r=this.selection.getRange(),u=r.startContainer,i=n.findParentByTagName(u,["td","th"],!0)||t.currentSelectedArr[0];return i&&i.colSpan>1&&(!t.currentSelectedArr.length||h(t.currentSelectedArr)==1)?0:-1},execCommand:function(){for(var w=this.selection.getRange(),b=w.startContainer,s=n.findParentByTagName(b,["td","th"],!0)||t.currentSelectedArr[0],y=s.parentNode,v=y.parentNode.parentNode.rows,c=y.rowIndex,l=r(s),a=s.rowSpan,k=s.colSpan,e,h,p,f=0;f<k;f++)for(e=v[c].cells[l+f],e.rowSpan=a,e.colSpan=1,u(e)&&(e.style.display="",e.innerHTML=i.ie?"":"<br/>"),h=c+1;h<c+a;h++)p=v[h].cells[l+f],p.setAttribute("rootCellIndex",l+f);o(t.currentSelectedArr),this.selection.getRange().setStart(s,0).setCursor()}},t.commands.insertrow={queryCommandState:function(){if(this.highlight)return-1;var i=this.selection.getRange();return n.findParentByTagName(i.startContainer,"table",!0)||n.findParentByTagName(i.endContainer,"table",!0)||t.currentSelectedArr.length!=0?0:-1},execCommand:function(){for(var y=this.selection.getRange(),d=y.startContainer,w=n.findParentByTagName(d,"tr",!0)||t.currentSelectedArr[0].parentNode,v=w.parentNode.parentNode,p=v.rows,k=w.rowIndex,b=p[k].cells,e=v.insertRow(k),r,h,a,l,c,f=0;f<b.length;){h=b[f];if(u(h)){for(a=p[h.getAttribute("rootRowIndex")].cells[h.getAttribute("rootCellIndex")],a.rowSpan++,l=0;l<a.colSpan;l++)r=h.cloneNode(!1),n.removeAttributes(r,["bgColor","valign","align"]),r.rowSpan=r.colSpan=1,r.innerHTML=i.ie?"":"<br/>",r.className="",e.children[f+l]?e.insertBefore(r,e.children[f+l]):e.appendChild(r),r.style.display="none";f+=a.colSpan}else{for(c=0;c<h.colSpan;c++)r=h.cloneNode(!1),n.removeAttributes(r,["bgColor","valign","align"]),r.rowSpan=r.colSpan=1,r.innerHTML=i.ie?"":"<br/>",r.className="",e.children[f+c]?e.insertBefore(r,e.children[f+c]):e.appendChild(r);f+=h.colSpan}}s(v),y.setStart(e.cells[0],0).setCursor(),o(t.currentSelectedArr)}},t.commands.insertcol={queryCommandState:function(){if(this.highlight)return-1;var i=this.selection.getRange();return n.findParentByTagName(i.startContainer,"table",!0)||n.findParentByTagName(i.endContainer,"table",!0)||t.currentSelectedArr.length!=0?0:-1},execCommand:function(){for(var b=this.selection.getRange(),d=b.startContainer,p=n.findParentByTagName(d,["td","th"],!0)||t.currentSelectedArr[0],k=n.findParentByTagName(p,"table"),a=k.rows,c=r(p),f,l,e,v,y,w,h=0;h<a.length;){l=a[h].cells[c];if(u(l)){for(v=a[l.getAttribute("rootRowIndex")].cells[l.getAttribute("rootCellIndex")],v.colSpan++,y=0;y<v.rowSpan;y++)f=p.cloneNode(!1),n.removeAttributes(f,["bgColor","valign","align"]),f.rowSpan=f.colSpan=1,f.innerHTML=i.ie?"":"<br/>",f.className="",e=a[h+y],e.children[c]?e.insertBefore(f,e.children[c]):e.appendChild(f),f.style.display="none";h+=v.rowSpan}else{for(w=0;w<l.rowSpan;w++)f=p.cloneNode(!1),n.removeAttributes(f,["bgColor","valign","align"]),f.rowSpan=f.colSpan=1,f.innerHTML=i.ie?"":"<br/>",f.className="",e=a[h+w],e.children[c]?e.insertBefore(f,e.children[c]):e.appendChild(f),f.innerHTML=i.ie?"":"<br/>";h+=l.rowSpan}}s(k),b.setStart(a[0].cells[c],0).setCursor(),o(t.currentSelectedArr)}},t.commands.mergecells={queryCommandState:function(){var n,i,t;if(this.highlight)return-1;for(n=0,i=0;t=this.currentSelectedArr[i++];)u(t)||n++;return n>1?0:-1},execCommand:function(){for(var c=t.currentSelectedArr[0],y=t.currentSelectedArr[t.currentSelectedArr.length-1],d=n.findParentByTagName(c,"table"),w=d.rows,f={beginRowIndex:c.parentNode.rowIndex,beginCellIndex:r(c),endRowIndex:y.parentNode.rowIndex,endCellIndex:r(y)},v=f.beginRowIndex,a=f.beginCellIndex,b=f.endRowIndex-f.beginRowIndex+1,k=f.endCellIndex-f.beginCellIndex+1,h=w[v].cells[a],p,s,u,e=0;(p=w[v+e++])&&e<=b;)for(s=0;(u=p.cells[a+s++])&&s<=k;)e==1&&s==1?(u.style.display="",u.rowSpan=b,u.colSpan=k):(u.style.display="none",u.rowSpan=1,u.colSpan=1,u.setAttribute("rootRowIndex",v),u.setAttribute("rootCellIndex",a),l(h,u));this.selection.getRange().setStart(h,0).setCursor(),i.ie&&n.removeAttributes(h,["width","height"]),o(t.currentSelectedArr)}},t.adjustTable=function(u){for(var k=u.getElementsByTagName("table"),h,o,y,f,c,p,e,s,l,w=0;h=k[w++];){if(h.getAttribute("align")){o=h.nextSibling;while(o){if(n.isBlockElm(o))break;o=o.nextSibling}o&&(o.style.clear="both")}for(h.removeAttribute("_innerCreateTable"),y=n.getElementsByTagName(h,"td"),p=0;e=y[p++];){n.isEmptyNode(e)&&(e.innerHTML=i.ie?n.fillChar:"<br/>");var b=r(e),a=e.parentNode.rowIndex,v=n.findParentByTagName(e,"table").rows;for(s=0;s<e.rowSpan;s++)for(l=s==0?1:0;l<e.colSpan;l++)f?f=f.cloneNode(!0):(f=e.cloneNode(!1),f.rowSpan=f.colSpan=1,f.style.display="none",f.innerHTML=i.ie?"":"<br/>"),f.setAttribute("rootRowIndex",e.parentNode.rowIndex),f.setAttribute("rootCellIndex",b),s==0?e.nextSibling?e.parentNode.insertBefore(f,e.nextSibling):e.parentNode.appendChild(f):(c=v[a+s].children[b],c?c.parentNode.insertBefore(f,c):v[a+s].appendChild(f))}}t.fireEvent("afteradjusttable",u)}},UE.plugins.contextmenu=function(){var t=this,r,u=t.options.contextMenu,e;if(!u||u.length==0)return;e=UE.ui.uiUtils,t.addListener("contextmenu",function(o,s){var p=e.getViewportOffsetByEvent(s),l,y,h,c,a,v;for(t.fireEvent("beforeselectionchange"),r&&r.destroy(),l=0,h=[];y=u[l];l++)(function(n){if(n=="-")(c=h[h.length-1])&&c!=="-"&&h.push("-");else if(n.group){for(var r=0,u,i=[];u=n.subMenu[r];r++)(function(n){n=="-"?(c=i[i.length-1])&&c!=="-"&&i.push("-"):t.queryCommandState(n.cmdName)!=-1&&i.push({label:n.label,className:"edui-for-"+n.cmdName+(n.value||""),onclick:n.exec?function(){n.exec.call(t)}:function(){t.execCommand(n.cmdName,n.value)}})})(u);i.length&&h.push({label:n.group,className:"edui-for-"+n.icon,subMenu:{items:i,editor:t}})}else if(t.queryCommandState(n.cmdName)!=-1){if(n.cmdName=="highlightcode"&&t.queryCommandState(n.cmdName)==0)return;h.push({label:n.label,className:"edui-for-"+(n.icon?n.icon:n.cmdName+(n.value||"")),onclick:n.exec?function(){n.exec.call(t)}:function(){t.execCommand(n.cmdName,n.value)}})}})(y);h[h.length-1]=="-"&&h.pop(),r=new UE.ui.Menu({items:h,editor:t}),r.render(),r.showAt(p),n.preventDefault(s);if(i.ie){try{a=t.selection.getNative().createRange()}catch(w){return}a.item&&(v=new f.Range(t.document),v.selectNode(a.item(0)).select(!0,!0))}})},UE.plugins.basestyle=function(){var e={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},r=function(n,t){var i=n.selection.getStartElementPath();return u.findNode(i,t)},t=this,i;for(i in e)(function(i,u){t.commands[i]={execCommand:function(i){var e=new f.Range(t.document),o="",l,h,s,c;if(t.currentSelectedArr&&t.currentSelectedArr.length>0){for(l=0;h=t.currentSelectedArr[l++];)h.style.display!="none"&&(e.selectNodeContents(h).select(),!o&&(o=r(this,u)),(i=="superscript"||i=="subscript")&&(!o||o.tagName.toLowerCase()!=i)&&e.removeInlineStyle(["sub","sup"]),o?e.removeInlineStyle(u):e.applyInlineStyle(u[0]));e.selectNodeContents(t.currentSelectedArr[0]).select()}else e=t.selection.getRange(),o=r(this,u),e.collapsed?(o?(s=t.document.createTextNode(""),e.insertNode(s).removeInlineStyle(u),e.setStartBefore(s),n.remove(s)):(c=e.document.createElement(u[0]),(i=="superscript"||i=="subscript")&&(s=t.document.createTextNode(""),e.insertNode(s).removeInlineStyle(["sub","sup"]).setStartBefore(s).collapse(!0)),e.insertNode(c).setStart(c,0)),e.collapse(!0)):((i=="superscript"||i=="subscript")&&(!o||o.tagName.toLowerCase()!=i)&&e.removeInlineStyle(["sub","sup"]),o?e.removeInlineStyle(u):e.applyInlineStyle(u[0])),e.select();return!0},queryCommandState:function(){return this.highlight?-1:r(this,u)?1:0}}})(i,e[i])},UE.plugins.elementpath=function(){var i,u,t=this;t.commands.elementpath={execCommand:function(f,e){var o=u[e],a=t.selection.getRange(),h,l,v,s,p,y,c;t.currentSelectedArr&&n.clearSelectedArr(t.currentSelectedArr),i=e*1;if(r.$tableContent[o.tagName]){switch(o.tagName){case"TD":t.currentSelectedArr=[o],o.className=t.options.selectedTdClass;break;case"TR":for(h=o.cells,s=0;l=h[s++];)t.currentSelectedArr.push(l),l.className=t.options.selectedTdClass;break;case"TABLE":case"TBODY":for(v=o.rows,s=0;p=v[s++];)for(h=p.cells,y=0;c=h[y++];)t.currentSelectedArr.push(c),c.className=t.options.selectedTdClass}o=t.currentSelectedArr[0],n.isEmptyNode(o)?a.setStart(o,0).setCursor():a.selectNodeContents(o).select()}else a.selectNode(o).select()},queryCommandValue:function(){var f=[].concat(this.selection.getStartElementPath()).reverse(),e=[],n,t,r;for(u=f,n=0;t=f[n];n++){if(t.nodeType==3)continue;r=t.tagName.toLowerCase(),r=="img"&&t.getAttribute("anchorname")&&(r="anchor"),e[n]=r;if(i==n){i=-1;break}}return e}}},UE.plugins.formatmatch=function(){function e(o,s){function p(n){return c&&(!t.currentSelectedArr||!t.currentSelectedArr.length)&&n.selectNode(c),n.applyInlineStyle(u[u.length-1].tagName,null,u)}var b,h,l,w,c,a,v,y;i.webkit&&(b=s.target.tagName=="IMG"?s.target:null),t.undoManger&&t.undoManger.save(),h=t.selection.getRange(),l=b||h.getClosedNode();if(r&&l&&l.tagName=="IMG")l.style.cssText+=";float:"+(r.style.cssFloat||r.style.styleFloat||"none")+";display:"+(r.style.display||"inline"),r=null;else if(!r){w=h.collapsed,w&&(c=t.document.createTextNode("match"),h.insertNode(c).select()),t.__hasEnterExecCommand=!0,a=t.options.removeFormatAttributes,t.options.removeFormatAttributes="",t.execCommand("removeformat"),t.options.removeFormatAttributes=a,t.__hasEnterExecCommand=!1,h=t.selection.getRange();if(u.length==0)t.currentSelectedArr&&t.currentSelectedArr.length>0&&h.selectNodeContents(t.currentSelectedArr[0]).select();else if(t.currentSelectedArr&&t.currentSelectedArr.length>0){for(v=0;y=t.currentSelectedArr[v++];)h.selectNodeContents(y),p(h);h.selectNodeContents(t.currentSelectedArr[0]).select()}else p(h);(!t.currentSelectedArr||!t.currentSelectedArr.length)&&(c&&h.setStartBefore(c).collapse(!0),h.select()),c&&n.remove(c)}t.undoManger&&t.undoManger.save(),t.removeListener("mouseup",e),f=0}var t=this,u=[],r,f=0;t.addListener("reset",function(){u=[],f=0}),t.commands.formatmatch={execCommand:function(){var s,c,o,h;if(f){f=0,u=[],t.removeListener("mouseup",e);return}s=t.selection.getRange(),r=s.getClosedNode();if(!r||r.tagName!="IMG")for(s.collapse(!0).shrinkBoundary(),c=s.startContainer,u=n.findParents(c,!0,function(t){return!n.isBlockElm(t)&&t.nodeType==1}),o=0;h=u[o];o++)if(h.tagName=="A"){u.splice(o,1);break}t.addListener("mouseup",e),f=1},queryCommandState:function(){return this.highlight?-1:f},notNeedUndo:1}},UE.plugins.searchreplace=function(){var n,t,r=this;r.addListener("reset",function(){n=null,t=null}),r.commands.searchreplace={execCommand:function(r,f){var c=this,y=c.selection,o,e,a=0,f=u.extend(f,{all:!1,casesensitive:!1,dir:1},!0),l,h,s,v;if(i.ie)for(;;){e=c.document.selection.createRange(),s=e.duplicate(),s.moveToElementText(c.document.body),f.all?(t=0,f.dir=1,n&&s.setEndPoint(f.dir==-1?"EndToStart":"StartToEnd",n)):(s.setEndPoint(f.dir==-1?"EndToStart":"StartToEnd",e),f.hasOwnProperty("replaceStr")&&s.setEndPoint(f.dir==-1?"StartToEnd":"EndToStart",e)),e=s.duplicate();if(!s.findText(f.searchStr,f.dir,f.casesensitive?4:0))return n=null,s=c.document.selection.createRange(),s.scrollIntoView(),a;s.select(),f.hasOwnProperty("replaceStr")&&(o=y.getRange(),o.deleteContents().insertNode(o.document.createTextNode(f.replaceStr)).select(),n=y.getNative().createRange()),a++;if(!f.all)break}else{l=c.window,h=y.getNative();for(;;){f.all?(n?(n.collapse(!1),e=n):(e=c.document.createRange(),e.setStart(c.document.body,0)),h.removeAllRanges(),h.addRange(e),t=0,f.dir=1):(e=l.getSelection().getRangeAt(0),f.hasOwnProperty("replaceStr")&&e.collapse(f.dir==1?!0:!1)),t?h.removeAllRanges():(e.collapse(f.dir<0?!0:!1),h.removeAllRanges(),h.addRange(e));if(!l.find(f.searchStr,f.casesensitive,f.dir<0?!0:!1))return n=null,h.removeAllRanges(),a;t=0,o=l.getSelection().getRangeAt(0),o.collapsed||f.hasOwnProperty("replaceStr")&&(o.deleteContents(),v=l.document.createTextNode(f.replaceStr),o.insertNode(v),o.selectNode(v),h.addRange(o),n=o.cloneRange()),a++;if(!f.all)break}}return!0}}},UE.plugins.customstyle=function(){var t=this;t.commands.customstyle={execCommand:function(t,i){var e=this,h=i.tag,u=n.findParent(e.selection.getStart(),function(n){return n.getAttribute("label")},!0),f,s,a={},p,l,b,k,o,w,y,c,v;for(p in i)a[p]=i[p];delete a.tag;if(u&&u.getAttribute("label")==i.label){f=this.selection.getRange(),s=f.createBookmark();if(f.collapsed)r.$block[u.tagName]?(c=e.document.createElement("p"),n.moveChild(u,c),u.parentNode.insertBefore(c,u),n.remove(u)):n.remove(u,!0);else{for(l=n.getCommonAncestor(s.start,s.end),b=n.getElementsByTagName(l,h),new RegExp(h,"i").test(l.tagName)&&b.push(l),k=0;o=b[k++];)o.getAttribute("label")==i.label&&(w=n.getPosition(o,s.start),y=n.getPosition(o,s.end),(w&n.POSITION_FOLLOWING||w&n.POSITION_CONTAINS)&&(y&n.POSITION_PRECEDING||y&n.POSITION_CONTAINS)&&r.$block[h]&&(c=e.document.createElement("p"),n.moveChild(o,c),o.parentNode.insertBefore(c,o)),n.remove(o,!0));u=n.findParent(l,function(n){return n.getAttribute("label")==i.label},!0),u&&n.remove(u,!0)}f.moveToBookmark(s).select()}else if(r.$block[h])this.execCommand("paragraph",h,a,"customstyle"),f=e.selection.getRange(),f.collapsed||(f.collapse(),u=n.findParent(e.selection.getStart(),function(n){return n.getAttribute("label")==i.label},!0),v=e.document.createElement("p"),n.insertAfter(u,v),n.fillNode(e.document,v),f.setStart(v,0).setCursor());else{f=e.selection.getRange();if(f.collapsed){u=e.document.createElement(h),n.setAttributes(u,a),f.insertNode(u).setStart(u,0).setCursor();return}s=f.createBookmark(),f.applyInlineStyle(h,a).moveToBookmark(s).select()}},queryCommandValue:function(){var n=u.findNode(this.selection.getStartElementPath(),null,function(n){return n.getAttribute("label")});return n?n.getAttribute("label"):""},queryCommandState:function(){return this.highlight?-1:0}},t.addListener("keyup",function(i,u){var s=u.keyCode||u.which,o,f,e;(s==32||s==13)&&(o=t.selection.getRange(),o.collapsed&&(f=n.findParent(t.selection.getStart(),function(n){return n.getAttribute("label")},!0),f&&r.$block[f.tagName]&&n.isEmptyNode(f)&&(e=t.document.createElement("p"),n.insertAfter(f,e),n.fillNode(t.document,e),n.remove(f),o.setStart(e,0).setCursor())))})},UE.plugins.catchremoteimage=function(){function r(n,t){var r=n.join(i);f.request(u,{content:r,timeout:6e4,onsuccess:t.success,onerror:t.error})}if(!this.options.catchRemoteImageEnable)return;var f=UE.ajax,t=this,e=t.options.localDomain,u=t.options.catcherUrl,i="ue_separate_ue";t.addListener("afterpaste",function(){t.fireEvent("catchRemoteImage")}),t.addListener("catchRemoteImage",function(){for(var o=[],h=n.getElementsByTagName(t.document,"img"),u,f,s=0;u=h[s++];){if(u.getAttribute("word_img"))continue;f=u.getAttribute("data_ue_src")||u.src||"",/^(https?|ftp):/i.test(f)&&f.indexOf(e)==-1&&o.push(f)}o.length&&r(o,{success:function(r){var e,a,l,y,u,v,f,c,s,o;try{e=eval("("+r.responseText+")")}catch(p){return}for(a=e.srcUrl.split(i),l=e.url.split(i),y=0;u=h[y++];)for(v=u.getAttribute("data_ue_src")||u.src||"",f=0;c=a[f++];){s=l[f-1];if(v==c&&s!="error"){o=t.options.UEDITOR_HOME_URL+"server/"+s,n.setAttributes(u,{src:o,data_ue_src:o});break}}},error:function(){t.fireEvent("catchremoteerror")}})})},UE.commands.snapscreen={execCommand:function(){var t=this,n=t.options,r;if(!i.ie){alert(n.messages.snapScreenNotIETip);return}var f=function(i){try{i=eval("("+i+")")}catch(r){alert("\u622a\u5c4f\u4e0a\u4f20\u6709\u8bef\n\n\u8bf7\u68c0\u67e5editor_config.js\u4e2d\u5173\u4e8e\u622a\u5c4f\u7684\u914d\u7f6e\u9879\n\nsnapscreenHost \u53d8\u91cf\u503c \u5e94\u8be5\u4e3a\u5c4f\u5e55\u622a\u56fe\u7684server\u7aef\u6587\u4ef6\u6240\u5728\u7684\u7f51\u7ad9\u5730\u5740\u6216\u8005ip");return}if(i.state!="SUCCESS"){alert(i.state);return}t.execCommand("insertimage",{src:(n.snapscreenImgIsUseImagePath?n.imagePath:"")+i.url,floatStyle:n.snapscreenImgAlign,data_ue_src:(n.snapscreenImgIsUseImagePath?n.imagePath:"")+i.url})},e=function(){},u=function(){alert(n.messages.snapScreenMsg)};try{r=new ActiveXObject("Snapsie.CoSnapsie"),r.saveSnapshot(n.snapscreenHost,n.snapscreenServerFile,n.snapscreenServerPort,e,f,u)}catch(o){t.snapscreenInstall.open()}},queryCommandState:function(){return this.highlight?-1:0}},UE.commands.attachment={execCommand:function(){var n=this;top.OpenFile("open","zip,rar,doc,docx,pdf,txt,mp3,xls.chm,ppt,pptx,avi,rmvb,wmv,flv,swf,rm,exe,psd",wname,{cmd:"insertattachment"})},notNeedUndo:1},t=t||{},t.editor=t.editor||{},t.editor.ui={},(function(){function f(){var n=document.getElementById("edui_fixedlayer");i.setViewportOffset(n,{left:0,top:0})}function h(){r.on(window,"scroll",f);r.on(window,"resize",t.editor.utils.defer(f,0,!0))}var n=t.editor.browser,r=t.editor.dom.domUtils,u="$EDITORUI",o=window[u]={},s="ID"+u,e=0,i=t.editor.ui.uiUtils={uid:function(n){return n?n[s]||(n[s]=++e):++e},hook:function(n,t){var i;return n&&n._callbacks?i=n:(i=function(){var t,u,r,f;n&&(t=n.apply(this,arguments)),u=i._callbacks,r=u.length;while(r--)f=u[r].apply(this,arguments),t===undefined&&(t=f);return t},i._callbacks=[]),i._callbacks.push(t),i},createElementByHtml:function(n){var t=document.createElement("div");return t.innerHTML=n,t=t.firstChild,t.parentNode.removeChild(t),t},getViewportElement:function(){return n.ie&&n.quirks?document.body:document.documentElement},getClientRect:function(n){var i=n.getBoundingClientRect(),t={left:Math.round(i.left),top:Math.round(i.top),height:Math.round(i.bottom-i.top),width:Math.round(i.right-i.left)},u;while((u=n.ownerDocument)!==document&&(n=r.getWindow(u).frameElement))i=n.getBoundingClientRect(),t.left+=i.left,t.top+=i.top;return t.bottom=t.top+t.height,t.right=t.left+t.width,t},getViewportRect:function(){var r=i.getViewportElement(),t=(window.innerWidth||r.clientWidth)|0,n=(window.innerHeight||r.clientHeight)|0;return{left:0,top:0,height:n,width:t,bottom:n,right:t}},setViewportOffset:function(n,t){var f,u=i.getFixedLayer();n.parentNode===u?(n.style.left=t.left+"px",n.style.top=t.top+"px"):r.setViewportOffset(n,t)},getEventOffset:function(n){var u=n.target||n.srcElement,t=i.getClientRect(u),r=i.getViewportOffsetByEvent(n);return{left:r.left-t.left,top:r.top-t.top}},getViewportOffsetByEvent:function(n){var e=n.target||n.srcElement,f=r.getWindow(e).frameElement,t={left:n.clientX,top:n.clientY},u;return f&&e.ownerDocument!==document&&(u=i.getClientRect(f),t.left+=u.left,t.top+=u.top),t},setGlobal:function(n,t){return o[n]=t,u+'["'+n+'"]'},unsetGlobal:function(n){delete o[n]},copyAttributes:function(t,i){var u=i.attributes,f=u.length,r;while(f--)r=u[f],r.nodeName!="style"&&r.nodeName!="class"&&(!n.ie||r.specified)&&t.setAttribute(r.nodeName,r.nodeValue);i.className&&(t.className+=" "+i.className),i.style.cssText&&(t.style.cssText+=";"+i.style.cssText)},removeStyle:function(n,t){if(n.style.removeProperty)n.style.removeProperty(t);else if(n.style.removeAttribute)n.style.removeAttribute(t);else throw"";},contains:function(n,t){return n&&t&&(n===t?!1:n.contains?n.contains(t):n.compareDocumentPosition(t)&16)},startDrag:function(n,t,i){function u(n){var r=n.clientX-o,i=n.clientY-e;t.ondragmove(r,i);n.stopPropagation?n.stopPropagation():n.cancelBubble=!0}var i=i||document,o=n.clientX,e=n.clientY,r;if(i.addEventListener){function s(){i.removeEventListener("mousemove",u,!0),i.removeEventListener("mouseup",u,!0),t.ondragstop()}i.addEventListener("mousemove",u,!0),i.addEventListener("mouseup",s,!0),n.preventDefault()}else{r=n.srcElement,r.setCapture();function f(){r.releaseCapture(),r.detachEvent("onmousemove",u),r.detachEvent("onmouseup",f),r.detachEvent("onlosecaptrue",f),t.ondragstop()}r.attachEvent("onmousemove",u),r.attachEvent("onmouseup",f),r.attachEvent("onlosecaptrue",f),n.returnValue=!1}t.ondragstart()},getFixedLayer:function(){var t=document.getElementById("edui_fixedlayer");return t==null&&(t=document.createElement("div"),t.id="edui_fixedlayer",document.body.appendChild(t),n.ie&&n.version<=8?(t.style.position="absolute",h(),setTimeout(f)):t.style.position="fixed",t.style.left="0",t.style.top="0",t.style.width="0",t.style.height="0"),t},makeUnselectable:function(t){if(n.opera||n.ie&&n.version<9){t.unselectable="on";if(t.hasChildNodes())for(var r=0;r<t.childNodes.length;r++)t.childNodes[r].nodeType==1&&i.makeUnselectable(t.childNodes[r])}else t.style.MozUserSelect!==undefined?t.style.MozUserSelect="none":t.style.WebkitUserSelect!==undefined?t.style.WebkitUserSelect="none":t.style.KhtmlUserSelect!==undefined&&(t.style.KhtmlUserSelect="none")}}})(),(function(){var r=t.editor.utils,n=t.editor.ui.uiUtils,u=t.editor.EventBase,i=t.editor.ui.UIBase=function(){};i.prototype={className:"",uiName:"",initOptions:function(t){var r=this,i;for(i in t)r[i]=t[i];this.id=this.id||"edui"+n.uid()},initUIBase:function(){this._globalKey=r.unhtml(n.setGlobal(this.id,this))},render:function(t){var u=this.renderHtml(),r=n.createElementByHtml(u),i=this.getDom();i!=null?(i.parentNode.replaceChild(r,i),n.copyAttributes(r,i)):(typeof t=="string"&&(t=document.getElementById(t)),t=t||n.getFixedLayer(),t.appendChild(r)),this.postRender()},getDom:function(n){return n?document.getElementById(this.id+"_"+n):document.getElementById(this.id)},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(n){var t="edui-"+this.uiName;return n.replace(/##/g,this.id).replace(/%%-/g,this.uiName?t+"-":"").replace(/%%/g,(this.uiName?t:"")+" "+this.className).replace(/\$\$/g,this._globalKey)},renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var i=this.getDom();i&&t.editor.dom.domUtils.remove(i),n.unsetGlobal(this.id)}},r.inherits(i,u)})(),(function(){var i=t.editor.utils,r=t.editor.ui.UIBase,n=t.editor.ui.Separator=function(n){this.initOptions(n),this.initSeparator()};n.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}},i.inherits(n,r)})(),(function(){var r=t.editor.utils,u=t.editor.dom.domUtils,f=t.editor.ui.UIBase,i=t.editor.ui.uiUtils,n=t.editor.ui.Mask=function(n){this.initOptions(n),this.initUIBase()};n.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var n=this;u.on(window,"resize",function(){setTimeout(function(){n.isHidden()||n._fill()})})},show:function(n){this._fill(),this.getDom().style.display="",this.getDom().style.zIndex=n},hide:function(){this.getDom().style.display="none",this.getDom().style.zIndex=""},isHidden:function(){return this.getDom().style.display=="none"},_onMouseDown:function(){return!1},_fill:function(){var t=this.getDom(),n=i.getViewportRect();t.style.width=n.width+"px",t.style.height=n.height+"px"}},r.inherits(n,f)})(),(function(){function u(n){for(var u=[],i,t=0;t<r.length;t++)i=r[t],i.isHidden()||i.queryAutoHide(n)!==!1&&i.hide()}var s=t.editor.utils,n=t.editor.ui.uiUtils,e=t.editor.dom.domUtils,f=t.editor.ui.UIBase,i=t.editor.ui.Popup=function(n){this.initOptions(n),this.initPopup()},r=[],o;i.postHide=u,o=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"],i.prototype={SHADOW_RADIUS:5,content:null,_hidden:!1,autoRender:!0,canSideLeft:!0,canSideUp:!0,initPopup:function(){this.initUIBase(),r.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: white;" frameborder="0" width="100%" height="100%" src="javascript:"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>"},getContentHtmlTpl:function(){return typeof this.content=="string"?this.content:this.content.renderHtml()},_UIBase_postRender:f.prototype.postRender,postRender:function(){this.content instanceof f&&this.content.postRender(),this.fireEvent("postRenderAfter"),this.hide(!0),this._UIBase_postRender()},_doAutoRender:function(){!this.getDom()&&this.autoRender&&this.render()},mesureSize:function(){var t=this.getDom("content");return n.getClientRect(t)},fitSize:function(){var t=this.getDom("body"),n;return t.style.width="",t.style.height="",n=this.mesureSize(),t.style.width=n.width+"px",t.style.height=n.height+"px",n},showAnchor:function(t,i){this.showAnchorRect(n.getClientRect(t),i)},showAnchorRect:function(i,r){var h,f,l,c,a,v,s;this._doAutoRender(),h=n.getViewportRect(),this._show(),f=this.fitSize(),r?(l=this.canSideLeft&&i.right+f.width>h.right&&i.left>f.width,c=this.canSideUp&&i.top+f.height>h.bottom&&i.bottom>f.height,a=l?i.left-f.width:i.right,v=c?i.bottom-f.height:i.top):(l=this.canSideLeft&&i.right+f.width>h.right&&i.left>f.width,c=this.canSideUp&&i.top+f.height>h.bottom&&i.bottom>f.height,a=l?i.right-f.width:i.left,v=c?i.top-f.height:i.bottom),s=this.getDom(),n.setViewportOffset(s,{left:a,top:v}),e.removeClasses(s,o),s.className+=" "+o[(c?1:0)*2+(l?1:0)],this.editor&&(s.style.zIndex=this.editor.container.style.zIndex*1+10,t.editor.ui.uiUtils.getFixedLayer().style.zIndex=s.style.zIndex-1)},showAt:function(n){var i=n.left,t=n.top,r={left:i,top:t,right:i,bottom:t,height:0,width:0};this.showAnchorRect(r,!1,!0)},_show:function(){if(this._hidden){var n=this.getDom();n.style.display="",this._hidden=!1,this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._doAutoRender(),this._show()},hide:function(n){!this._hidden&&this.getDom()&&(this.getDom().style.display="none",this._hidden=!0,n||this.fireEvent("hide"))},queryAutoHide:function(t){return!t||!n.contains(this.getDom(),t)}},s.inherits(i,f);e.on(document,"mousedown",function(n){var t=n.target||n.srcElement;u(t)});e.on(window,"scroll",function(){u()})})(),(function(){function r(t){for(var r='<div id="##" class="edui-colorpicker %%"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+t+'</div></div><table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0"><tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#366092;padding-top: 2px"><td colspan="10">\u4e3b\u9898\u989c\u8272</td> </tr><tr class="edui-colorpicker-tablefirstrow" >',i=0;i<n.length;i++)i&&i%10==0&&(r+="</tr>"+(i==60?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#366092;"><td colspan="10">\u6807\u51c6\u989c\u8272</td></tr>':"")+"<tr"+(i==60?' class="edui-colorpicker-tablefirstrow"':"")+">"),r+=i<70?'<td style="padding: 0 2px;"><a hidefocus title="'+n[i]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell" data-color="#'+n[i]+'" style="background-color:#'+n[i]+";border:solid #ccc;"+(i<10||i>=60?"border-width:1px;":i>=10&&i<20?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"></a></td>':"";return r+="</tr></table></div>"}var f=t.editor.utils,u=t.editor.ui.UIBase,i=t.editor.ui.ColorPicker=function(n){this.initOptions(n),this.noColorText=this.noColorText||"\u4e0d\u8bbe\u7f6e\u989c\u8272",this.initUIBase()},n;i.prototype={getHtmlTpl:function(){return r(this.noColorText)},_onTableClick:function(n){var i=n.target||n.srcElement,t=i.getAttribute("data-color");t&&this.fireEvent("pickcolor",t)},_onTableOver:function(n){var i=n.target||n.srcElement,t=i.getAttribute("data-color");t&&(this.getDom("preview").style.backgroundColor=t)},_onTableOut:function(){this.getDom("preview").style.backgroundColor=""},_onPickNoColor:function(){this.fireEvent("picknocolor")}},f.inherits(i,u),n="ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,".split(",")})(),(function(){var u=t.editor.utils,n=t.editor.ui.uiUtils,i=t.editor.ui.UIBase,r=t.editor.ui.TablePicker=function(n){this.initOptions(n),this.initTablePicker()};r.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-tablepicker %%"><div class="edui-tablepicker-body"><div class="edui-infoarea"><span id="##_label" class="edui-label"></span><span class="edui-clickable" onclick="$$._onMore();">\u66f4\u591a</span></div><div class="edui-pickarea" onmousemove="$$._onMouseMove(event, this);" onmouseover="$$._onMouseOver(event, this);" onmouseout="$$._onMouseOut(event, this);" onclick="$$._onClick(event, this);"><div id="##_overlay" class="edui-overlay"></div></div></div></div>'},_UIBase_render:i.prototype.render,render:function(n){this._UIBase_render(n),this.getDom("label").innerHTML="0\u5217 x 0\u884c"},_track:function(n,t){var u=this.getDom("overlay").style,r=this.lengthOfCellSide,i;u.width=n*r+"px",u.height=t*r+"px",i=this.getDom("label"),i.innerHTML=n+"\u5217 x "+t+"\u884c",this.numCols=n,this.numRows=t},_onMouseOver:function(t,i){var r=t.relatedTarget||t.fromElement;!n.contains(i,r)&&i!==r&&(this.getDom("label").innerHTML="0\u5217 x 0\u884c",this.getDom("overlay").style.visibility="")},_onMouseOut:function(t,i){var r=t.relatedTarget||t.toElement;!n.contains(i,r)&&i!==r&&(this.getDom("label").innerHTML="0\u5217 x 0\u884c",this.getDom("overlay").style.visibility="hidden")},_onMouseMove:function(t){var o=this.getDom("overlay").style,u=n.getEventOffset(t),r=this.lengthOfCellSide,e=Math.ceil(u.left/r),f=Math.ceil(u.top/r);this._track(e,f)},_onClick:function(){this.fireEvent("picktable",this.numCols,this.numRows)},_onMore:function(){this.fireEvent("more")}},u.inherits(r,i)})(),(function(){var u=t.editor.browser,i=t.editor.dom.domUtils,n=t.editor.ui.uiUtils,r='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(u.ie?' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"':' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"');t.editor.ui.Stateful={alwalysHoverable:!1,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl,this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){var n=this._Stateful_dGetHtmlTpl();return n.replace(/stateful/g,function(){return r})},Stateful_onMouseEnter:function(){(!this.isDisabled()||this.alwalysHoverable)&&(this.addState("hover"),this.fireEvent("over"))},Stateful_onMouseLeave:function(){(!this.isDisabled()||this.alwalysHoverable)&&(this.removeState("hover"),this.removeState("active"),this.fireEvent("out"))},Stateful_onMouseOver:function(t,i){var r=t.relatedTarget;!n.contains(i,r)&&i!==r&&this.Stateful_onMouseEnter(t,i)},Stateful_onMouseOut:function(t,i){var r=t.relatedTarget;!n.contains(i,r)&&i!==r&&this.Stateful_onMouseLeave(t,i)},Stateful_onMouseDown:function(){this.isDisabled()||this.addState("active")},Stateful_onMouseUp:function(){this.isDisabled()||this.removeState("active")},Stateful_postRender:function(){this.disabled&&!this.hasState("disabled")&&this.addState("disabled")},hasState:function(n){return i.hasClass(this.getStateDom(),"edui-state-"+n)},addState:function(n){this.hasState(n)||(this.getStateDom().className+=" edui-state-"+n)},removeState:function(n){this.hasState(n)&&i.removeClasses(this.getStateDom(),["edui-state-"+n])},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(n){!this.isDisabled()&&n?this.addState("checked"):this.removeState("checked")},isDisabled:function(){return this.hasState("disabled")},setDisabled:function(n){n?(this.removeState("hover"),this.removeState("checked"),this.removeState("active"),this.addState("disabled")):this.removeState("disabled")}}})(),(function(){var i=t.editor.utils,r=t.editor.ui.UIBase,u=t.editor.ui.Stateful,n=t.editor.ui.Button=function(n){this.initOptions(n),this.initButton()};n.prototype={uiName:"button",label:"",title:"",showIcon:!0,showText:!0,initButton:function(){this.initUIBase(),this.Stateful_init()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return false;" onclick="return $$._onClick();">'+(this.showIcon?'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div></div></div></div>"},postRender:function(){this.Stateful_postRender()},_onClick:function(){this.isDisabled()||this.fireEvent("click")}},i.inherits(n,r),i.extend(n.prototype,u)})(),(function(){var n=t.editor.utils,r=t.editor.ui.uiUtils,e=t.editor.dom.domUtils,u=t.editor.ui.UIBase,f=t.editor.ui.Stateful,i=t.editor.ui.SplitButton=function(n){this.initOptions(n),this.initSplitButton()};i.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){var t,n;this.initUIBase(),this.Stateful_init(),t=this,this.popup!=null&&(n=this.popup,this.popup=null,this.setPopup(n))},_UIBase_postRender:u.prototype.postRender,postRender:function(){this.Stateful_postRender(),this._UIBase_postRender()},setPopup:function(t){if(this.popup===t)return;this.popup!=null&&this.popup.dispose(),t.addListener("show",n.bind(this._onPopupShow,this)),t.addListener("hide",n.bind(this._onPopupHide,this)),t.addListener("postrender",n.bind(function(){t.getDom("body").appendChild(r.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(r.getClientRect(this.getDom()).width-2)+'px"></div>')),t.getDom().className+=" "+this.className},this)),this.popup=t},_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon"></div></div><div class="edui-box edui-splitborder"></div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div></div></div></div>'},showPopup:function(){var n=r.getClientRect(this.getDom());n.top-=this.popup.SHADOW_RADIUS,n.height+=this.popup.SHADOW_RADIUS,this.popup.showAnchorRect(n)},_onArrowClick:function(){this.isDisabled()||this.showPopup()},_onButtonClick:function(){this.isDisabled()||this.fireEvent("buttonclick")}},n.inherits(i,u),n.extend(i.prototype,f,!0)})(),(function(){var r=t.editor.utils,f=t.editor.ui.uiUtils,e=t.editor.ui.ColorPicker,u=t.editor.ui.Popup,n=t.editor.ui.SplitButton,i=t.editor.ui.ColorButton=function(n){this.initOptions(n),this.initColorButton()};i.prototype={initColorButton:function(){var n=this;this.popup=new u({content:new e({noColorText:"\u6e05\u9664\u989c\u8272",onpickcolor:function(t,i){n._onPickColor(i)},onpicknocolor:function(t,i){n._onPickNoColor(i)}}),editor:n.editor}),this.initSplitButton()},_SplitButton_postRender:n.prototype.postRender,postRender:function(){this._SplitButton_postRender(),this.getDom("button_body").appendChild(f.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"></div>')),this.getDom().className+=" edui-colorbutton"},setColor:function(n){this.getDom("colorlump").style.backgroundColor=n,this.color=n},_onPickColor:function(n){this.fireEvent("pickcolor",n)!==!1&&(this.setColor(n),this.popup.hide())},_onPickNoColor:function(){this.fireEvent("picknocolor")!==!1&&this.popup.hide()}},r.inherits(i,n)})(),(function(){var r=t.editor.utils,u=t.editor.ui.Popup,f=t.editor.ui.TablePicker,i=t.editor.ui.SplitButton,n=t.editor.ui.TableButton=function(n){this.initOptions(n),this.initTableButton()};n.prototype={initTableButton:function(){var n=this;this.popup=new u({content:new f({onpicktable:function(t,i,r){n._onPickTable(i,r)},onmore:function(){n.popup.hide(),n.fireEvent("more")}}),editor:n.editor}),this.initSplitButton()},_onPickTable:function(n,t){this.fireEvent("picktable",n,t)!==!1&&this.popup.hide()}},r.inherits(n,i)})(),(function(){var r=t.editor.utils,i=t.editor.ui.UIBase,n=t.editor.ui.AutoTypeSetPicker=function(n){this.initOptions(n),this.initAutoTypeSetPicker()};n.prototype={initAutoTypeSetPicker:function(){this.initUIBase()},getHtmlTpl:function(){for(var i=this.editor.options,n=i.autotypeset,u=0,f=[],t,r=i.listMap.lineheight;t=r[u++];)f.push('<option value="'+t+'" '+(n.lineHeight==t?"checked":"")+">"+t+"</option>");return'<div id="##" class="edui-autotypesetpicker %%"><div class="edui-autotypesetpicker-body"><table ><tr><td colspan="2"><input type="checkbox" name="mergeEmptyline" '+(n.mergeEmptyline?"checked":"")+'>\u5408\u5e76\u7a7a\u884c</td><td colspan="2"><input type="checkbox" name="removeEmptyline" '+(n.removeEmptyline?"checked":"")+'>\u5220\u9664\u7a7a\u884c</td></tr><tr><td colspan="2"><input type="checkbox" name="removeClass" '+(n.removeClass?"checked":"")+'>\u6e05\u9664\u6837\u5f0f</td><td colspan="2"><input type="checkbox" name="indent" '+(n.indent?"checked":"")+'>\u9996\u884c\u7f29\u8fdb2\u5b57</td></tr><tr><td colspan="2"><input type="checkbox" name="textAlign" '+(n.textAlign?"checked":"")+'>\u5bf9\u9f50\u65b9\u5f0f\uff1a</td><td colspan="2" id="textAlignValue"><input type="radio" name="textAlignValue" value="left" '+(n.textAlign&&n.textAlign=="left"?"checked":"")+'>\u5de6\u5bf9\u9f50<input type="radio" name="textAlignValue" value="center" '+(n.textAlign&&n.textAlign=="center"?"checked":"")+'>\u5c45\u4e2d\u5bf9\u9f50<input type="radio" name="textAlignValue" value="right" '+(n.textAlign&&n.textAlign=="right"?"checked":"")+'>\u53f3\u5bf9\u9f50 </tr><tr><td colspan="2"><input type="checkbox" name="imageBlockLine" '+(n.imageBlockLine?"checked":"")+'>\u56fe\u7247\u6d6e\u52a8</td><td colspan="2" id="imageBlockLineValue"><input type="radio" name="imageBlockLineValue" value="none" '+(n.imageBlockLine&&n.imageBlockLine=="none"?"checked":"")+'>\u9ed8\u8ba4<input type="radio" name="imageBlockLineValue" value="left" '+(n.imageBlockLine&&n.imageBlockLine=="left"?"checked":"")+'>\u5de6\u6d6e\u52a8<input type="radio" name="imageBlockLineValue" value="center" '+(n.imageBlockLine&&n.imageBlockLine=="center"?"checked":"")+'>\u72ec\u5360\u884c\u5c45\u4e2d<input type="radio" name="imageBlockLineValue" value="right" '+(n.imageBlockLine&&n.imageBlockLine=="right"?"checked":"")+'>\u53f3\u6d6e\u52a8</tr><tr><td colspan="2"><input type="checkbox" name="clearFontSize" '+(n.clearFontSize?"checked":"")+'>\u6e05\u9664\u5b57\u53f7</td><td colspan="2"><input type="checkbox" name="clearFontFamily" '+(n.clearFontFamily?"checked":"")+'>\u6e05\u9664\u5b57\u4f53</td></tr><tr><td colspan="4"><input type="checkbox" name="removeEmptyNode" '+(n.removeEmptyNode?"checked":"")+'>\u53bb\u6389\u5197\u4f59\u7684html\u4ee3\u7801</td></tr><tr><td colspan="4"><input type="checkbox" name="pasteFilter" '+(n.pasteFilter?"checked":"")+'>\u7c98\u8d34\u8fc7\u6ee4 (\u5bf9\u6bcf\u6b21\u7c98\u8d34\u7684\u5185\u5bb9\u5e94\u7528\u4ee5\u4e0a\u8fc7\u6ee4\u89c4\u5219)</td></tr><tr><td colspan="4" align="right"><button >\u6267\u884c</button></td></tr></table></div></div>'},_UIBase_render:i.prototype.render},r.inherits(n,i)})(),(function(){function r(t){for(var i=t.editor.options.autotypeset,y=t.getDom(),l=n.getElementsByTagName(y,"input"),f,r,u,c,v,s,a,o,h,e=l.length-1;f=l[e--];)if(f.getAttribute("type")=="checkbox"){r=f.getAttribute("name"),i[r]&&delete i[r];if(f.checked){u=document.getElementById(r+"Value");if(u){if(/input/ig.test(u.tagName))i[r]=u.value;else for(c=u.getElementsByTagName("input"),v=c.length-1;s=c[v--];)if(s.checked){i[r]=s.value;break}}else i[r]=!0}}for(a=n.getElementsByTagName(y,"select"),e=0;o=a[e++];)h=o.getAttribute("name"),i[h]=i[h]?o.value:"";t.editor.options.autotypeset=i}var u=t.editor.utils,e=t.editor.ui.Popup,o=t.editor.ui.AutoTypeSetPicker,f=t.editor.ui.SplitButton,i=t.editor.ui.AutoTypeSetButton=function(n){this.initOptions(n),this.initAutoTypeSetButton()};i.prototype={initAutoTypeSetButton:function(){var t=this,n;this.popup=new e({content:new o({editor:t.editor}),editor:t.editor,hide:function(){!this._hidden&&this.getDom()&&(r(this),this.getDom().style.display="none",this._hidden=!0,this.fireEvent("hide"))}}),n=0,this.popup.addListener("postRenderAfter",function(){var f=this,u,i;if(n)return;u=this.getDom(),i=u.getElementsByTagName("button")[0],i.onclick=function(){r(f),t.editor.execCommand("autotypeset")},n=1}),this.initSplitButton()}},u.inherits(i,f)})(),(function(){var i=t.editor.utils,u=t.editor.ui.uiUtils,r=t.editor.ui.UIBase,n=t.editor.ui.Toolbar=function(n){this.initOptions(n),this.initToolbar()};n.prototype={items:null,initToolbar:function(){this.items=this.items||[],this.initUIBase()},add:function(n){this.items.push(n)},getHtmlTpl:function(){for(var t=[],n=0;n<this.items.length;n++)t[n]=this.items[n].renderHtml();return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+t.join("")+"</div>"},postRender:function(){for(var t=this.getDom(),n=0;n<this.items.length;n++)this.items[n].postRender();u.makeUnselectable(t)},_onMouseDown:function(){return!1}},i.inherits(n,r)})(),(function(){var f=t.editor.utils,e=t.editor.dom.domUtils,i=t.editor.ui.uiUtils,o=t.editor.ui.UIBase,r=t.editor.ui.Popup,h=t.editor.ui.Stateful,u=t.editor.ui.Menu=function(n){this.initOptions(n),this.initMenu()},s={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},postRender:function(){},queryAutoHide:function(){return!0}},n;u.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[],this.initPopup(),this.initItems()},initItems:function(){for(var i,t=0;t<this.items.length;t++)i=this.items[t],i=="-"?this.items[t]=this.getSeparator():i instanceof n||(this.items[t]=this.createItem(i))},getSeparator:function(){return s},createItem:function(t){return new n(t)},_Popup_getContentHtmlTpl:r.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){var t,n,i;if(this.items.length==0)return this._Popup_getContentHtmlTpl();for(t=[],n=0;n<this.items.length;n++)i=this.items[n],t[n]=i.renderHtml();return'<div class="%%-body">'+t.join("")+"</div>"},_Popup_postRender:r.prototype.postRender,postRender:function(){for(var r=this,t,n=0;n<this.items.length;n++)t=this.items[n],t.ownerMenu=this,t.postRender();e.on(this.getDom(),"mouseover",function(n){n=n||event;var u=n.relatedTarget||n.fromElement,t=r.getDom();!i.contains(t,u)&&t!==u&&r.fireEvent("over")});this._Popup_postRender()},queryAutoHide:function(n){var t,r;if(n){if(i.contains(this.getDom(),n))return!1;for(t=0;t<this.items.length;t++){r=this.items[t];if(r.queryAutoHide(n)===!1)return!1}}},clearItems:function(){for(var n,t=0;t<this.items.length;t++)n=this.items[t],clearTimeout(n._showingTimer),clearTimeout(n._closingTimer),n.subMenu&&n.subMenu.destroy();this.items=[]},destroy:function(){this.getDom()&&e.remove(this.getDom()),this.clearItems()},dispose:function(){this.destroy()}},f.inherits(u,r),n=t.editor.ui.MenuItem=function(n){this.initOptions(n),this.initUIBase(),this.Stateful_init(),this.subMenu&&!(this.subMenu instanceof u)&&(this.subMenu=new u(this.subMenu))},n.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:!0,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div></div>"},postRender:function(){var n=this;this.addListener("over",function(){n.ownerMenu.fireEvent("submenuover",n),n.subMenu&&n.delayShowSubMenu()}),this.subMenu&&(this.getDom().className+=" edui-hassubmenu",this.subMenu.render(),this.addListener("out",function(){n.delayHideSubMenu()}),this.subMenu.addListener("over",function(){clearTimeout(n._closingTimer),n._closingTimer=null,n.addState("opened")}),this.ownerMenu.addListener("hide",function(){n.hideSubMenu()}),this.ownerMenu.addListener("submenuover",function(t,i){i!==n&&n.delayHideSubMenu()}),this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide,this.subMenu.queryAutoHide=function(t){return t&&i.contains(n.getDom(),t)?!1:this._bakQueryAutoHide(t)}),this.getDom().style.tabIndex="-1",i.makeUnselectable(this.getDom()),this.Stateful_postRender()},delayShowSubMenu:function(){var n=this;n.isDisabled()||(n.addState("opened"),clearTimeout(n._showingTimer),clearTimeout(n._closingTimer),n._closingTimer=null,n._showingTimer=setTimeout(function(){n.showSubMenu()},250))},delayHideSubMenu:function(){var n=this;n.isDisabled()||(n.removeState("opened"),clearTimeout(n._showingTimer),n._closingTimer||(n._closingTimer=setTimeout(function(){n.hasState("opened")||n.hideSubMenu(),n._closingTimer=null},400)))},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(n){if(this.subMenu&&this.hasState("opened"))return this.subMenu.queryAutoHide(n)},_onClick:function(n,t){if(this.hasState("disabled"))return;this.fireEvent("click",n,t)!==!1&&(this.subMenu?this.showSubMenu():r.postHide())},showSubMenu:function(){var n=i.getClientRect(this.getDom());n.right-=5,n.left+=2,n.width-=7,n.top-=4,n.bottom+=4,n.height+=8,this.subMenu.showAnchorRect(n,!0,!0)},hideSubMenu:function(){this.subMenu.hide()}},f.inherits(n,o),f.extend(n.prototype,h,!0)})(),(function(){var r=t.editor.utils,u=t.editor.ui.uiUtils,f=t.editor.ui.Menu,n=t.editor.ui.SplitButton,i=t.editor.ui.Combox=function(n){this.initOptions(n),this.initCombox()};i.prototype={uiName:"combox",initCombox:function(){var i=this,n,t;for(this.items=this.items||[],n=0;n<this.items.length;n++)t=this.items[n],t.uiName="listitem",t.index=n,t.onclick=function(){i.selectByIndex(this.index)};this.popup=new f({items:this.items,uiName:"list",editor:this.editor}),this.initSplitButton()},_SplitButton_postRender:n.prototype.postRender,postRender:function(){this._SplitButton_postRender(),this.setLabel(this.label||""),this.setValue(this.initValue||"")},showPopup:function(){var n=u.getClientRect(this.getDom());n.top+=1,n.bottom-=1,n.height-=2,this.popup.showAnchorRect(n)},getValue:function(){return this.value},setValue:function(n){var t=this.indexByValue(n);t!=-1?(this.selectedIndex=t,this.setLabel(this.items[t].label),this.value=this.items[t].value):(this.selectedIndex=-1,this.setLabel(this.getLabelForUnknowValue(n)),this.value=n)},setLabel:function(n){this.getDom("button_body").innerHTML=n,this.label=n},getLabelForUnknowValue:function(n){return n},indexByValue:function(n){for(var t=0;t<this.items.length;t++)if(n==this.items[t].value)return t;return-1},getItem:function(n){return this.items[n]},selectByIndex:function(n){n<this.items.length&&this.fireEvent("select",n)!==!1&&(this.selectedIndex=n,this.value=this.items[n].value,this.setLabel(this.items[n].label))}},r.inherits(i,n)})(),(function(){var s=t.editor.utils,r=t.editor.dom.domUtils,n=t.editor.ui.uiUtils,o=t.editor.ui.Mask,h=t.editor.ui.UIBase,i=t.editor.ui.Button,f=t.editor.ui.Dialog=function(n){this.initOptions(n),this.initDialog()},u,e;f.prototype={draggable:!1,uiName:"dialog",initDialog:function(){var t=this,n;this.initUIBase(),this.modalMask=u||(u=new o({className:"edui-dialog-modalmask"})),this.dragMask=e||(e=new o({className:"edui-dialog-dragmask"})),this.closeButton=new i({className:"edui-dialog-closebutton",title:"\u5173\u95ed\u5bf9\u8bdd\u6846",onclick:function(){t.close(!1)}});if(this.buttons)for(n=0;n<this.buttons.length;n++)this.buttons[n]instanceof i||(this.buttons[n]=new i(this.buttons[n]))},fitSize:function(){var t=this.getDom("body"),n=this.mesureSize();return t.style.width=n.width+"px",t.style.height=n.height+"px",n},safeSetOffset:function(t){var o=this,e=o.getDom(),u=n.getViewportRect(),i=n.getClientRect(e),f=t.left,r;f+i.width>u.right&&(f=u.right-i.width),r=t.top,r+i.height>u.bottom&&(r=u.bottom-i.height),e.style.left=Math.max(f,0)+"px",e.style.top=Math.max(r,0)+"px"},showAtCenter:function(){this.getDom().style.display="";var u=n.getViewportRect(),f=this.fitSize(),t=this.getDom("titlebar").offsetHeight|0,e=u.width/2-f.width/2,o=u.height/2-(f.height-t)/2-t,i=this.getDom();this.safeSetOffset({left:Math.max(e|0,0),top:Math.max(o|0,0)}),r.hasClass(i,"edui-state-centered")||(i.className+=" edui-state-centered"),this._show()},getContentHtml:function(){var n="";return typeof this.content=="string"?n=this.content:this.iframeUrl&&(n='<iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>'),n},getHtmlTpl:function(){var i="",t,n;if(this.buttons){for(t=[],n=0;n<this.buttons.length;n++)t[n]=this.buttons[n].renderHtml();i='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+t.join("")+"</div></div>"}return'<div id="##" class="%%"><div class="%%-wrap"><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"</span></div>"+this.closeButton.renderHtml()+'</div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+i+"</div></div></div>"},postRender:function(){var t,i;this.modalMask.getDom()||(this.modalMask.render(),this.modalMask.hide()),this.dragMask.getDom()||(this.dragMask.render(),this.dragMask.hide()),t=this,this.addListener("show",function(){t.modalMask.show(this.getDom().style.zIndex-2)}),this.addListener("hide",function(){t.modalMask.hide()});if(this.buttons)for(i=0;i<this.buttons.length;i++)this.buttons[i].postRender();r.on(window,"resize",function(){setTimeout(function(){t.isHidden()||t.safeSetOffset(n.getClientRect(t.getDom()))})});this._hide()},mesureSize:function(){var t=this.getDom("body"),r=n.getClientRect(this.getDom("content")).width,i=t.style;return i.width=r,n.getClientRect(t)},_onTitlebarMouseDown:function(t){if(this.draggable){var f,e=n.getViewportRect(),u=this;n.startDrag(t,{ondragstart:function(){f=n.getClientRect(u.getDom()),u.dragMask.show(u.getDom().style.zIndex-1)},ondragmove:function(n,t){var r=f.left+n,i=f.top+t;u.safeSetOffset({left:r,top:i})},ondragstop:function(){r.removeClasses(u.getDom(),["edui-state-centered"]),u.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml()},_show:function(){this._hidden&&(this.getDom().style.display="",this.editor.container.style.zIndex&&(this.getDom().style.zIndex=this.editor.container.style.zIndex*1+10),this._hidden=!1,this.fireEvent("show"),t.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4)},isHidden:function(){return this._hidden},_hide:function(){this._hidden||(this.getDom().style.display="none",this.getDom().style.zIndex="",this._hidden=!0,this.fireEvent("hide"))},open:function(){this.autoReset&&this.reset(),this.showAtCenter();if(this.iframeUrl)try{this.getDom("iframe").focus()}catch(n){}},_onCloseButtonClick:function(){this.close(!1)},close:function(n){this.fireEvent("close",n)!==!1&&this._hide()}},s.inherits(f,h)})(),(function(){var i=t.editor.utils,u=t.editor.ui.Menu,r=t.editor.ui.SplitButton,n=t.editor.ui.MenuButton=function(n){this.initOptions(n),this.initMenuButton()};n.prototype={initMenuButton:function(){var n=this;this.uiName="menubutton",this.popup=new u({items:n.items,className:n.className,editor:n.editor}),this.popup.addListener("show",function(){for(var i=this,t=0;t<i.items.length;t++)i.items[t].removeState("checked"),i.items[t].value==n._value&&(i.items[t].addState("checked"),this.value=n._value)}),this.initSplitButton()},setValue:function(n){this._value=n}},i.inherits(n,r)})(),(function(){var s=t.editor.browser.ie,h=t.editor.utils,n=t.editor.ui,c=n.Dialog,r,i,f,e,u,o;n.Dialog=function(n){var t=new c(n);return t.addListener("hide",function(){if(t.editor){var n=t.editor;try{n.focus()}catch(i){}}}),t},f=["Openfile","Savefile","Savetofile","Openimg","Attachment","Openvideo","Undo","Redo","FormatMatch","Bold","Italic","Underline","StrikeThrough","Subscript","Superscript","Source","Indent","Outdent","BlockQuote","PastePlain","PageBreak","SelectAll","Print","Preview","Horizontal","RemoveFormat","Time","Date","Unlink","InsertParagraphBeforeTable","InsertRow","InsertCol","MergeRight","MergeDown","DeleteRow","DeleteCol","SplittoRows","SplittoCols","SplittoCells","MergeCells","DeleteTable"],r=f.length;while(r--)i=f[r],n[i]=function(t){return function(i,r){r=r||i.options.labelMap[t.toLowerCase()]||"";var u=new n.Button({className:"edui-for-"+t.toLowerCase(),title:r,onclick:function(){i.execCommand(t)},showText:!1});return i.addListener("selectionchange",function(n,r,f){var e=i.queryCommandState(t.toLowerCase());e==-1?(u.setDisabled(!0),u.setChecked(!1)):f||(u.setDisabled(!1),u.setChecked(e))}),u}}(i);n.SnapScreen=function(t,i){var f="SnapScreen",e,u,r;return i=i||t.options.labelMap[f.toLowerCase()]||"",e=new n.Button({className:"edui-for-"+f.toLowerCase(),title:i,onclick:function(){t.execCommand(f)}}),s&&(u=t.options.iframeUrlMap.snapscreen,u=t.ui.mapUrl(u),i=i||t.options.labelMap.snapscreen||"",r=new n.Dialog({iframeUrl:u,autoReset:!0,draggable:!0,editor:t,className:"edui-for-snapscreen",title:i,buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){r.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){r.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(n,t){return t?this.onok():this.oncancel()}}),r.render(),t.snapscreenInstall=r),t.addListener("selectionchange",function(){var n=t.queryCommandState("snapscreen");e.setDisabled(n==-1)}),e},n.ClearDoc=function(t,i){var u="ClearDoc",r;return i=i||t.options.labelMap[u.toLowerCase()]||"",r=new n.Button({className:"edui-for-"+u.toLowerCase(),title:i,onclick:function(){confirm("\u786e\u5b9a\u6e05\u7a7a\u6587\u6863\u5417\uff1f")&&t.execCommand("cleardoc")}}),t.addListener("selectionchange",function(){var n=t.queryCommandState("cleardoc");r.setDisabled(n==-1)}),r},n.Justify=function(t,i,r){i=(i||"left").toLowerCase(),r=r||t.options.labelMap["justify"+i.toLowerCase()]||"";var u=new n.Button({className:"edui-for-justify"+i.toLowerCase(),title:r,onclick:function(){t.execCommand("Justify",i)}});return t.addListener("selectionchange",function(n,r,f){var o=t.queryCommandState("Justify"),e;u.setDisabled(o==-1),e=t.queryCommandValue("Justify"),u.setChecked(e==i&&!f)}),u},n.JustifyLeft=function(t,i){return n.Justify(t,"left",i)},n.JustifyCenter=function(t,i){return n.Justify(t,"center",i)},n.JustifyRight=function(t,i){return n.Justify(t,"right",i)},n.JustifyJustify=function(t,i){return n.Justify(t,"justify",i)},n.ImageFloat=function(t,i,r){i=(i||"none").toLowerCase(),r=r||t.options.labelMap["image"+i.toLowerCase()]||"";var u=new n.Button({className:"edui-for-image"+i.toLowerCase(),title:r,onclick:function(){t.execCommand("imagefloat",i)}});return t.addListener("selectionchange",function(){var r=t.queryCommandState("imagefloat");u.setDisabled(r==-1),r=t.queryCommandValue("imagefloat"),u.setChecked(r==i)}),u},n.ImageNone=function(t,i){return n.ImageFloat(t,i)},n.ImageLeft=function(t,i){return n.ImageFloat(t,"left",i)},n.ImageRight=function(t,i){return n.ImageFloat(t,"right",i)},n.ImageCenter=function(t,i){return n.ImageFloat(t,"center",i)},n.Directionality=function(t,i,r){i=(i||"left").toLowerCase(),r=r||t.options.labelMap["directionality"+i.toLowerCase()]||"";var u=new n.Button({className:"edui-for-directionality"+i.toLowerCase(),title:r,onclick:function(){t.execCommand("directionality",i)},type:i});return t.addListener("selectionchange",function(n,i,r){var e=t.queryCommandState("directionality"),f;u.setDisabled(e==-1),f=t.queryCommandValue("directionality"),u.setChecked(f==u.type&&!r)}),u},n.DirectionalityLtr=function(t,i){return new n.Directionality(t,"ltr",i)},n.DirectionalityRtl=function(t,i){return new n.Directionality(t,"rtl",i)},e=["BackColor","ForeColor"],r=e.length;while(r--)i=e[r],n[i]=function(t){return function(i,r){r=r||i.options.labelMap[t.toLowerCase()]||"";var u=new n.ColorButton({className:"edui-for-"+t.toLowerCase(),color:"default",title:r,editor:i,onpickcolor:function(n,r){i.execCommand(t,r)},onpicknocolor:function(){i.execCommand(t,"default"),this.setColor("transparent"),this.color="default"},onbuttonclick:function(){i.execCommand(t,this.color)}});return i.addListener("selectionchange",function(){var n=i.queryCommandState(t);n==-1?u.setDisabled(!0):u.setDisabled(!1)}),u}}(i);u=["SearchReplace","Help","Spechars"],r=u.length;while(r--)i=u[r],n[i]=function(t){return t=t.toLowerCase(),function(i,r,u){var e,f;return r=r||i.options.iframeUrlMap[t.toLowerCase()]||"about:blank",r=i.ui.mapUrl(r),u=u||i.options.labelMap[t.toLowerCase()]||"",e=new n.Dialog({iframeUrl:r,autoReset:!0,draggable:!0,editor:i,className:"edui-for-"+t,title:u,onok:function(){},oncancel:function(){},onclose:function(n,t){return t?this.onok():this.oncancel()}}),e.render(),f=new n.Button({className:"edui-for-"+t,title:u,onclick:function(){e.open()}}),i.addListener("selectionchange",function(){var n=i.queryCommandState(t);n==-1?f.setDisabled(!0):f.setDisabled(!1)}),f}}(i);o=["Anchor","Link","InsertImage","Map","GMap","InsertVideo","TableSuper","HighlightCode","InsertFrame","EditTd"],r=o.length;while(r--)i=o[r],n[i]=function(t){return t=t.toLowerCase(),function(i,r,u){var e,f;return r=r||i.options.iframeUrlMap[t.toLowerCase()]||"about:blank",r=i.ui.mapUrl(r),u=u||i.options.labelMap[t.toLowerCase()]||"",e=new n.Dialog({iframeUrl:r,autoReset:!0,draggable:!0,editor:i,className:"edui-for-"+t,title:u,buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){e.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){e.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(n,t){return t?this.onok():this.oncancel()}}),e.render(),f=new n.Button({className:"edui-for-"+t,title:u,onclick:function(){e.open()}}),i.addListener("selectionchange",function(){var n=i.queryCommandState(t);n==-1?f.setDisabled(!0):(f.setChecked(n),f.setDisabled(!1))}),f}}(i);n.WordImage=function(t){var i=new n.Button({className:"edui-for-wordimage",title:"\u56fe\u7247\u8f6c\u5b58",onclick:function(){t.execCommand("wordimage","word_img"),t.ui._dialogs.wordImageDialog.open()}});return t.addListener("selectionchange",function(){var n=t.queryCommandState("wordimage","word_img");n==-1?i.setDisabled(!0):(i.setDisabled(!1),i.setChecked(n))}),i},n.FontFamily=function(t,i,r){var o,e,u;for(i=i||t.options.listMap.fontfamily||[],r=r||t.options.labelMap.fontfamily||"",o=[],e=0;e<i.length;e++){var f=i[e],s=t.options.fontMap[f],c='"'+f+'"',l=new RegExp(f,"i");s&&(c='"'+s.join('","')+'"',l=new RegExp("(?:\\|)"+s.join("|")+"(?:\\|)","i")),o.push({label:f,value:c,regex:l,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+h.unhtml(this.value)+'">'+(this.label||"")+"</div>"}})}return u=new n.Combox({editor:t,items:o,onselect:function(n,i){t.execCommand("FontFamily",this.items[i].value)},onbuttonclick:function(){this.showPopup()},title:r,initValue:t.options.ComboxInitial.FONT_FAMILY,className:"edui-for-fontfamily",indexByValue:function(n){var t,i;if(n)for(n="|"+n.replace(/,/g,"|").replace(/"/g,"")+"|",n.replace(/\s*|\s*/g,"|"),t=0;t<this.items.length;t++){i=this.items[t];if(i.regex.test(n))return t}return-1}}),t.addListener("selectionchange",function(n,i,r){var e,f;r||(e=t.queryCommandState("FontFamily"),e==-1?u.setDisabled(!0):(u.setDisabled(!1),f=t.queryCommandValue("FontFamily"),f&&(f=f.replace(/['"]/g,"").split(",")[0]),u.setValue(f)))}),u},n.FontSize=function(t,i,r){var e,f,o,u;for(i=i||t.options.listMap.fontsize||[],r=r||t.options.labelMap.fontsize||"",e=[],f=0;f<i.length;f++)o=i[f]+"px",e.push({label:o,value:o,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-size:'+this.value+'">'+(this.label||"")+"</div>"}});return u=new n.Combox({editor:t,items:e,title:r,initValue:t.options.ComboxInitial.FONT_SIZE,onselect:function(n,i){t.execCommand("FontSize",this.items[i].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"}),t.addListener("selectionchange",function(n,i,r){if(!r){var f=t.queryCommandState("FontSize");f==-1?u.setDisabled(!0):(u.setDisabled(!1),u.setValue(t.queryCommandValue("FontSize")))}}),u},n.Paragraph=function(t,i,r){var e,f,u;for(i=i||t.options.listMap.paragraph||[],r=r||t.options.labelMap.paragraph||"",e=[],f=0;f<i.length;f++){var o=i[f].split(":"),s=o[0],h=o[1];e.push({label:h,value:s,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}})}return u=new n.Combox({editor:t,items:e,title:r,initValue:t.options.ComboxInitial.PARAGRAPH,className:"edui-for-paragraph",onselect:function(n,i){t.execCommand("Paragraph",this.items[i].value)},onbuttonclick:function(){this.showPopup()}}),t.addListener("selectionchange",function(n,i,r){var o,f,e;r||(o=t.queryCommandState("Paragraph"),o==-1?u.setDisabled(!0):(u.setDisabled(!1),f=t.queryCommandValue("Paragraph"),e=u.indexByValue(f),e!=-1?u.setValue(f):u.setValue(u.initValue)))}),u},n.CustomStyle=function(t,i,r){var e,f,o,u;for(i=i||t.options.listMap.customstyle||[],r=r||t.options.labelMap.customstyle||"",e=0,f=[];o=i[e++];)(function(n){f.push({label:n.label,value:n,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+n.tag+" "+(n.className?' class="'+n.className+'"':"")+(n.style?' style="'+n.style+'"':"")+">"+n.label+"</"+n.tag+"></div>"}})})(o);return u=new n.Combox({editor:t,items:f,title:r,initValue:t.options.ComboxInitial.CUSTOMSTYLE,className:"edui-for-customstyle",onselect:function(n,i){t.execCommand("customstyle",this.items[i].value)},onbuttonclick:function(){this.showPopup()},indexByValue:function(n){for(var i=0,t;t=this.items[i++];)if(t.label==n)return i-1;return-1}}),t.addListener("selectionchange",function(n,i,r){var o,f,e;r||(o=t.queryCommandState("customstyle"),o==-1?u.setDisabled(!0):(u.setDisabled(!1),f=t.queryCommandValue("customstyle"),e=u.indexByValue(f),e!=-1?u.setValue(f):u.setValue(u.initValue)))}),u},n.InsertTable=function(t,i,r){var u,f;return i=i||t.options.iframeUrlMap.inserttable||"about:blank",i=t.ui.mapUrl(i),r=r||t.options.labelMap.inserttable||"",u=new n.Dialog({iframeUrl:i,autoReset:!0,draggable:!0,editor:t,className:"edui-for-inserttable",title:r,buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){u.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){u.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(n,t){return t?this.onok():this.oncancel()}}),u.render(),t.tableDialog=u,f=new n.TableButton({editor:t,title:r,className:"edui-for-inserttable",onpicktable:function(n,i,r){t.execCommand("InsertTable",{numRows:r,numCols:i})},onmore:function(){u.open()},onbuttonclick:function(){u.open()}}),t.addListener("selectionchange",function(){var n=t.queryCommandState("inserttable");n==-1?f.setDisabled(!0):f.setDisabled(!1)}),f},n.AutoTypeSet=function(t,i,r){r=r||t.options.labelMap.autotypeset||"";var u=new n.AutoTypeSetButton({editor:t,title:r,className:"edui-for-autotypeset",onbuttonclick:function(){t.execCommand("autotypeset")}});return t.addListener("selectionchange",function(){u.setDisabled(t.queryCommandState("autotypeset")==-1)}),u},n.LineHeight=function(t,i){for(var u,r,e=0,f=[];u=t.options.listMap.lineheight[e++];)f.push({label:u=="1"?"\u9ed8\u8ba4":u,value:u,onclick:function(){t.execCommand("lineheight",this.value)}});return r=new n.MenuButton({editor:t,className:"edui-for-lineheight",title:i||t.options.labelMap.lineheight||"",items:f,onbuttonclick:function(){var n=t.queryCommandValue("LineHeight")||this.value;t.execCommand("LineHeight",n)}}),t.addListener("selectionchange",function(){var i=t.queryCommandState("LineHeight"),n;i==-1?r.setDisabled(!0):(r.setDisabled(!1),n=t.queryCommandValue("LineHeight"),n&&r.setValue((n+"").replace(/cm/,"")),r.setChecked(i))}),r},n.RowSpacingTop=function(t,i){for(var f,r,e=0,u=[];f=t.options.listMap.rowspacing[e++];)u.push({label:f,value:f,onclick:function(){t.execCommand("rowspacing",this.value,"top")}});return r=new n.MenuButton({editor:t,className:"edui-for-rowspacingtop",title:i||t.options.labelMap.rowspacingtop||"\u6bb5\u524d\u95f4\u8ddd",items:u,onbuttonclick:function(){var n=t.queryCommandValue("rowspacing","top")||this.value;t.execCommand("rowspacing",n,"top")}}),t.addListener("selectionchange",function(){var i=t.queryCommandState("rowspacing","top"),n;i==-1?r.setDisabled(!0):(r.setDisabled(!1),n=t.queryCommandValue("rowspacing","top"),n&&r.setValue((n+"").replace(/%/,"")),r.setChecked(i))}),r},n.RowSpacingBottom=function(t,i){for(var f,r,e=0,u=[];f=t.options.listMap.rowspacing[e++];)u.push({label:f,value:f,onclick:function(){t.execCommand("rowspacing",this.value,"bottom")}});return r=new n.MenuButton({editor:t,className:"edui-for-rowspacingbottom",title:i||t.options.labelMap.rowspacingbottom||"\u6bb5\u540e\u95f4\u8ddd",items:u,onbuttonclick:function(){var n=t.queryCommandValue("rowspacing","bottom")||this.value;t.execCommand("rowspacing",n,"bottom")}}),t.addListener("selectionchange",function(){var i=t.queryCommandState("rowspacing","bottom"),n;i==-1?r.setDisabled(!0):(r.setDisabled(!1),n=t.queryCommandValue("rowspacing","bottom"),n&&r.setValue((n+"").replace(/%/,"")),r.setChecked(i))}),r},n.InsertOrderedList=function(t,i){i=i||t.options.labelMap.insertorderedlist||"";var u=function(){t.execCommand("InsertOrderedList",this.value)},r=new n.MenuButton({editor:t,className:"edui-for-insertorderedlist",title:i,items:[{label:"1,2,3...",value:"decimal",onclick:u},{label:"a,b,c ...",value:"lower-alpha",onclick:u},{label:"i,ii,iii...",value:"lower-roman",onclick:u},{label:"A,B,C",value:"upper-alpha",onclick:u},{label:"I,II,III...",value:"upper-roman",onclick:u}],onbuttonclick:function(){var n=t.queryCommandValue("InsertOrderedList")||this.value;t.execCommand("InsertOrderedList",n)}});return t.addListener("selectionchange",function(){var i=t.queryCommandState("InsertOrderedList"),n;i==-1?r.setDisabled(!0):(r.setDisabled(!1),n=t.queryCommandValue("InsertOrderedList"),r.setValue(n),r.setChecked(i))}),r},n.InsertUnorderedList=function(t,i){i=i||t.options.labelMap.insertunorderedlist||"";var u=function(){t.execCommand("InsertUnorderedList",this.value)},r=new n.MenuButton({editor:t,className:"edui-for-insertunorderedlist",title:i,items:[{label:"\u25cb \u5c0f\u5706\u5708",value:"circle",onclick:u},{label:"\u25cf \u5c0f\u5706\u70b9",value:"disc",onclick:u},{label:"\u25a0 \u5c0f\u65b9\u5757",value:"square",onclick:u}],onbuttonclick:function(){var n=t.queryCommandValue("InsertUnorderedList")||this.value;t.execCommand("InsertUnorderedList",n)}});return t.addListener("selectionchange",function(){var i=t.queryCommandState("InsertUnorderedList"),n;i==-1?r.setDisabled(!0):(r.setDisabled(!1),n=t.queryCommandValue("InsertUnorderedList"),r.setValue(n),r.setChecked(i))}),r},n.FullScreen=function(t,i){i=i||t.options.labelMap.fullscreen||"";var r=new n.Button({className:"edui-for-fullscreen",title:i,onclick:function(){t.ui&&t.ui.setFullScreen(!t.ui.isFullScreen()),this.setChecked(t.ui.isFullScreen())}});return t.addListener("selectionchange",function(){var n=t.queryCommandState("fullscreen");r.setDisabled(n==-1),r.setChecked(t.ui.isFullScreen())}),r},n.Emotion=function(t,i,r){r=r||t.options.labelMap.emotion||"",i=i||t.options.iframeUrlMap.emotion||"about:blank",i=t.ui.mapUrl(i);var u=new n.MultiMenuPop({title:r,editor:t,className:"edui-for-emotion",iframeUrl:i});return t.addListener("selectionchange",function(){var n=t.queryCommandState("emotion");n==-1?u.setDisabled(!0):u.setDisabled(!1)}),u}})(),UE.commands.savefile={execCommand:function(){var n=this;n.fileicoid>0?(n.sync(),document.getElementById("create_save").value=0,document.getElementById("save_cmd").value="save",document.getElementById("fileicoid").value=n.fileicoid,document.getElementById("ueditor_form").submit()):top.OpenFile("save","",window.name,{cmd:"save"})},notNeedUndo:1},UE.commands.savetofile={execCommand:function(){var n=this;top.OpenFile("saveto","",wname,{cmd:"saveto",fileencode:n.filecode})},notNeedUndo:1},UE.commands.openfile={execCommand:function(){var n=this;n.needsave>1&&confirm("\u662f\u5426\u4fdd\u5b58\u6587\u6863\uff1f")&&n.execCommand("savefile"),top.OpenFile("open","",wname,{cmd:"open"})},notNeedUndo:0},UE.commands.openimg={execCommand:function(){var n=this;top.OpenFile("open","jpg,jpeg,png,gif",wname,{cmd:"insertimg"})},notNeedUndo:1},UE.commands.openvideo={execCommand:function(){var n=this;top.OpenFile("open","video",wname,{cmd:"insertvideo"})},notNeedUndo:1},(function(){function n(n){this.initOptions(n),this.initEditorUI()}var r=t.editor.utils,i=t.editor.ui.uiUtils,u=t.editor.ui.UIBase;n.prototype={uiName:"editor",initEditorUI:function(){var n,r,u,c,h,l,v,a,e,f,s,i,o;this.editor.ui=this,this._dialogs={},this.initUIBase(),this._initToolbars(),n=this.editor,r=n.options.iframeUrlMap,n.addListener("ready",function(){t.editor.dom.domUtils.on(n.window,"scroll",function(){t.editor.ui.Popup.postHide()});n.options.elementPathEnabled&&(n.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">path:</div>'),n.options.wordCount&&(n.ui.getDom("wordcount").innerHTML="\u5b57\u6570\u7edf\u8ba1");if(!n.selection.isFocus())return;n.fireEvent("selectionchange",!1,!0)}),n.addListener("mousedown",function(n,i){var r=i.target||i.srcElement;t.editor.ui.Popup.postHide(r)}),n.addListener("contextmenu",function(){t.editor.ui.Popup.postHide()}),u=this,n.addListener("selectionchange",function(){if(!n.selection.isFocus())return;u._updateElementPath(),u._wordCount()}),n.addListener("sourcemodechanged",function(t,i){n.options.elementPathEnabled&&(i?u.disableElementPath():u.enableElementPath()),n.options.wordCount&&(i?u.disableWordCount():u.enableWordCount())}),c=new t.editor.ui.Dialog({iframeUrl:r?n.ui.mapUrl(r.link):"",autoReset:!0,draggable:!0,editor:n,className:"edui-for-link",title:"\u8d85\u94fe\u63a5",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){c.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){c.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(n,t){return t?this.onok():this.oncancel()}}),c.render(),h=new t.editor.ui.Dialog({iframeUrl:r?n.ui.mapUrl(r.insertimage):"",autoReset:!0,draggable:!0,editor:n,className:"edui-for-insertimage",title:"\u56fe\u7247",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){h.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){h.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(n,t){return t?this.onok():this.oncancel()}}),h.render(),l=new t.editor.ui.Dialog({iframeUrl:r?n.ui.mapUrl(r.anchor):"",autoReset:!0,draggable:!0,editor:n,className:"edui-for-anchor",title:"\u951a\u70b9",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){l.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){l.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(n,t){return t?this.onok():this.oncancel()}}),l.render(),v=new t.editor.ui.Dialog({iframeUrl:r?n.ui.mapUrl(r.insertvideo):"",autoReset:!0,draggable:!0,editor:n,className:"edui-for-insertvideo",title:"\u89c6\u9891",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){v.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){v.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(n,t){return t?this.onok():this.oncancel()}}),v.render(),a=new t.editor.ui.Dialog({iframeUrl:r?n.ui.mapUrl(r.wordimage):"",autoReset:!0,draggable:!0,editor:n,className:"edui-for-wordimage",title:"\u56fe\u7247\u8f6c\u5b58",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){a.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){a.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(n,t){return t?this.onok():this.oncancel()}}),a.render(),u._dialogs.wordImageDialog=a,e=new t.editor.ui.Dialog({iframeUrl:r?u.mapUrl(r.edittd):"about:blank",autoReset:!0,draggable:!0,editor:n,className:"edui-for-edittd",title:"\u5355\u5143\u683c",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){e.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){e.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(n,t){return t?this.onok():this.oncancel()}}),e.render(),u._dialogs.tdDialog=e,f=new t.editor.ui.Dialog({iframeUrl:r?n.ui.mapUrl(r.map):"",autoReset:!0,draggable:!0,editor:n,className:"edui-for-map",title:"\u5730\u56fe",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){f.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){f.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(n,t){return t?this.onok():this.oncancel()}}),f.render(),s=new t.editor.ui.Dialog({iframeUrl:r?n.ui.mapUrl(r.gmap):"",autoReset:!0,draggable:!0,editor:n,className:"edui-for-gmap",title:"Google\u5730\u56fe",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){s.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){s.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(n,t){return t?this.onok():this.oncancel()}}),s.render(),i=new t.editor.ui.Popup({editor:n,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide(),c.open()},_onImgEditButtonClick:function(){this.hide();var r=n.selection.getRange().getClosedNode(),i=t.editor.dom.domUtils.findParentByTagName(r,"img",!0);i&&i.className.indexOf("edui-faked-video")!=-1?v.open():i&&i.src.indexOf("http://api.map.baidu.com")!=-1?f.open():i&&i.src.indexOf("http://maps.google.com/maps/api/staticmap")!=-1?s.open():i&&i.getAttribute("anchorname")?l.open():i&&i.getAttribute("word_img")?(n.word_img=[i.getAttribute("word_img")],n.ui._dialogs.wordImageDialog.open()):h.open()},_getImg:function(){var t=n.selection.getRange().getClosedNode();return t&&(t.nodeName=="img"||t.nodeName=="IMG")?t:null},_onImgSetFloat:function(t){if(this._getImg()){n.execCommand("imagefloat",t);var i=this._getImg();i&&this.showAnchor(i)}},_setIframeAlign:function(n){var u=i.anchorEl,r=u.cloneNode(!0);switch(n){case-2:r.setAttribute("align","");break;case-1:r.setAttribute("align","left");break;case 1:r.setAttribute("align","right");break;case 2:r.setAttribute("align","middle")}u.parentNode.insertBefore(r,u),t.editor.dom.domUtils.remove(u),i.anchorEl=r,i.showAnchor(i.anchorEl)},_updateIframe:function(){n._iframe=i.anchorEl,o.open(),i.hide()},_onRemoveButtonClick:function(){var r=n.selection.getRange().getClosedNode(),i=t.editor.dom.domUtils.findParentByTagName(r,"img",!0);i&&i.getAttribute("anchorname")?n.execCommand("anchor"):n.execCommand("unlink"),this.hide()},queryAutoHide:function(r){if(r&&r.ownerDocument==n.document)if(r.tagName.toLowerCase()=="img"||t.editor.dom.domUtils.findParentByTagName(r,"a",!0))return r!==i.anchorEl;return t.editor.ui.Popup.prototype.queryAutoHide.call(this,r)}}),i.render(),o=new t.editor.ui.Dialog({iframeUrl:r?n.ui.mapUrl(r.insertframe):"",autoReset:!0,draggable:!0,editor:n,className:"edui-for-insertframe",title:"\u63d2\u5165iframe",buttons:[{className:"edui-okbutton",label:"\u786e\u8ba4",onclick:function(){o.close(!0)}},{className:"edui-cancelbutton",label:"\u53d6\u6d88",onclick:function(){o.close(!1)}}],onok:function(){},oncancel:function(){},onclose:function(n,t){return t?this.onok():this.oncancel()}}),o.render(),n.addListener("mouseover",function(t,r){var f,u;r=r||window.event,f=r.target||r.srcElement,/iframe/ig.test(f.tagName)&&n.options.imagePopup&&(u=i.formatHtml('<nobr>\u5c5e\u6027: <span onclick=$$._setIframeAlign(-2) class="edui-clickable">\u9ed8\u8ba4</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">\u5de6\u5bf9\u9f50</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">\u53f3\u5bf9\u9f50</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(2) class="edui-clickable">\u5c45\u4e2d</span> <span onclick="$$._updateIframe( this);" class="edui-clickable">\u4fee\u6539</span></nobr>'),u?(i.getDom("content").innerHTML=u,i.anchorEl=f,i.showAnchor(i.anchorEl)):i.hide())}),n.addListener("selectionchange",function(r,u){var e,s,f,o,h;if(!u)return;e="",s=n.selection.getRange().getClosedNode(),s!=null&&s.tagName.toLowerCase()=="img"&&(s.getAttribute("anchorname")?e+=i.formatHtml('<nobr>\u5c5e\u6027: <span onclick=$$._onImgEditButtonClick(event) class="edui-clickable">\u4fee\u6539</span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick(event) class="edui-clickable">\u5220\u9664</span></nobr>'):n.options.imagePopup&&(e+=i.formatHtml('<nobr>\u5c5e\u6027: <span onclick=$$._onImgSetFloat("none") class="edui-clickable">\u9ed8\u8ba4</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">\u5c45\u5de6</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">\u5c45\u53f3</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">\u5c45\u4e2d</span> <span onclick="$$._onImgEditButtonClick(event, this);" class="edui-clickable">\u4fee\u6539</span></nobr>'))),f=n.selection.getRange().collapsed?n.queryCommandValue("link"):n.selection.getStart(),f=t.editor.dom.domUtils.findParentByTagName(f,"a",!0),f!=null&&(o=f.getAttribute("data_ue_src")||f.getAttribute("href",2))!=null&&(h=o,o.length>30&&(h=o.substring(0,20)+"..."),e&&(e+='<div style="height:5px;"></div>'),e+=i.formatHtml('<nobr>\u94fe\u63a5: <a target="_blank" href="'+o+'" title="'+o+'" >'+h+'</a> <span class="edui-clickable" onclick="$$._onEditButtonClick(event, this);">\u4fee\u6539</span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(event, this);"> \u6e05\u9664</span></nobr>'),i.showAnchor(f)),e?(i.getDom("content").innerHTML=e,i.anchorEl=s||f,i.showAnchor(i.anchorEl)):i.hide()})},_initToolbars:function(){for(var h=this.editor,s=this.toolbars||[],u=[],o,f,e,n,i,r=0;r<s.length;r++){for(o=s[r],f=new t.editor.ui.Toolbar,e=0;e<o.length;e++){n=o[e],i=null;if(typeof n=="string"){n=="|"&&(n="Separator"),t.editor.ui[n]&&(i=new t.editor.ui[n](h));if(n=="FullScreen"){u&&u[0]?u[0].items.splice(0,0,i):f.items.splice(0,0,i);continue}}else i=n;i&&f.add(i)}u[r]=f}this.toolbars=u},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox"><div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+'</div></div><div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">\u70b9\u6b64\u4e0a\u4f20</div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div><div style="height:0;overflow:hidden;clear:both;"></div></div></div><div id="##_iframeholder" class="%%-iframeholder"></div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"></td><td id="##_wordcount" class="%%-wordcount"></td></tr></table></div></div>'},showWordImageDialog:function(){this.editor.execCommand("wordimage","word_img"),this._dialogs.wordImageDialog.open()},renderToolbarBoxHtml:function(){for(var t=[],n=0;n<this.toolbars.length;n++)t.push(this.toolbars[n].renderHtml());return t.join("")},setFullScreen:function(n){var i,u,r;this._fullscreen!=n&&(this._fullscreen=n,this.editor.fireEvent("beforefullscreenchange",n),i=this.editor,t.editor.browser.gecko&&(u=i.selection.getRange().createBookmark()),n?(this._bakHtmlOverflow=document.documentElement.style.overflow,this._bakBodyOverflow=document.body.style.overflow,this._bakAutoHeight=this.editor.autoHeightEnabled,this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop),this._bakAutoHeight&&(i.autoHeightEnabled=!1,this.editor.disableAutoHeight()),document.documentElement.style.overflow="hidden",document.body.style.overflow="hidden",this._bakCssText=this.getDom().style.cssText,this._bakCssText1=this.getDom("iframeholder").style.cssText,this._updateFullScreen()):(this.getDom().style.cssText=this._bakCssText,this.getDom("iframeholder").style.cssText=this._bakCssText1,this._bakAutoHeight&&(i.autoHeightEnabled=!0,this.editor.enableAutoHeight()),document.documentElement.style.overflow=this._bakHtmlOverflow,document.body.style.overflow=this._bakBodyOverflow,window.scrollTo(0,this._bakScrollTop)),t.editor.browser.gecko&&(r=document.createElement("input"),document.body.appendChild(r),i.body.contentEditable=!1,setTimeout(function(){r.focus(),setTimeout(function(){i.body.contentEditable=!0,i.selection.getRange().moveToBookmark(u).select(!0),t.editor.dom.domUtils.remove(r),n&&window.scroll(0,0)})})),this.editor.fireEvent("fullscreenchanged",n),this.triggerLayout())},_wordCount:function(){var n=this.getDom("wordcount");if(!this.editor.options.wordCount){n.style.display="none";return}n.innerHTML=this.editor.queryCommandValue("wordcount")},disableWordCount:function(){var n=this.getDom("wordcount");n.innerHTML="",n.style.display="none",this.wordcount=!1},enableWordCount:function(){var n=this.getDom("wordcount");n.style.display="",this.wordcount=!0,this._wordCount()},_updateFullScreen:function(){if(this._fullscreen){var n=i.getViewportRect();this.getDom().style.cssText="border:0;position:absolute;left:0;top:0;width:"+n.width+"px;height:"+n.height+"px;z-index:"+(this.getDom().style.zIndex*1+100),i.setViewportOffset(this.getDom(),{left:0,top:0}),this.editor.setHeight(n.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight)}},_updateElementPath:function(){var u=this.getDom("elementpath"),r,t,n,i;if(this.elementPathEnabled&&(r=this.editor.queryCommandValue("elementpath"))){for(t=[],n=0;i=r[n];n++)t[n]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+n+'&quot;);">'+i+"</span>");u.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">path: '+t.join(" &gt; ")+"</div>"}else u.style.display="none"},disableElementPath:function(){var n=this.getDom("elementpath");n.innerHTML="",n.style.display="none",this.elementPathEnabled=!1},enableElementPath:function(){var n=this.getDom("elementpath");n.style.display="",this.elementPathEnabled=!0,this._updateElementPath()},isFullScreen:function(){return this._fullscreen},postRender:function(){var n;for(u.prototype.postRender.call(this),n=0;n<this.toolbars.length;n++)this.toolbars[n].postRender();var e=this,i,f=t.editor.dom.domUtils,r=function(){clearTimeout(i),i=setTimeout(function(){e._updateFullScreen()})};f.on(window,"resize",r);e.addListener("destroy",function(){f.un(window,"resize",r),clearTimeout(i)})},showToolbarMsg:function(n,t){this.getDom("toolbarmsg_label").innerHTML=n,this.getDom("toolbarmsg").style.display="";if(!t){var i=this.getDom("upload_dialog");i.style.display="none"}},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(n){return n.replace("~/",this.editor.options.UEDITOR_HOME_URL||"")},triggerLayout:function(){var n=this.getDom();n.style.zoom=n.style.zoom=="1"?"100%":"1"}},r.inherits(n,t.editor.ui.UIBase),t.editor.ui.Editor=function(i){var r=new t.editor.Editor(i),u;return r.options.editor=r,new n(r.options),u=r.render,r.render=function(n){var t,i;n&&(n.constructor===String&&(n=document.getElementById(n)),n&&n.getAttribute("name")&&(r.options.textarea=n.getAttribute("name")),n&&/script|textarea/ig.test(n.tagName)&&(t=document.createElement("div"),n.parentNode.insertBefore(t,n),r.options.initialContent=n.value||n.innerHTML,n.id&&(t.id=n.id),n.className&&(t.className=n.className),n.style.cssText&&(t.style.cssText=n.style.cssText),n.parentNode.removeChild(n),n=t,n.innerHTML="")),r.ui.render(n),i=r.ui.getDom("iframeholder"),r.container=r.ui.getDom(),r.container.style.zIndex=r.options.zIndex,u.call(r,i)},r}})(),(function(){var i=t.editor.utils,u=t.editor.ui.Popup,r=t.editor.ui.SplitButton,n=t.editor.ui.MultiMenuPop=function(n){this.initOptions(n),this.initMultiMenu()};n.prototype={initMultiMenu:function(){var n=this;this.popup=new u({content:"",editor:n.editor,iframe_rendered:!1,onshow:function(){this.iframe_rendered||(this.iframe_rendered=!0,this.getDom("content").innerHTML='<iframe id="'+n.id+'_iframe" src="'+n.iframeUrl+'" frameborder="0"></iframe>',n.editor.container.style.zIndex&&(this.getDom().style.zIndex=n.editor.container.style.zIndex*1+1))}}),this.onbuttonclick=function(){this.showPopup()},this.initSplitButton()}},i.inherits(n,r)})()})()