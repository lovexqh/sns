<!--{dzztemplate header_simple_start}-->
<link rel="stylesheet" type="text/css" href="dzz/system/images/share/share.css?{VARHASH}" />

<script type="text/javascript" src="dzz/scripts/jquery-1.7.2.min.js"></script>
<script type="text/javascript" src="dzz/scripts/jquery.json-2.3.js"></script>
<script type="text/javascript" src="dzz/scripts/clipboard/ZeroClipboard.min.js"></script>
<script type="text/javascript" src="dzz/system/scripts/t.qq.com.openjs.js#autoboot=no&debug=no"></script>
<script type="text/javascript">
var wname = window.name;
if (wname != "") wname=jQuery.evalJSON(decodeURIComponent(wname));
var win=top._window.windows[wname.winid];
fixpng = function (obj) {
			if(ieVersion>0 && ieVersion<7 ){
				var png = obj.src;
				obj.onload=null;
				if(png.substr(png.lastIndexOf('.')).toLowerCase()=='.png'){
					obj.src = 'dzz/images/b.gif';
					obj.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(src='" + png + "',sizingMethod='scale')";
				}
			}
	};
function GetIeVersion()
{
    var reg = new RegExp("MSIE ([^;]*);", "i");
    if (reg.test(navigator.appVersion)) return parseInt(RegExp.$1);
    return 0;
};
var ieVersion = GetIeVersion();
</script>
<!--{dzztemplate header_simple_end}-->
<script type="text/javascript" src="static/js/calendar.js"></script>
<div id="wraper" class="wraper" style="position:relative">
				<div style="position:absolute;right:15px;top:15px;width:104px;height:104px;">
					<table cellpadding="0" cellspacing="0" border="0" style="table-layout:fixed;" width="100%" height="100%">
						<tr> 
							<td valign="middle" align="center"><img class="icon_max_100_100" id="pre_$_GET[handlekey]"  src="$icoarr[img]" border="0"  onload="fixpng(this)" /></td>
							
						</tr>
					</table>
				</div>
		
			<div  style="position:relative;">
				<form id="shareform_{$icoid}" name="shareform_{$icoid}"  method="post" autocomplete="off" action="{DZZSCRIPT}?mod=system&op=dzzcp&do=urlshare"  onsubmit="if(validate(this)){ajaxpost(this.id, 'return_$_GET[handlekey]','return_$_GET[handlekey]');}else{return false;}">
					<input type="hidden" name="referer" value="$_G[referer]" />
					<input type="hidden" name="sharesubmit" value="true" />
					<input type="hidden" name="formhash" value="{FORMHASH}" />
					<input type="hidden" name="icoid" value="$icoid" />
					<input type="hidden" name="urlsid" value="$icoarr[urlsid]" />
					<input type="hidden" name="handlekey" value="$_GET[handlekey]" />
					<div style="postion:relative;padding:0px 15px">
						 <table cellpadding="0" cellspacing="0" border="0" style="table-layout:fixed;" width="100%" height="100%">
						 <tr height="35"><th width="80" align="right">{lang urlshare_setexpired}:</th><th >
						<label>{lang urlshare_setexpired_0}<input id="needexpired_0" name="needexpired" type="radio" value="0" <!--{if !$share[expired]}--> checked="checked" <!--{/if}--> onclick="checkdisable('needexpired',0);"></label> &nbsp; &nbsp;  
						<label>{lang urlshare_setexpired_1}<input id="needexpired_1" name="needexpired" type="radio" value="1" <!--{if $share[expired]}--> checked="checked" <!--{/if}--> onclick="checkdisable('needexpired',1);"></label>
						</th></tr>
						<tr height="35"><td width="80" align="right">&nbsp;</td><td >
							&nbsp; &nbsp;<input id="expired" type="text" name="expired" value="$share[expired]" size="20" <!--{if !$share[expired]}-->disabled="" class="disabled px"<!--{else}-->class="px" <!--{/if}--> onclick="showcalendar(event, this)" /><span id="expired_tip" style="color:red"></span>
						</td></tr></table>
						 <p class="mtm"></p>
						<table cellpadding="0" cellspacing="0" border="0" style="table-layout:fixed;" width="100%" height="100%">
						 <tr height="35"><th width="80" align="right">{lang urlshare_setpassword}:</th><th >&nbsp; &nbsp;
						<label>{lang urlshare_setpassword_0}<input id="needpassword_0" name="needpassword" type="radio" value="0" <!--{if !$share[password]}--> checked="checked" <!--{/if}--> onclick="checkdisable('needpassword',0);"></label> &nbsp; &nbsp;  
						<label>{lang urlshare_setpassword_1}<input id="needpassword_1" name="needpassword" type="radio" value="1" <!--{if $share[password]}--> checked="checked" <!--{/if}--> onclick="checkdisable('needpassword',1);"></label>
						</th></tr>
						
						<tr height="35"><td width="80" align="right">{lang urlshare_password_1}</td><td >
							&nbsp; &nbsp;<input id="password1" type="password" name="password1" value="$share[password]" size="20" <!--{if !$share[password]}-->disabled="" class="disabled px"<!--{else}-->class="px"<!--{/if}-->  /> <span id="password1_tip" style="color:red"></span>
						</td></tr>
						<tr height="35"><td width="80" align="right">{lang urlshare_password_2}</td><td >
							&nbsp; &nbsp;<input id="password2" type="password" name="password2" value="$share[password]" size="20" <!--{if !$share[password]}-->disabled="" class="disabled px"<!--{else}-->class="px"<!--{/if}--> onkeyup="checkPass(this.value)" /> <span id="password2_tip" style="color:red"></span>
						</td></tr>
						
						<tr height="45"><td width="80" align="right"><!--{if $icoarr[urlsid]}-->{lang urlshare_link}<!--{/if}--></td><td >
							<!--{if $icoarr[urlsid]}-->&nbsp; &nbsp;<input id="share_href"  type="text" name="share_link" value="{$_G[siteurl]}dzz.php?mod=share&op=view&id=$icoarr[urlsid]" size="50" readonly="" class="disabled px" onfocus="this.select();return false;" />&nbsp; &nbsp;<a href="javascript:;" id="clip" class="pn pnc" style="display:inline-block"><strong>{lang copyToClipboard}</strong></a>
							<script type="text/javascript">
								var clip = new ZeroClipboard.Client(); // 创建对象
								clip.setHandCursor( true ); // 设置鼠标手势为手型
								clip.setText(document.getElementById('share_href').value); // 设置要复制的文本。
								clip.glue("clip"); // 注册复制按钮，参数为 id
								clip.addEventListener('complete', function (client, text) {
										document.getElementById('copy_success_tip').innerHTML='{lang copyToClipboard_success}';
									});	
							</script>
							<!--{/if}-->
						</td></tr>
						<tr height="25"><td width="80" align="right"></td><td ><span id="copy_success_tip" style="color:green"></span></td></tr>
						</table>
						<!--{if $icoarr[urlsid]}-->
						<table cellpadding="0" cellspacing="0" border="0" style="table-layout:fixed;" width="300" height="42" >
						<td width="80" align="right"><strong>{lang urlshareto} &nbsp;</strong></td>
						<td valign="middle" align="center">
						
						<!--//分享到新浪微博-->
						    <a href="javascript:;" class="shareBtn" >
								<script type="text/javascript" charset="utf-8">
									(function(){
									  var _w = 32 , _h = 32;
									  var param = {
										url:'{$_G[siteurl]}'+DZZSCRIPT+'?mod=share&op=view&id=$icoarr[urlsid]',
										type:'1',
										count:'0', /**是否显示分享数，1显示(可选)*/
										appkey:'', /**您申请的应用appkey,显示分享来源(可选)*/
										title:'{$icoarr[share_title]}', /**分享的文字内容(可选，默认为所在页面的title)*/
										pic:'{$_G[siteurl]}{$icoarr[img]}', /**分享图片的路径(可选)*/
										ralateUid:'', /**关联用户的UID，分享微博会@该用户(可选)*/
										language:'zh_cn', /**设置语言，zh_cn|zh_tw(可选)*/
										rnd:new Date().valueOf()
									  }
									  var temp = [];
									  for( var p in param ){
										temp.push(p + '=' + encodeURIComponent( param[p] || '' ) )
									  }
									  document.write('<iframe allowTransparency="true" frameborder="0" scrolling="no" src="http://hits.sinajs.cn/A1/weiboshare.html?' + temp.join('&') + '" width="'+ _w+'" height="'+_h+'"></iframe>')
									})()
								</script>
								</a>
								</td>
								<td valign="middle" align="center">
								<!--//分享到腾讯微博-->
								<a href="javascript:;" class="shareBtn">
								<!-- 1. 将以下代码插入到页面中的相应位置 -->
								<div id="qqwb_share__" data-appkey="801246231" data-url="{$_G[siteurl]}{DZZSCRIPT}?mod=share&op=view&id={$icoarr[urlsid]}" data-icon="0"  data-counter="0"  data-content="{$icoarr[share_title]}" data-richcontent="" data-pic="{$_G[siteurl]}{$icoarr[img]}"></div>
								</a>
								</td>
								<td valign="middle" align="center">
								<!--//分享到人人网-->
									<script type="text/javascript" src="http://widget.renren.com/js/rrshare.js"></script>
									<a class="shareBtn" name="xn_share" onclick="shareClick()" type="icon_large" href="javascript:;"></a>
									<script type="text/javascript">
										function shareClick() {
											var rrShareParam = {
												resourceUrl : '{$_G[siteurl]}'+DZZSCRIPT+'?mod=share&op=view&id=$icoarr[urlsid]',	//分享的资源Url
												srcUrl : '',	//分享的资源来源Url,默认为header中的Referer,如果分享失败可以调整此值为resourceUrl试试
												pic : '{$_G[siteurl]}{$icoarr[img]}',		//分享的主题图片Url
												title : '{$icoarr[share_title]}',		//分享的标题
												description : ''	//分享的详细描述
											};
											rrShareOnclick(rrShareParam);
										}
									</script>
									</td>
									<td valign="middle" align="center">
								<!--//分享到QQ空间-->
								<script type="text/javascript">
									(function(){
										var p = {
										url:'{$_G[siteurl]}'+DZZSCRIPT+'?mod=share&op=view&id=$icoarr[urlsid]',
										showcount:'0',/*是否显示分享总数,显示：'1'，不显示：'0' */
										desc:'',/*默认分享理由(可选)*/
										summary:'',/*分享摘要(可选)*/
										title:'{$icoarr[share_title]}',/*分享标题(可选)*/
										site:'{$sysconfig[sitename]}',/*分享来源 如：腾讯网(可选)*/
										pics:'{$_G[siteurl]}{$icoarr[img]}', /*分享图片的路径(可选)*/
										style:'201',
										width:32,
										height:32
										};
										var s = [];
										for(var i in p){
										s.push(i + '=' + encodeURIComponent(p[i]||''));
										}
										document.write(['<a version="1.0" class="qzOpenerDiv shareBtn" style="margin-top:5px;" href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?',s.join('&'),'" target="_blank">分享</a>'].join(''));
									})();
								</script>
								<script src="http://qzonestyle.gtimg.cn/qzone/app/qzlike/qzopensl.js#jsdate=20111201" charset="utf-8"></script>
								</td>
								<td valign="middle" align="center">
								<!--//分享网易微博-->
								<script type="text/javascript" charset="utf-8">
									(function() {
									function show163Window(){
									var param = [],ustr = [];
									param[0] = 'link=' + encodeURIComponent('{$_G[siteurl]}'+DZZSCRIPT+'?mod=share&op=view&id=$icoarr[urlsid]');  //link为网站域名
									param[1] = 'source=' + encodeURIComponent('{$sysconfig[sitename]');  //source为网站名称
									param[2] = 'info=' + encodeURIComponent('{$icoarr[share_title]}') + encodeURIComponent('{$_G[siteurl]}'+DZZSCRIPT+'?mod=share&op=view&id=$icoarr[urlsid]');  //info为转发的文字内容(可选，默认为页面title)
									param[3] = 'images={$_G[siteurl]}{$icoarr[img]}';  //images为传过来的图片地址，多个图片地址用","隔开；若为空会自动抓取转发页面图片
									param[4] = 'togImg=true';//默认显示转发图片(可选，删除true为不显示)
									var url = 'http://t.163.com/article/user/checkLogin.do?';
									url += param.join("&");
									ustr[0] = 'height=330,width=550,top=' + (screen.height - 280) / 2 ;
									ustr[1] = 'left=' + (screen.width - 550) / 2 ;
									ustr[2] = 'toolbar=no, menubar=no, scrollbars=no,';
									ustr[2] += 'resizable=yes,location=no, status=no';
									var s = ustr.join(',');
									window.open(url,'newwindow',s);
									};
									window.show163Window=show163Window;
									})();
									</script>
									<a class="shareBtn" style="background-image:url(http://static.t.126.net/frontend/open/image/sprites/key_v111213.png);background-position:0px -177px;background-repeat:no-repeat;" href="javascript:;" onclick="show163Window()" > </a> </td>
								<td valign="middle" align="center">
								<!--//分享到点点-->
								<script type="text/javascript">
									var ec = encodeURIComponent, url = ec('{$_G[siteurl]}'+DZZSCRIPT+'?mod=share&op=view&id=$icoarr[urlsid]'), ti = ec('{$icoarr[share_title]}');
									document.write('<a class="shareBtn" title="分享到点点" target="_blank" href="http://www.diandian.com/share?lo='+url+'&ti='+ti+'&type=link"><img src="http://s.libdd.com/img/share/share-s-1.png" alt="分享到点点"/></a>');
								</script> 
								</td>
						</tr>
						 </table>
						<!--{/if}-->
					</div>
					<p class="o pns" style="text-align:left;margin:10px 0 0;">
						<span id="return_$_GET[handlekey]" style="float:right;color:red"></span>
						<button type="submit" id="sharesubmit_btn" name="sharesubmit_btn" value="{lang urlshare_create}" class="pn pnc"><strong>{lang urlshare_create}</strong></button>
						
						<!--{if $icoarr[urlsid]}-->&nbsp;&nbsp;&nbsp;&nbsp;
						<button type="button" id="share_cancel"  value="{lang urlshare_cancel}" class="pn pnc" onclick="urlshare_cancel('{$icoarr[urlsid]}',this);return false"><strong>{lang urlshare_cancel}</strong></button><!--{/if}-->
					</p>
				</form>
				<script type="text/javascript">
					function succeedhandle_$_GET[handlekey](url, msg, values) {
						try{
							top._config.sourcedata.icos[values['icoid']].urlsid=values['urlsid'];
							top._ico.setTip_share(values['icoid']);
						}catch(e){};
						window.location.reload();
					}
					function urlshare_cancel(urlsid,obj){
						if(confirm('{lang share_cancel_confirm}')){
							obj.innerHTML='{lang urlshare_deleteing}';
							jQuery.post('{DZZSCRIPT}?mod=system&op=dzzcp&do=urlshare_delete',{urlsid:urlsid},function(json){
								if(json.msg=='success'){
									top._config.sourcedata.icos[json.icoid].urlsid=0;
									top._ico.setTip_share(json.icoid);
									win.Close();
								}else{
									obj.innerHTML=json.msg;
								}
							},'json');
						}
					}
				</script>
				<script type="text/javascript">
					function checkdisable(type,val){
						switch(type){
							case 'needexpired':
								if(val){
									jQuery('#expired').removeAttr('disabled').removeClass('disabled');
								}else{
									jQuery('#expired').attr('disabled','').addClass('disabled');
								}
								break;
							case 'needpassword':
								if(val){
									jQuery('#password1,#password2').removeAttr('disabled').removeClass('disabled');
								}else{
									jQuery('#password1,#password2').attr('disabled','').addClass('disabled');
								}
								break;
						}
					}
					
					function checkPass(val){
						var password1=document.getElementById('password1').value;
						var password2=document.getElementById('password2').value;
						if(password2!=='' && password1!=password2){
							jQuery('#password2_tip').html('{lang password_two}');
						}else{
							jQuery('#password2_tip').html('<img src="static/image/common/check_right.gif">');
						}
					}
					function validate(form){
						//判断密码
						
						if(document.getElementById('needexpired_1').checked){
							if(document.getElementById('expired').value==''){
								document.getElementById('expired').focus();
								document.getElementById('expired_tip').innerHTML='{lang expired_empty}';
								window.setTimeout(function(){document.getElementById('expired_tip').innerHTML=''},3000);
								return false;
							}
						}
						if(document.getElementById('needpassword_1').checked){
							var password1=document.getElementById('password1').value;
							var password2=document.getElementById('password2').value;
							if(password1==''){
								document.getElementById('password1').focus();
								document.getElementById('password1_tip').innerHTML='{lang password_empty}';
								window.setTimeout(function(){document.getElementById('password1_tip').innerHTML=''},3000);
								return false;
							}else if(password2==''){
								document.getElementById('password1').focus();
								document.getElementById('password1_tip').innerHTML='{lang password_empty}';
								window.setTimeout(function(){document.getElementById('password1_tip').innerHTML=''},3000);
								return false;
							}else if(password1!=password2){
								document.getElementById('password2').focus();
								document.getElementById('password1_tip').innerHTML='{lang password_two}';
								return false;
							}
						}
						return true;
					};
				</script> 
				<script type="text/javascript">
				function setWinSize(){
					var el=jQuery('.wraper');
					var width=document.getElementById('wraper').offsetWidth;
					var height=document.getElementById('wraper').offsetHeight
					win.ResizeTo(width,height>600?600:height);
				}
				jQuery(document).ready(function(){
					setWinSize();
				});
				</script> 
		</div>
</div>
<!--{dzztemplate footer}-->