<!--{dzztemplate header_simple_start}-->
  <link rel="stylesheet" type="text/css" href="dzz/system/images/edit/edit.css?{VARHASH}" />
   <script src="dzz/dzzcp/scripts/home_friendselector.js?{VERHASH}" type="text/javascript"></script>
	<script type="text/javascript" src="dzz/scripts/jquery-1.7.2.min.js"></script>
	<script type="text/javascript" src="dzz/scripts/jquery.json-2.3.js"></script>
	
	<script type="text/javascript">
var wname = window.name;
if (wname != "") wname=jQuery.evalJSON(decodeURIComponent(wname));
var win=top._window.windows[wname.winid];
fixpng = function (obj) {
			if(ieVersion>0 && ieVersion<7 ){
				var png = obj.src;
				obj.onload=null;
				if(png.substr(png.lastIndexOf('.')).toLowerCase()=='.png'){
					obj.src = 'dzz/images/b.gif';
					obj.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(src='" + png + "',sizingMethod='scale')";
				}
			}
	};
function GetIeVersion()
{
    var reg = new RegExp("MSIE ([^;]*);", "i");
    if (reg.test(navigator.appVersion)) return parseInt(RegExp.$1);
    return 0;
};
var ieVersion = GetIeVersion();
</script>
<!--{dzztemplate header_simple_end}-->
<div class="wraper" style="position:relative">
		<h3 class="flb"> <em id="return_$_GET[handlekey]">{lang edit}</em> 
			<!--{if $_G[inajax]}--><span><a href="javascript:return false;" onclick="hideWindow('$_GET[handlekey]');return false;" class="flbc" title="{lang close}">{lang close}</a></span><!--{/if}--> 
		</h3>
		<!--{if $type == 'folder'}-->
			<div style="position:relative;">
				<div style="position:absolute;right:15px;top:-30px;width:104px;height:104px;">
					<table cellpadding="0" cellspacing="0" border="0" style="table-layout:fixed;" width="100%" height="100%">
						<tr> 
							<td valign="middle" align="center"><img class="icon_max_100_100" id="pre_$_GET[handlekey]"  src="$icoarr[img]" border="0"  onload="fixpng(this)" /></td>
						</tr>
					</table>
				</div>
			</div>
			<div style="padding:0px 15px 15px 15px;">
				<form id="editform_{$icoid}" name="editform_{$icoid}" class="editform" method="post" autocomplete="off" action="{DZZSCRIPT}?mod=system&op=dzzcp&do=edit"  onsubmit="ajaxpost(this.id, 'return_$_GET[handlekey]','return_$_GET[handlekey]','',$E('editsubmit_btn'));">
					<input type="hidden" name="referer" value="$_G[referer]" />
					<input type="hidden" name="editsubmit" value="true" />
					<input id="select_mypic_$_GET[handlekey]" type="hidden" name="mypic" value="0" />
					<input type="hidden" name="formhash" value="{FORMHASH}" />
					<input type="hidden" name="uid" value="$uid" />
					<input type="hidden" name="icoid" value="$icoid" />
					<input type="hidden" name="type" value="$type" />
					<input type="hidden" name="handlekey" value="$_GET[handlekey]" />
					<input id="img_$_GET[handlekey]" type="hidden"  name="img" value="$icoarr[img]" />
					<p class="mtn mbm">
						<input type="text" size="65" class="px" name="name"  id="edit_name" value="$icoarr[name]" />
					</p>
					<p class="mtm"><em>{lang privacy_settings}:</em></p>
					<p class="mtm">
					<label>{lang friend_-1}<input name="friend" type="radio" value="-1" <!--{if $icoarr[friend]==-1}--> checked="checked" <!--{/if}--> onclick="$E('friend_3_select').style.display='none';setWinSize();"></label> &nbsp; &nbsp;  
					<label>{lang friend_0}<input name="friend" type="radio" value="0" <!--{if $icoarr[friend]==0}--> checked="checked" <!--{/if}--> onclick="$E('friend_3_select').style.display='none';setWinSize();"></label> &nbsp; &nbsp; 
					<label>{lang friend_1}<input name="friend" type="radio" value="1"<!--{if $icoarr[friend]==1}--> checked="checked" <!--{/if}-->  onclick="$E('friend_3_select').style.display='none';setWinSize();"></label>&nbsp; &nbsp;  
					<label>{lang friend_2}<input name="friend" type="radio" value="2" <!--{if $icoarr[friend]==2}-->checked="checked" <!--{/if}-->  onclick="$E('friend_3_select').style.display='none';setWinSize();"></label>&nbsp; &nbsp; 
					<label>{lang friend_3}<input name="friend" type="radio" value="3" <!--{if $icoarr[friend]==3}--> checked="checked" <!--{/if}--> onclick="$E('friend_3_select').style.display='block';setWinSize();"></label> 
					</p>
					
					<div id="friend_3_select"  class="mtm cl" <!--{if $icoarr[friend]!=3}-->style="display:none"<!--{/if}-->>
						<div class="un_selector px z cl" onclick="$E('users_username').focus();" >
							<input type="text" name="users_username" id="users_username" autocomplete="off" />
						</div>
						<a href="javascript:;" id="showSelectBox" class="z mtn xi2 showmenu" style="padding-left:10px;" onclick="fs.showPMFriend('showSelectBox_menu','selectorBox', this);setWinSize();" title="{lang selectfromfriendlist}">{lang select_friend}</a>
					</div>
					<div id="users_username_menu" style="display: none;">
						<ul id="users_friends" class="pmfrndl"></ul>
					</div>
					<div class="p_pof showSelectBox_menu" id="showSelectBox_menu" unselectable="on" style="display:none;width:300px;">
						<div class="pbm">
							<select class="ps" onchange="clearlist=1;getUser(1, this.value)">
								<option value="-1">{lang invite_all_friend}</option>
								<!--{loop $friendgrouplist $groupid $group}-->
									<option value="$groupid">$group</option>
								<!--{/loop}-->
							</select>
						</div>
						<div id="selBox" class="selBox ptn pbn">
							<ul id="selectorBox" class="xl3 cl"></ul>
						</div>
						<div class="cl">
							<button type="button" class="y pn" onclick="fs.showPMFriend('showSelectBox_menu','selectorBox', $E('showSelectBox'));setWinSize();doane(event)"><span>{lang close}</span></button>
						</div>
					</div>
						<script type="text/javascript" >
							var fs;
							var clearlist = 0;
							var selectusernames=[{$icoarr[friendids]}];
							var page = 1;
							var gid = -1;
							var showNum = 0;
							var haveFriend = true;
							function getUser(pageId, gid,callback) {
								page = parseInt(pageId);
								gid = isUndefined(gid) ? -1 : parseInt(gid);
								var x = new Ajax();
								x.get(DZZSCRIPT+'?mod=dzzcp&ac=friend&do=getinviteuser&inajax=1&page='+ page + '&gid=' + gid + '&t=' + Math.random(), function(s) {
									var data = eval('('+s+')');
									var singlenum = parseInt(data['singlenum']);
									var maxfriendnum = parseInt(data['maxfriendnum']);
									fs.addDataSource(data, clearlist);
									if(typeof(callback)=='function') callback();
									haveFriend = singlenum && singlenum == 20 ? true : false;
									if(singlenum && fs.allNumber < 20 && fs.allNumber < maxfriendnum && maxfriendnum > 20 && haveFriend) {
										page++;
										getUser(page);
									}
								});
							}
							function selector() {
								var parameter = {'searchId':'users_username', 'showId':'users_friends', 'formId':'', 'showType':3, 'handleKey':'fs','inputname':'users', 'selBox':'selectorBox', 'selBoxMenu':'showSelectBox_menu', 'maxSelectNumber':'100', 'selectTabId':'selectNum', 'unSelectTabId':'unSelectTab', 'maxSelectTabId':'remainNum'};
								fs = new friendSelector(parameter);
								var listObj = $E('selBox');
								listObj.onscroll = function() {
									clearlist = 0;
									if(this.scrollTop >= this.scrollHeight/5) {
										page++;
										gid = isUndefined(gid) ? -1 : parseInt(gid);
										if(haveFriend) {
											getUser(page, gid);
										}
									}
								}
								getUser(page,-1,function(){
									if(selectusernames){
										for(var i in selectusernames){
											fs.selectUserName(selectusernames[i],true);
										}
									}
								});
							}
							selector();
						</script>
					
					
					<ul class="x_tb mtm cl">
						<li class="a" id="tab_default_$_GET[handlekey]" onclick="switchtab_$_GET[handlekey]('default');"> <a >{lang current_icon}</a></li>
						<li  id="tab_feature_$_GET[handlekey]" onclick="switchtab_$_GET[handlekey]('feature');"> <a >{lang sys_icon}</a></li>
						<li id="tab_mypic_$_GET[handlekey]" onclick="switchtab_$_GET[handlekey]('mypic');"> <a>{lang my_icon}</a></li>
					</ul>
					<div id="icos_$_GET[handlekey]" class="cl" style="position:relative;border-bottom:#CCC solid 1px;border-left:#CCC solid 1px; border-right:#CCC solid 1px;padding:10px;overflow-y:auto;overflow-x:hidden;height:170px;">
						<div id="default_$_GET[handlekey]" > 
							<img class="icon_max_64_64" src="$icoarr[img]" onclick="$E('pre_$_GET[handlekey]').src=this.src;$E('img_$_GET[handlekey]').value=this.src;" style="padding:3px;cursor:pointer" /> 
						</div>
						<div id="feature_$_GET[handlekey]" style="display:none" ></div>
						<div id="mypic_$_GET[handlekey]" style="display:none"></div>
					</div>
					<p class=" pns" style="text-align:center;margin-top:10px;">
						<button type="submit" id="editsubmit_btn" name="editsubmit_btn" value="{lang submit}" class="pn pnc"><strong>{lang submit}</strong></button>
					</p>
				</form>
			</div>
				<!--{if $type=='folder'}--> 
				<script type="text/javascript">
					function succeedhandle_$_GET[handlekey](url, msg, values) {
						top._config.sourcedata.icos[values['icoid']]=values;
						top._ico.reCIco(values['icoid']);
						win.Close();
					}
				
					function switchtab_{$_GET[handlekey]}(id){
						if(id=='feature'){
							$E('tab_default_{$_GET[handlekey]}').className='';
							$E('default_{$_GET[handlekey]}').style.display='none';
							$E('tab_mypic_{$_GET[handlekey]}').className='';
							$E('mypic_{$_GET[handlekey]}').style.display='none';
							$E('tab_feature_{$_GET[handlekey]}').className='a';
							$E('feature_{$_GET[handlekey]}').style.display='block';
							if($E('feature_{$_GET[handlekey]}').innerHTML=='')	ajaxget('{DZZSCRIPT}?mod=system&op=ajax&do=geticon&type=folder&uid=$uid&handlekey={$_GET[handlekey]}', 'feature_{$_GET[handlekey]}');
						}else if(id=='default'){
							$E('tab_feature_{$_GET[handlekey]}').className='';
							$E('feature_{$_GET[handlekey]}').style.display='none';
							$E('tab_mypic_{$_GET[handlekey]}').className='';
							$E('mypic_{$_GET[handlekey]}').style.display='none';
							$E('tab_default_{$_GET[handlekey]}').className='a';
							$E('default_{$_GET[handlekey]}').style.display='block';
						}else if(id=='mypic'){
							$E('tab_default_{$_GET[handlekey]}').className='';
							$E('default_{$_GET[handlekey]}').style.display='none';
							$E('tab_feature_{$_GET[handlekey]}').className='';
							$E('feature_{$_GET[handlekey]}').style.display='none';
							$E('tab_mypic_{$_GET[handlekey]}').className='a';
							$E('mypic_{$_GET[handlekey]}').style.display='block';
							if($E('mypic_{$_GET[handlekey]}').innerHTML=='') ajaxget('{DZZSCRIPT}?mod=system&op=ajax&do=geticon&type=mypic&uid=$uid&handlekey={$_GET[handlekey]}', 'mypic_{$_GET[handlekey]}');
						}
						
					}
		
				</script> 
				<!--{/if}--> 
		<!--{elseif $type == 'link'}--> 
			<div style="position:relative;">
				<div style="position:absolute;right:15px;top:-30px;width:104px;height:104px;">
					<table cellpadding="0" cellspacing="0" border="0" style="table-layout:fixed;" width="100%" height="100%">
						<tr> 
							<td valign="middle" align="center"><img class="icon_max_100_100" id="pre_$_GET[handlekey]"  src="$icoarr[img]" border="0"  onload="fixpng(this)" /></td>
							
						</tr>
					</table>
				</div>
			</div>
			<div style="padding:0px 15px 15px 15px;">
				<form id="editform_{$icoid}" name="editform_{$icoid}" class="editform"  method="post" autocomplete="off" action="{DZZSCRIPT}?mod=system&op=dzzcp&do=edit"  onsubmit="ajaxpost(this.id, 'return_$_GET[handlekey]','return_$_GET[handlekey]','',$E('editsubmit_btn'));">
					<input type="hidden" name="referer" value="$_G[referer]" />
					<input type="hidden" name="editsubmit" value="true" />
					<input id="select_mypic_$_GET[handlekey]" type="hidden" name="mypic" value="0" />
					<input type="hidden" name="formhash" value="{FORMHASH}" />
					<input type="hidden" name="uid" value="$uid" />
					<input type="hidden" name="ukey" value="$ukey" />
					<input type="hidden" name="icoid" value="$icoid" />
					<input type="hidden" name="type" value="$type" />
					<input type="hidden" name="handlekey" value="$_GET[handlekey]" />
					<input id="img_$_GET[handlekey]" type="hidden"  name="img" value="$icoarr[img]" />
					<input id="did_$_GET[handlekey]" type="hidden"  name="did" value="$icoarr[did]" />
					<p class="mtm">
						<input type="text" size="65" class="px" name="name"  id="edit_name" value="$icoarr[name]"  />
					</p>
					 <p class="mtm"><input type="text" size="65" class="px" name="url"  id="edit_name" value="$icoarr[url]" onfocus="this.select();"  style="background:#EBEBEB" readonly />
					 </p>
					
					<p class="mtm">
					<label>{lang method_open_0}<input name="open" type="radio" value="0" <!--{if $icoarr[open]==0}--> checked="checked" <!--{/if}-->></label> &nbsp; &nbsp;  
					<label>{lang method_open_1}<input name="open" type="radio" value="1" <!--{if $icoarr[open]==1}--> checked="checked" <!--{/if}-->></label> &nbsp; &nbsp;  
					<label>{lang method_open_2}<input name="open" type="radio" value="2" <!--{if $icoarr[open]==2}--> checked="checked" <!--{/if}-->></label> &nbsp; &nbsp;  
					<label>{lang method_open_3}<input name="open" type="radio" value="3" <!--{if $icoarr[open]==3}--> checked="checked" <!--{/if}-->></label> &nbsp; &nbsp;  
					</p>
					<p class="mtm ">
						{lang window_width}&nbsp;<input name="width" value="$icoarr[wwidth]" size="5" class="px" style="width:50px;" />&nbsp;X&nbsp;<input name="height" value="$icoarr[wheight]" size="5" class="px" style="width:50px;" />&nbsp;{lang window_height}
					</p>
					<p class="mtm"><em>{lang privacy_settings}:</em></p>
					<p class="mtm">
					<label>{lang friend_-1}<input name="friend" type="radio" value="-1" <!--{if $icoarr[friend]==-1}--> checked="checked" <!--{/if}--> onclick="$E('friend_3_select').style.display='none';setWinSize();"></label> &nbsp; &nbsp;  
					<label>{lang friend_0}<input name="friend" type="radio" value="0" <!--{if $icoarr[friend]==0}--> checked="checked" <!--{/if}--> onclick="$E('friend_3_select').style.display='none';setWinSize();"></label> &nbsp; &nbsp; 
					<label>{lang friend_1}<input name="friend" type="radio" value="1"<!--{if $icoarr[friend]==1}--> checked="checked" <!--{/if}-->  onclick="$E('friend_3_select').style.display='none';setWinSize();"></label>&nbsp; &nbsp;  
					<label>{lang friend_2}<input name="friend" type="radio" value="2" <!--{if $icoarr[friend]==2}-->checked="checked" <!--{/if}-->  onclick="$E('friend_3_select').style.display='none';setWinSize();"></label>&nbsp; &nbsp; 
					<label>{lang friend_3}<input name="friend" type="radio" value="3" <!--{if $icoarr[friend]==3}--> checked="checked" <!--{/if}--> onclick="$E('friend_3_select').style.display='block';setWinSize();"></label> 
					</p>
					
					<div id="friend_3_select"  class="mtm cl" <!--{if $icoarr[friend]!=3}-->style="display:none"<!--{/if}-->>
						<div class="un_selector px z cl" onclick="$E('users_username').focus();" >
							<input type="text" name="users_username" id="users_username" autocomplete="off" />
						</div>
						<a href="javascript:;" id="showSelectBox" class="z mtn xi2 showmenu" style="padding-left:10px;" onclick="fs.showPMFriend('showSelectBox_menu','selectorBox', this);setWinSize();" title="{lang selectfromfriendlist}">{lang select_friend}</a>
					</div>
					<div id="users_username_menu" style="display: none;">
						<ul id="users_friends" class="pmfrndl"></ul>
					</div>
					<div class="p_pof showSelectBox_menu" id="showSelectBox_menu" unselectable="on" style="display:none;width:300px;">
						<div class="pbm">
							<select class="ps" onchange="clearlist=1;getUser(1, this.value)">
								<option value="-1">{lang invite_all_friend}</option>
								<!--{loop $friendgrouplist $groupid $group}-->
									<option value="$groupid">$group</option>
								<!--{/loop}-->
							</select>
						</div>
						<div id="selBox" class="selBox ptn pbn">
							<ul id="selectorBox" class="xl3 cl"></ul>
						</div>
						<div class="cl">
							<button type="button" class="y pn" onclick="fs.showPMFriend('showSelectBox_menu','selectorBox', $E('showSelectBox'));setWinSize();doane(event)"><span>{lang close}</span></button>
						</div>
					</div>
						<script type="text/javascript" >
							var fs;
							var clearlist = 0;
							var selectusernames=[{$icoarr[friendids]}];
							var page = 1;
							var gid = -1;
							var showNum = 0;
							var haveFriend = true;
							function getUser(pageId, gid,callback) {
								page = parseInt(pageId);
								gid = isUndefined(gid) ? -1 : parseInt(gid);
								var x = new Ajax();
								x.get(DZZSCRIPT+'?mod=dzzcp&ac=friend&do=getinviteuser&inajax=1&page='+ page + '&gid=' + gid + '&t=' + Math.random(), function(s) {
									var data = eval('('+s+')');
									var singlenum = parseInt(data['singlenum']);
									var maxfriendnum = parseInt(data['maxfriendnum']);
									fs.addDataSource(data, clearlist);
									if(typeof(callback)=='function') callback();
									haveFriend = singlenum && singlenum == 20 ? true : false;
									if(singlenum && fs.allNumber < 20 && fs.allNumber < maxfriendnum && maxfriendnum > 20 && haveFriend) {
										page++;
										getUser(page);
									}
								});
							}
							function selector() {
								var parameter = {'searchId':'users_username', 'showId':'users_friends', 'formId':'', 'showType':3, 'handleKey':'fs','inputname':'users', 'selBox':'selectorBox', 'selBoxMenu':'showSelectBox_menu', 'maxSelectNumber':'100', 'selectTabId':'selectNum', 'unSelectTabId':'unSelectTab', 'maxSelectTabId':'remainNum'};
								fs = new friendSelector(parameter);
								var listObj = $E('selBox');
								listObj.onscroll = function() {
									clearlist = 0;
									if(this.scrollTop >= this.scrollHeight/5) {
										page++;
										gid = isUndefined(gid) ? -1 : parseInt(gid);
										if(haveFriend) {
											getUser(page, gid);
										}
									}
								}
								getUser(page,-1,function(){
									if(selectusernames){
										for(var i in selectusernames){
											fs.selectUserName(selectusernames[i],true);
										}
									}
								});
							}
							selector();
						</script>
					
					<ul class="x_tb mtm cl">
						<li class="a" id="tab_feature_$_GET[handlekey]" onclick="switchtab_{$_GET[handlekey]}('feature');"> <a >{lang feature_icon}</a></li>
						<li id="tab_mypic_$_GET[handlekey]" onclick="switchtab_{$_GET[handlekey]}('mypic');"> <a>{lang my_icon}</a></li>
						<li class='y'><div style="margin-left:20px;margin-right:20px;"> {lang feature_link} $host</div></li> 
						<li class='y'><div style="margin-left:20px;margin-right:20px;"> {lang relative_feature_link} <img src="dzz/images/selected.png" onclick="if($E('relation_{$_GET[handlekey]}').value=='1'){this.src='dzz/images/select.png';$E('relation_{$_GET[handlekey]}').value='0';}else{this.src='dzz/images/selected.png';$E('relation_{$_GET[handlekey]}').value='1';}" /> <input id="relation_$_GET[handlekey]" name="relationship" type="hidden" value="1"/></div></li> 
					</ul>
					<div id="icos_$_GET[handlekey]" class="cl" style="border-bottom:#CCC solid 1px;border-left:#CCC solid 1px;height:170px; border-right:#CCC solid 1px;padding:10px;">
						<div id="feature_$_GET[handlekey]">
							<!--{loop $domainlist $value}-->
								 <div style="margin:auto;float:left;padding:5px;width:66px;height:66px;">
								 <table cellpadding="0" cellspacing="0"><tr><td width="66" height="66" valign="middle" align="center" style="cursor:pointer;" onclick="$E('pre_$_GET[handlekey]').src='$value[pic]';$E('img_$_GET[handlekey]').value='$value[pic]';$E('did_$_GET[handlekey]').value='$value[did]';" ><img class="icon_max_64_64" src="$value['pic']" onload="fixpng(this);"  /></td></tr></table></div>
							 <!--{/loop}-->
						</div>
						<div id="mypic_$_GET[handlekey]" style="display:none"></div>
					</div>
					<p class=" pns" style="text-align:center;margin-top:10px;">
						<button type="submit" id="editsubmit_btn" name="editsubmit_btn" value="{lang submit}" class="pn pnc"><strong>{lang submit}</strong></button>
					</p>
				</form>
			</div>
				<!--{if $type=='link'}--> 
				<script type="text/javascript" >
					function succeedhandle_$_GET[handlekey](url, msg, values) {
						top._config.sourcedata.icos[values['icoid']]=values;
						top._ico.reCIco(values['icoid']);
						win.Close();
					}
				
					function switchtab_{$_GET[handlekey]}(id){
						if(id=='feature'){
							
							$E('tab_mypic_{$_GET[handlekey]}').className='';
							$E('mypic_{$_GET[handlekey]}').style.display='none';
							$E('tab_feature_{$_GET[handlekey]}').className='a';
							$E('feature_{$_GET[handlekey]}').style.display='block';
							
						}else if(id=='mypic'){
							
							$E('tab_feature_{$_GET[handlekey]}').className='';
							$E('feature_{$_GET[handlekey]}').style.display='none';
							$E('tab_mypic_{$_GET[handlekey]}').className='a';
							$E('mypic_{$_GET[handlekey]}').style.display='block';
							if($E('mypic_{$_GET[handlekey]}').innerHTML=='') ajaxget('{DZZSCRIPT}?mod=system&op=ajax&do=geticon&type=mypic&uid=$uid&handlekey={$_GET[handlekey]}', 'mypic_{$_GET[handlekey]}');
						}
						
					}
		
				</script> 
				<!--{/if}--> 
		<!--{elseif $type == 'app'}--> 
			<div style="position:relative;">
				<div style="position:absolute;right:15px;top:-30px;width:104px;height:104px;">
					<table cellpadding="0" cellspacing="0" border="0" style="table-layout:fixed;" width="100%" height="100%">
						<tr> 
							<td valign="middle" align="center"><img class="icon_max_100_100" id="pre_$_GET[handlekey]"  src="$icoarr[img]" border="0"  onload="fixpng(this)" /></td>
							
						</tr>
					</table>
				</div>
			</div>
			<div style="padding:0px 15px 15px 15px;">
				<form id="editform_{$icoid}" name="editform_{$icoid}"  method="post" autocomplete="off" action="{DZZSCRIPT}?mod=system&op=dzzcp&do=edit"  onsubmit="ajaxpost(this.id, 'return_$_GET[handlekey]','return_$_GET[handlekey]','',$E('editsubmit_btn'));">
					<input type="hidden" name="referer" value="$_G[referer]" />
					<input type="hidden" name="editsubmit" value="true" />
					<input id="select_mypic_$_GET[handlekey]" type="hidden" name="mypic" value="0" />
					<input type="hidden" name="formhash" value="{FORMHASH}" />
					<input type="hidden" name="uid" value="$uid" />
					<input type="hidden" name="ukey" value="$ukey" />
					<input type="hidden" name="icoid" value="$icoid" />
					<input type="hidden" name="type" value="$type" />
					<input type="hidden" name="ismyapp" value="$ismyapp" />
					<input type="hidden" name="handlekey" value="$_GET[handlekey]" />
					<input id="img_$_GET[handlekey]" type="hidden"  name="img" value="$icoarr[img]" />
					<table cellpadding="0" cellspacing="0" border="0" style="table-layout:fixed;" width="100%" height="100%">
					<tr height="35"><td width="60" >{lang appname}:&nbsp;</td><td ><input type="text" size="65" class="px" name="name"  id="edit_name" value="$icoarr[name]"  /></td></tr>
					<tr height="35"><td width="60" >{lang appurl}:&nbsp;</td><td ><input type="text" size="65" class="px" name="url"  id="edit_name" value="$icoarr[url]" onfocus="this.select();"  <!--{if !$ismyapp}-->style="background:#EBEBEB" readonly<!--{/if}--> /></td></tr>
				 <!--{if $ismyapp}-->
				  <tr height="35"><td  >{lang appclass}:&nbsp;</td><td>
					<select id="classid" name="classid" style="margin: 0px;">
					   <!--{loop $appclass $key $value}-->
						<option value="$key" <!--{if $app[classid]==$value[classid]}-->select="selected"<!--{/if}-->>$value[classname]</option>
						 <!--{/loop}-->
					 </select>
					</td></tr>
					<!--{/if}-->
					 <tr height="35"><td width="60" >{lang privacy_settings}:&nbsp;</td><td >
					 <label>{lang friend_-1}<input name="friend" type="radio" value="-1" <!--{if $icoarr[friend]==-1}--> checked="checked" <!--{/if}--> onclick="$E('friend_3_select').style.display='none';setWinSize();"></label> &nbsp; &nbsp; 
					<label>{lang friend_0}<input name="friend" type="radio" value="0" <!--{if $icoarr[friend]==0}--> checked="checked" <!--{/if}--> onclick="$E('friend_3_select').style.display='none';setWinSize();"></label> &nbsp; &nbsp;  
					<label>{lang friend_1}<input name="friend" type="radio" value="1"<!--{if $icoarr[friend]==1}--> checked="checked" <!--{/if}--> onclick="$E('friend_3_select').style.display='none';setWinSize();"></label>&nbsp; &nbsp;  
					<label>{lang friend_2}<input name="friend" type="radio" value="2" <!--{if $icoarr[friend]==2}-->checked="checked" <!--{/if}--> onclick="$E('friend_3_select').style.display='none';setWinSize();"></label>&nbsp; &nbsp;  
					<label>{lang friend_3}<input name="friend" type="radio" value="3" <!--{if $icoarr[friend]==3}-->checked="checked" <!--{/if}--> onclick="$E('friend_3_select').style.display='block';setWinSize();"></label>
					</td></tr>
					<tr><td colspan="2">
						<div id="friend_3_select"  class="mtm cl" <!--{if $icoarr[friend]!=3}-->style="display:none"<!--{/if}-->>
							<div class="un_selector px z cl" onclick="$E('users_username').focus();" style="width:408px">
								<input type="text" name="users_username" id="users_username" autocomplete="off"  />
							</div>
							<a href="javascript:;" id="showSelectBox" class="z mtn xi2 showmenu" style="padding-left:10px;" onclick="fs.showPMFriend('showSelectBox_menu','selectorBox', this);setWinSize();" title="{lang selectfromfriendlist}">{lang select_friend}</a>
						</div>
						<div id="users_username_menu" style="display: none;">
							<ul id="users_friends" class="pmfrndl"></ul>
						</div>
						<div class="p_pof showSelectBox_menu" id="showSelectBox_menu" unselectable="on" style="display:none;">
							<div class="pbm">
								<select class="ps" onchange="clearlist=1;getUser(1, this.value)">
									<option value="-1">{lang invite_all_friend}</option>
									<!--{loop $friendgrouplist $groupid $group}-->
										<option value="$groupid">$group</option>
									<!--{/loop}-->
								</select>
							</div>
							<div id="selBox" class="selBox ptn pbn">
								<ul id="selectorBox" class="xl3 cl"></ul>
							</div>
							<div class="cl">
								<button type="button" class="y pn" onclick="fs.showPMFriend('showSelectBox_menu','selectorBox', $E('showSelectBox'));setWinSize();doane(event)"><span>{lang close}</span></button>
							</div>
						</div>
							<script type="text/javascript" >
								var fs;
								var clearlist = 0;
								var selectusernames=[{$icoarr[friendids]}];
								var page = 1;
								var gid = -1;
								var showNum = 0;
								var haveFriend = true;
								function getUser(pageId, gid,callback) {
									page = parseInt(pageId);
									gid = isUndefined(gid) ? -1 : parseInt(gid);
									var x = new Ajax();
									x.get(DZZSCRIPT+'?mod=dzzcp&ac=friend&do=getinviteuser&inajax=1&page='+ page + '&gid=' + gid + '&t=' + Math.random(), function(s) {
										var data = eval('('+s+')');
										var singlenum = parseInt(data['singlenum']);
										var maxfriendnum = parseInt(data['maxfriendnum']);
										fs.addDataSource(data, clearlist);
										if(typeof(callback)=='function') callback();
										haveFriend = singlenum && singlenum == 20 ? true : false;
										if(singlenum && fs.allNumber < 20 && fs.allNumber < maxfriendnum && maxfriendnum > 20 && haveFriend) {
											page++;
											getUser(page);
										}
									});
								}
								function selector() {
									var parameter = {'searchId':'users_username', 'showId':'users_friends', 'formId':'', 'showType':3, 'handleKey':'fs','inputname':'users', 'selBox':'selectorBox', 'selBoxMenu':'showSelectBox_menu', 'maxSelectNumber':'100', 'selectTabId':'selectNum', 'unSelectTabId':'unSelectTab', 'maxSelectTabId':'remainNum'};
									fs = new friendSelector(parameter);
									var listObj = $E('selBox');
									listObj.onscroll = function() {
										clearlist = 0;
										if(this.scrollTop >= this.scrollHeight/5) {
											page++;
											gid = isUndefined(gid) ? -1 : parseInt(gid);
											if(haveFriend) {
												getUser(page, gid);
											}
										}
									}
									getUser(page,-1,function(){
										if(selectusernames){
											for(var i in selectusernames){
												fs.selectUserName(selectusernames[i],true);
											}
										}
									});
								}
								selector();
							</script>
					</td>
					
					 <tr height="35"><td width="60" >{lang method_open}:&nbsp;</td><td >
					<label>{lang method_open_0}<input name="open" type="radio" value="0" <!--{if $icoarr[open]==0}--> checked="checked" <!--{/if}-->></label> &nbsp; &nbsp;  
					<label>{lang method_open_1}<input name="open" type="radio" value="1" <!--{if $icoarr[open]==1}--> checked="checked" <!--{/if}-->></label> &nbsp; &nbsp;  
					<label>{lang method_open_2}<input name="open" type="radio" value="2" <!--{if $icoarr[open]==2}--> checked="checked" <!--{/if}-->></label> &nbsp; &nbsp;  
					<label>{lang method_open_3}<input name="open" type="radio" value="3" <!--{if $icoarr[open]==3}--> checked="checked" <!--{/if}-->></label> &nbsp; &nbsp;  
					</td></tr>
					<tr height="35"><td width="60" >{lang window_size}:&nbsp;</td><td >
						{lang window_width}&nbsp;<input name="width" value="$app[width]" size="5" class="px" />&nbsp;X&nbsp;<input name="height" value="$app[height]" size="5" class="px" />&nbsp;{lang window_height}
					</td></tr>
					 <!--{if $ismyapp}-->
					 <tr height="60"><td >{lang appdesc}:&nbsp;</td><td><textarea id="appdesc" name="appdesc" style="height:60px;width:100%;border:1px solid #CCC;">$app[appdesc]</textarea></td></tr>
					 <!--{/if}-->
					  <tr height="110"><td colspan="2">
					<ul class="x_tb mtm cl">
						<li class="a" id="tab_default_$_GET[handlekey]" onclick="switchtab_{$_GET[handlekey]}('default');"> <a >{lang current_icon}</a></li>
						<li  id="tab_feature_$_GET[handlekey]" onclick="switchtab_{$_GET[handlekey]}('feature');"> <a >{lang sys_icon}</a></li>
						<li id="tab_mypic_$_GET[handlekey]" onclick="switchtab_{$_GET[handlekey]}('mypic');"> <a>{lang my_icon}</a></li>
					</ul>
					<div id="icos_$_GET[handlekey]" class="cl" style="position:relative;border-bottom:#CCC solid 1px;border-left:#CCC solid 1px; border-right:#CCC solid 1px;padding:10px;overflow-y:auto;overflow-x:hidden;height:170px;width:540px;">
						<div id="default_$_GET[handlekey]" > 
							<img class="icon_max_64_64" src="$icoarr[img]" onclick="$E('pre_$_GET[handlekey]').src=this.src;$E('img_$_GET[handlekey]').value=this.src;" style="padding:3px;cursor:pointer" /> 
						</div>
						<div id="feature_$_GET[handlekey]" style="display:none" ></div>
						<div id="mypic_$_GET[handlekey]" style="display:none"></div>
					</div>
					</td></tr></table>
					<p class=" pns" style="text-align:center;margin-top:10px;">
						<button type="submit" id="editsubmit_btn" name="editsubmit_btn" value="{lang submit}" class="pn pnc"><strong>{lang submit}</strong></button>
					</p>
				</form>
			</div>
				<!--{if $type=='app'}--> 
				<script type="text/javascript">
					function succeedhandle_$_GET[handlekey](url, msg, values) {
						top._config.sourcedata.icos[values['icoid']]=values;
						top._ico.reCIco(values['icoid']);
						win.Close();
					}
				
					function switchtab_{$_GET[handlekey]}(id){
						if(id=='feature'){
							$E('tab_default_{$_GET[handlekey]}').className='';
							$E('default_{$_GET[handlekey]}').style.display='none';
							$E('tab_mypic_{$_GET[handlekey]}').className='';
							$E('mypic_{$_GET[handlekey]}').style.display='none';
							$E('tab_feature_{$_GET[handlekey]}').className='a';
							$E('feature_{$_GET[handlekey]}').style.display='block';
							if($E('feature_{$_GET[handlekey]}').innerHTML=='')	ajaxget('{DZZSCRIPT}?mod=system&op=ajax&do=geticon&type=url&uid=$uid&handlekey={$_GET[handlekey]}', 'feature_{$_GET[handlekey]}');
						}else if(id=='default'){
							$E('tab_feature_{$_GET[handlekey]}').className='';
							$E('feature_{$_GET[handlekey]}').style.display='none';
							$E('tab_mypic_{$_GET[handlekey]}').className='';
							$E('mypic_{$_GET[handlekey]}').style.display='none';
							$E('tab_default_{$_GET[handlekey]}').className='a';
							$E('default_{$_GET[handlekey]}').style.display='block';
						}else if(id=='mypic'){
							$E('tab_default_{$_GET[handlekey]}').className='';
							$E('default_{$_GET[handlekey]}').style.display='none';
							$E('tab_feature_{$_GET[handlekey]}').className='';
							$E('feature_{$_GET[handlekey]}').style.display='none';
							$E('tab_mypic_{$_GET[handlekey]}').className='a';
							$E('mypic_{$_GET[handlekey]}').style.display='block';
							if($E('mypic_{$_GET[handlekey]}').innerHTML=='') ajaxget('{DZZSCRIPT}?mod=system&op=ajax&do=geticon&type=mypic&uid=$uid&handlekey={$_GET[handlekey]}', 'mypic_{$_GET[handlekey]}');
						}
						
					}
		
				</script> 
				<!--{/if}--> 
		<!--{else}--> 
			<div style="position:relative;">
				<div style="position:absolute;right:15px;top:-30px;width:104px;height:104px;">
					<table cellpadding="0" cellspacing="0" border="0" style="table-layout:fixed;" width="100%" height="100%">
						<tr> 
							<td valign="middle" align="center"><img class="icon_max_100_100" id="pre_$_GET[handlekey]"  src="$icoarr[img]" border="0"  onload="fixpng(this)" /></td>
							
						</tr>
					</table>
				</div>
			</div>
			<div style="padding:0px 15px 15px 15px;">
				<form id="editform_{$icoid}" class="editform" name="editform_{$icoid}" method="post" autocomplete="off" action="{DZZSCRIPT}?mod=system&op=dzzcp&do=edit"  onsubmit="ajaxpost(this.id, 'return_$_GET[handlekey]','return_$_GET[handlekey]','',$E('editsubmit_btn'));">
					<input type="hidden" name="referer" value="$_G[referer]" />
					<input type="hidden" name="editsubmit" value="true" />
					<input id="select_mypic_$_GET[handlekey]" type="hidden" name="mypic" value="0" />
					<input type="hidden" name="formhash" value="{FORMHASH}" />
					<input type="hidden" name="uid" value="$uid" />
					<input type="hidden" name="ukey" value="$ukey" />
					<input type="hidden" name="icoid" value="$icoid" />
					<input type="hidden" name="type" value="$type" />
					<input type="hidden" name="handlekey" value="$_GET[handlekey]" />
					<input id="img_$_GET[handlekey]" type="hidden"  name="img" value="$icoarr[img]" />
					<p ><input type="text" size="60" class="px" name="name"  id="edit_name" value="$icoarr['name']" /></p>
					<p class="mtm"><em>{lang privacy_settings}:</em></p>
					<p class="mtm">
					<label>{lang friend_-1}<input name="friend" type="radio" value="-1" <!--{if $icoarr[friend]==-1}--> checked="checked" <!--{/if}--> onclick="$E('friend_3_select').style.display='none';setWinSize();"></label> &nbsp; &nbsp;  
					<label>{lang friend_0}<input name="friend" type="radio" value="0" <!--{if $icoarr[friend]==0}--> checked="checked" <!--{/if}--> onclick="$E('friend_3_select').style.display='none';setWinSize();"></label> &nbsp; &nbsp; 
					<label>{lang friend_1}<input name="friend" type="radio" value="1"<!--{if $icoarr[friend]==1}--> checked="checked" <!--{/if}-->  onclick="$E('friend_3_select').style.display='none';setWinSize();"></label>&nbsp; &nbsp;  
					<label>{lang friend_2}<input name="friend" type="radio" value="2" <!--{if $icoarr[friend]==2}-->checked="checked" <!--{/if}-->  onclick="$E('friend_3_select').style.display='none';setWinSize();"></label>&nbsp; &nbsp; 
					<label>{lang friend_3}<input name="friend" type="radio" value="3" <!--{if $icoarr[friend]==3}--> checked="checked" <!--{/if}--> onclick="$E('friend_3_select').style.display='block';setWinSize();"></label> 
					</p>
					
					<div id="friend_3_select"  class="mtm cl" <!--{if $icoarr[friend]!=3}-->style="display:none"<!--{/if}-->>
						<div class="un_selector px z cl" onclick="$E('users_username').focus();" >
							<input type="text" name="users_username" id="users_username" autocomplete="off" />
						</div>
						<a href="javascript:;" id="showSelectBox" class="z mtn xi2 showmenu" style="padding-left:10px;" onclick="fs.showPMFriend('showSelectBox_menu','selectorBox', this);setWinSize();" title="{lang selectfromfriendlist}">{lang select_friend}</a>
					</div>
					<div id="users_username_menu" style="display: none;">
						<ul id="users_friends" class="pmfrndl"></ul>
					</div>
					<div class="p_pof showSelectBox_menu" id="showSelectBox_menu" unselectable="on" style="display:none;">
						<div class="pbm">
							<select class="ps" onchange="clearlist=1;getUser(1, this.value)">
								<option value="-1">{lang invite_all_friend}</option>
								<!--{loop $friendgrouplist $groupid $group}-->
									<option value="$groupid">$group</option>
								<!--{/loop}-->
							</select>
						</div>
						<div id="selBox" class="selBox ptn pbn">
							<ul id="selectorBox" class="xl3 cl"></ul>
						</div>
						<div class="cl">
							<button type="button" class="y pn" onclick="fs.showPMFriend('showSelectBox_menu','selectorBox', $E('showSelectBox'));setWinSize();doane(event)"><span>{lang close}</span></button>
						</div>
					</div>
						<script type="text/javascript" >
							var fs;
							var clearlist = 0;
							var selectusernames=[{$icoarr[friendids]}];
							var page = 1;
							var gid = -1;
							var showNum = 0;
							var haveFriend = true;
							function getUser(pageId, gid,callback) {
								page = parseInt(pageId);
								gid = isUndefined(gid) ? -1 : parseInt(gid);
								var x = new Ajax();
								x.get(DZZSCRIPT+'?mod=dzzcp&ac=friend&do=getinviteuser&inajax=1&page='+ page + '&gid=' + gid + '&t=' + Math.random(), function(s) {
									var data = eval('('+s+')');
									var singlenum = parseInt(data['singlenum']);
									var maxfriendnum = parseInt(data['maxfriendnum']);
									fs.addDataSource(data, clearlist);
									if(typeof(callback)=='function') callback();
									haveFriend = singlenum && singlenum == 20 ? true : false;
									if(singlenum && fs.allNumber < 20 && fs.allNumber < maxfriendnum && maxfriendnum > 20 && haveFriend) {
										page++;
										getUser(page);
									}
								});
							}
							function selector() {
								var parameter = {'searchId':'users_username', 'showId':'users_friends', 'formId':'', 'showType':3, 'handleKey':'fs','inputname':'users', 'selBox':'selectorBox', 'selBoxMenu':'showSelectBox_menu', 'maxSelectNumber':'100', 'selectTabId':'selectNum', 'unSelectTabId':'unSelectTab', 'maxSelectTabId':'remainNum'};
								fs = new friendSelector(parameter);
								var listObj = $E('selBox');
								listObj.onscroll = function() {
									clearlist = 0;
									if(this.scrollTop >= this.scrollHeight/5) {
										page++;
										gid = isUndefined(gid) ? -1 : parseInt(gid);
										if(haveFriend) {
											getUser(page, gid);
										}
									}
								}
								getUser(page,-1,function(){
									if(selectusernames){
										for(var i in selectusernames){
											fs.selectUserName(selectusernames[i],true);
										}
									}
								});
							}
							selector();
						</script>
					
					
				    <p class="o pns" style="text-align:center;margin-top:10px;">
						<button type="submit" id="editsubmit_btn" name="editsubmit_btn" value="{lang submit}" class="pn pnc"><strong>{lang submit}</strong></button>
					</p>
				</form>
			</div>
			<script type="text/javascript" >
				function succeedhandle_$_GET[handlekey](url, msg, values) {
					top._config.sourcedata.icos[values['icoid']]=values;
					top._ico.reCIco(values['icoid']);
					win.Close();
				}
			</script> 
		<!--{/if}--> 
		<script type="text/javascript">
		function setWinSize(){
			var el=jQuery('.wraper');
			win.ResizeTo(el.outerWidth(),el.outerHeight());
		}
		jQuery(document).ready(function(){
			setWinSize();
			
		});
		</script> 
</div>
<!--{dzztemplate footer}-->